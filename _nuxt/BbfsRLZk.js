import{E as e,a}from"./DQUqQXp4.js";import{E as l}from"./BmJn-QVY.js";import{f as t,e_ as i,v as r,I as n,r as o,a5 as s,g as d,c as u,o as c,a as f,O as m,b as p,w as v,F as b,C as g,i as x,K as h,t as T,d as E,e3 as C,D as w,a1 as y,q6 as I,a$ as N,A as S,q4 as L}from"./LNDzZpPm.js";import{E as _,a as D}from"./CyofXtRf.js";import"./BcS6nOuf.js";import"./CqaOUC0Y.js";import{S as j}from"./D6i2W5JX.js";import"./BZp9YwGa.js";import"./CdYdV4TG.js";import"./DuC4p7MX.js";const z={class:"flex items-center justify-end gap-8px mb-16px"},Y={class:"flex items-center gap-4px text-12px"},P=["infinite-scroll-disabled"],k={class:"text-12px"},O={key:1},V={class:"mt-[2px] mb-[5px] py-[10px] text-[12px] text-center color-[--third-text]"},F={key:0},M=t({__name:"fundingRate",setup(t){const M=i(),{t:A}=r(),U=n([]),R=o({loading:!1,finished:!1,error:!1}),$=o(""),q=o({filterTypeList:"SETTLE_FUNDING_FEE",filterContractIdList:"ALL",filterStartCreatedTimeInclusive:s().subtract(7,"d").startOf("day").unix(),filterEndCreatedTimeExclusive:s().endOf("day").unix()}),H=d((()=>{var e,a,l;const t=(null==(l=null==(a=null==(e=M.metadata)?void 0:e.contractList)?void 0:a.reduce)?void 0:l.call(a,((e,a)=>(e[a.contractId]=a.contractName,e)),{}))||{};return t.ALL=A("all"),t})),X=d((()=>{var e,a,l;const t=null==(l=null==(a=null==(e=M.metadata)?void 0:e.contractList)?void 0:a.map)?void 0:l.call(a,(e=>({label:e.contractName,value:e.contractId})));return[{label:A("all"),value:"ALL"}].concat(t||[])})),B=e=>!!q.value.filterEndCreatedTimeExclusive&&s(e).isAfter(s(1e3*Number(q.value.filterEndCreatedTimeExclusive))),G=e=>!!q.value.filterStartCreatedTimeInclusive&&s(e).isBefore(s(1e3*Number(q.value.filterStartCreatedTimeInclusive))),K=async()=>{if(R.value.loading||R.value.finished)return;const e=Object.create(null);Object.keys(q.value).forEach((a=>{const l=q.value[a];l&&(["filterStartCreatedTimeInclusive","filterEndCreatedTimeExclusive"].includes(a)?e[a]=1e3*l:"ALL"!==l&&(e[a]=l))})),$.value&&(e.offsetData=$.value);try{R.value.loading=!0;const a=await L(e);let l=a.dataList||[];$.value&&(l=U.value.concat(l)),a.nextPageOffsetData||(R.value.finished=!0),$.value=a.nextPageOffsetData,U.value=l}catch(a){R.value.error=!0}finally{R.value.loading=!1}};K();const J=()=>{$.value="",U.value=[],R.value.finished=!1,R.value.error=!1,R.value.loading=!1,K()};return(t,i)=>{const r=e,n=a,o=l,d=N,L=_,M=D,Q=C;return c(),u(b,null,[f("div",z,[p(n,{modelValue:x(q).filterContractIdList,"onUpdate:modelValue":i[0]||(i[0]=e=>x(q).filterContractIdList=e),size:"small",class:"[&&]:[--el-select-width:110px]","popper-class":"[--el-font-size-base:12px]","suffix-icon":x(j),onChange:J},{prefix:v((()=>[f("span",null,T(x(A)("markets1")),1)])),default:v((()=>[(c(!0),u(b,null,g(x(X),(e=>(c(),h(r,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue","suffix-icon"]),f("div",Y,[p(o,{modelValue:x(q).filterStartCreatedTimeInclusive,"onUpdate:modelValue":i[1]||(i[1]=e=>x(q).filterStartCreatedTimeInclusive=e),size:"small","disabled-date":B,class:"[--el-font-size-base:12px] [&&]:[--el-date-editor-width:120px]","range-separator":"To",format:"YYYY-MM-DD",placeholder:x(A)("startTime"),"value-format":"X",teleported:!1,clearable:!1,onChange:J},null,8,["modelValue","placeholder"]),E(" "+T(t.$t("to"))+" ",1),p(o,{modelValue:x(q).filterEndCreatedTimeExclusive,"onUpdate:modelValue":i[2]||(i[2]=e=>x(q).filterEndCreatedTimeExclusive=e),size:"small","disabled-date":G,class:"[--el-font-size-base:12px] [&&]:[--el-date-editor-width:120px]","range-separator":"To",format:"YYYY-MM-DD",placeholder:x(A)("endTime1"),"value-format":"X",teleported:!1,clearable:!1,onChange:J},null,8,["modelValue","placeholder"])])]),m((c(),u("div",{class:"relative min-h-400px bg-[--secondary-bg]","infinite-scroll-delay":200,"infinite-scroll-disabled":x(R).loading||x(R).finished||x(R).error,"infinite-scroll-immediate":!1,"infinite-scroll-distance":300},[p(M,{data:x(U),"header-row-class-name":"text-12px sticky top-0 z-10 font-500","cell-class-name":"color-[--main-text] text-12px"},{empty:v((()=>{var e;return[x(R).loading||0!==(null==(e=x(U))?void 0:e.length)?(c(),u("span",O)):(c(),h(d,{key:0,class:"pt-[40px]"},{default:v((()=>[f("span",k,T(t.$t("emptyNoData")),1)])),_:1}))]})),default:v((()=>[p(L,{label:x(A)("tradeTime"),prop:"fundingTime"},{default:v((({row:e})=>[E(T(x(s)(+e.fundingTime).format("YYYY-MM-DD HH:mm:ss")),1)])),_:1},8,["label"]),p(L,{label:x(A)("markets1"),prop:"contractId"},{default:v((({row:e})=>[E(T(x(H)[e.contractId]),1)])),_:1},8,["label"]),p(L,{width:100,align:"right",label:x(A)("direction"),prop:"direction"},{default:v((({row:e})=>[f("span",{class:w(e.fundingPositionSize>0?"color-[--up-color]":"color-[--down-color]")},T(e.fundingPositionSize>0?x(A)("long"):x(A)("short")),3)])),_:1},8,["label"]),p(L,{align:"right",label:x(A)("contractSize"),prop:"contractSize"},{default:v((({row:e})=>{var a,l;return[E(T(("formatNumber"in t?t.formatNumber:x(y))(new(x(I))(e.fundingPositionSize).abs().toString()))+T(null==(l=null==(a=x(H)[e.contractId])?void 0:a.replace)?void 0:l.call(a,"USD","")),1)]})),_:1},8,["label"]),p(L,{align:"right",label:x(A)("fundingFee"),prop:"deltaFundingFee"},{default:v((({row:e})=>[E(T(("formatNumber"in t?t.formatNumber:x(y))(new(x(I))(e.deltaFundingFee).abs().toString()))+"USD ",1)])),_:1},8,["label"]),p(L,{align:"right",label:x(A)("fundingRate"),prop:"fundingRate"},{default:v((({row:e})=>[E(T(("formatNumber"in t?t.formatNumber:x(y))(100*Math.abs(e.fundingRate)))+"% ",1)])),_:1},8,["label"]),p(L,{align:"right",label:x(A)("oraclePrice"),prop:"fundingOraclePrice"},{default:v((({row:e})=>[E(T(("formatNumber"in t?t.formatNumber:x(y))(e.fundingOraclePrice,{limit:20,decimals:2})),1)])),_:1},8,["label"]),p(L,{align:"right",label:x(A)("indexPrice"),prop:"fundingIndexPrice"},{default:v((({row:e})=>[E(T(("formatNumber"in t?t.formatNumber:x(y))(e.fundingIndexPrice,{limit:20,decimals:2})),1)])),_:1},8,["label"])])),_:1},8,["data"]),f("div",V,[x(R).loading&&x($)?(c(),u("span",F,T(x(A)("loading")),1)):S("",!0)])],8,P)),[[Q,K]])],64)}}});export{M as default};
