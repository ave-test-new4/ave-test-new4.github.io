import{f as e,W as l,e_ as a,aE as t,v as i,I as r,r as s,g as d,m as o,N as n,c,o as u,O as m,b as p,e3 as f,i as b,a as v,w as y,K as g,A as h,t as x,d as w,a1 as _,F as T,D as P,B as I,a5 as N,Q as E,G as k,a$ as L,s as O,E as A,q3 as D,q2 as F}from"./LNDzZpPm.js";import{E as Y,a as M}from"./CyofXtRf.js";import"./BcS6nOuf.js";import"./CqaOUC0Y.js";import"./DuC4p7MX.js";const R=["infinite-scroll-disabled"],K={class:"text-12px"},C={key:1},S={class:"text-14px"},j={class:"flex items-center justify-end gap-4px"},z={class:"flex items-center justify-end gap-4px"},B={class:"text-12px"},U={class:"mt-[2px] mb-[5px] py-[10px] text-[12px] text-center color-[--third-text]"},H={key:0},V={class:"flex items-center justify-start gap-4px"},q=e({__name:"historyOrder",props:{searchParams:{}},setup(e){const q=l(),Q=a(),W=t(),{t:$}=i(),G=e,J=r([]),X=s({loading:!1,finished:!1,error:!1}),Z=s(""),ee=s(!1),le=s({title:"",list:[]}),ae={LAST_PRICE:$("latestPrice"),TAKE_PROFIT_LIMIT:$("takeProfitLimit")},te={CANCELED:$("cancelled1"),FILLED:$("filled")},ie=d((()=>{var e,l,a;const t=(null==(a=null==(l=null==(e=Q.metadata)?void 0:e.contractList)?void 0:l.reduce)?void 0:a.call(l,((e,l)=>(e[l.contractId]=l.contractName,e)),{}))||{};return t.ALL=$("all"),t})),re=async()=>{if(X.value.loading||X.value.finished)return;const e={filterStatusList:"FILLED,CANCELED",...G.searchParams};Z.value&&(e.offsetData=Z.value);try{X.value.loading=!0;const l=await D(e);let a=l.dataList||[];Z.value&&(a=J.value.concat(a)),l.nextPageOffsetData||(X.value.finished=!0),Z.value=l.nextPageOffsetData,J.value=a}catch(l){X.value.error=!0}finally{X.value.loading=!1}};q.address&&re();return o((()=>[G.searchParams,q.address]),(()=>{Z.value="",J.value=[],X.value.finished=!1,X.value.error=!1,X.value.loading=!1,re()})),(e,l)=>{const a=L,t=Y,i=I,r=E,s=k,d=M,o=A,D=n("copy"),q=f;return u(),c(T,null,[m((u(),c("div",{class:"relative min-h-400px bg-[--secondary-bg]","infinite-scroll-delay":200,"infinite-scroll-disabled":b(X).loading||b(X).finished||b(X).error,"infinite-scroll-immediate":!1,"infinite-scroll-distance":300},[p(d,{fit:"",data:b(J),"header-row-class-name":"text-12px sticky top-0 z-10 font-500","cell-class-name":"color-[--main-text] text-12px"},{empty:y((()=>{var l;return[b(X).loading||0!==(null==(l=b(J))?void 0:l.length)?(u(),c("span",C)):(u(),g(a,{key:0,class:"pt-[40px]"},{default:y((()=>[v("span",K,x(e.$t("emptyNoData")),1)])),_:1}))]})),default:y((()=>[p(t,{label:b($)("markets1"),prop:"contractId"},{default:y((({row:e})=>[v("span",S,x(b(ie)[e.contractId]),1)])),_:1},8,["label"]),p(t,{label:b($)("tradeVolume"),prop:"contractSize"},{default:y((({row:l})=>[w(x(("formatNumber"in e?e.formatNumber:b(_))(l.cumMatchSize,3))+"/"+x(("formatNumber"in e?e.formatNumber:b(_))(l.l2Size,3)),1)])),_:1},8,["label"]),p(t,{minWidth:100,align:"right",label:b($)("price"),prop:"fillPrice"},{default:y((({row:l})=>{var a,t;return[w(x((null==(t=null==(a=l.type)?void 0:a.includes)?void 0:t.call(a,"MARKET"))?b($)("market"):("formatNumber"in e?e.formatNumber:b(_))(l.price,{limit:20,decimals:10})),1)]})),_:1},8,["label"]),p(t,{align:"right",label:b($)("triggerPrice"),prop:"triggerPrice"},{default:y((({row:l})=>{var a,t,i,r,s,d,o,n;return[(null==(t=null==(a=l.type)?void 0:a.includes)?void 0:t.call(a,"STOP"))||(null==(r=null==(i=l.type)?void 0:i.includes)?void 0:r.call(i,"TAKE_PROFIT"))?(u(),c(T,{key:1},["BUY"===l.side?(u(),c(T,{key:0},[w(x((null==(d=null==(s=l.type)?void 0:s.includes)?void 0:d.call(s,"TAKE_PROFIT"))?"≤":"≥"),1)],64)):(u(),c(T,{key:1},[w(x((null==(n=null==(o=l.type)?void 0:o.includes)?void 0:n.call(o,"TAKE_PROFIT"))?"≥":"≤"),1)],64)),w(" "+x(("formatNumber"in e?e.formatNumber:b(_))(l.triggerPrice,10))+" "+x(ae[l.triggerPriceType]),1)],64)):(u(),c(T,{key:0},[w(" -- ")],64))]})),_:1},8,["label"]),p(t,{"min-width":80,align:"right",label:b($)("tradeType"),prop:"side"},{default:y((({row:e})=>[v("span",{class:P("BUY"===e.side?"color-[--up-color]":"color-[--down-color]")},x("BUY"===e.side?b($)("buy"):b($)("sell")),3)])),_:1},8,["label"]),p(t,{"min-width":80,align:"right",label:b($)("orderType"),prop:"orderType"},{default:y((({row:e})=>{var l,a,t,i;return[e.type.includes("TAKE_PROFIT")?(u(),c(T,{key:0},[w(x(b($)("takeProfit")),1)],64)):e.type.includes("STOP")?(u(),c(T,{key:1},[w(x(b($)("stopLoss")),1)],64)):(u(),c(T,{key:2},[w(x((null==(a=null==(l=e.type)?void 0:l.includes)?void 0:a.call(l,"MARKET"))?b($)("market"):"")+x((null==(i=null==(t=e.type)?void 0:t.includes)?void 0:i.call(t,"LIMIT"))?b($)("limit"):""),1)],64))]})),_:1},8,["label"]),p(t,{"min-width":80,align:"right",label:b($)("filledType"),prop:"tradeType2"},{default:y((({row:e})=>[w(x(b($)("trades")),1)])),_:1},8,["label"]),p(t,{"min-width":80,align:"right",label:b($)("status"),prop:"status"},{default:y((({row:e})=>[w(x(te[e.status]),1)])),_:1},8,["label"]),p(t,{align:"right",label:b($)("orderId"),prop:"orderId"},{default:y((({row:e})=>[v("div",j,[w(x(e.id.slice(0,4))+"..."+x(e.id.slice(-4)),1),m(p(i,{name:"bxs:copy",class:"color-[#5A5E64]"},null,512),[[D,e.id]])])])),_:1},8,["label"]),p(t,{align:"right",label:b($)("orderTime"),prop:"createdTime"},{default:y((({row:e})=>[w(x(b(N)(Number(e.createdTime)).format("YYYY-MM-DD HH:mm:ss")),1)])),_:1},8,["label"]),p(t,{"min-width":80,align:"right",label:b($)("onlyReduce"),prop:"reduceOnly"},{default:y((({row:e})=>[w(x(e.reduceOnly?b($)("yes"):b($)("no")),1)])),_:1},8,["label"]),"perp-id"!==b(W).name?(u(),g(t,{key:0,align:"right",label:b($)("executionStrategy"),prop:"reduceOnly"},{default:y((({row:e})=>{var l,a;return[v("div",z,[w(x((null==(a=null==(l=e.type)?void 0:l.includes)?void 0:a.call(l,"MARKET"))?b($)("immediateOrCancel"):b($)("validityPeriod2"))+" ",1),p(r,{width:200},{reference:y((()=>[p(i,{name:"custom:info"})])),default:y((()=>{var l,a;return[v("span",B,x((null==(a=null==(l=e.type)?void 0:l.includes)?void 0:a.call(l,"MARKET"))?b($)("immediateOrCancel2"):b($)("validityPeriod3")),1)]})),_:2},1024)])]})),_:1},8,["label"])):h("",!0),p(t,{"min-width":80,align:"right",label:b($)("action")},{default:y((({row:e})=>[p(s,{style:{"--el-button-active-border-color":"transparent"},size:"small",onClick:l=>(async e=>{ee.value=!0,le.value.title=ie.value[e.contractId]+"-"+("BUY"===e.side?$("buy"):$("sell"));const l=await F({size:10,filterOrderIdList:e.id});le.value.list=l.dataList})(e)},{default:y((()=>[w(x(b($)("detail")),1)])),_:2},1032,["onClick"])])),_:1},8,["label"])])),_:1},8,["data"]),v("div",U,[b(X).loading&&b(Z)?(u(),c("span",H,x(b($)("loading")),1)):h("",!0)])],8,R)),[[q,re]]),p(o,{modelValue:b(ee),"onUpdate:modelValue":l[0]||(l[0]=e=>O(ee)?ee.value=e:null),title:b(le).title,width:"700","append-to-body":""},{default:y((()=>[p(d,{fit:"","header-row-class-name":"text-12px sticky top-0 z-10 font-500","cell-class-name":"color-[--main-text] text-12px",data:b(le).list},{default:y((()=>[p(t,{label:b($)("filledQty")},{default:y((({row:l})=>[w(x(("formatNumber"in e?e.formatNumber:b(_))(l.fillSize,{limit:20,decimals:10})),1)])),_:1},8,["label"]),p(t,{label:b($)("filledPrice")},{default:y((({row:l})=>[w(x(("formatNumber"in e?e.formatNumber:b(_))(l.fillPrice,{limit:20,decimals:10})),1)])),_:1},8,["label"]),p(t,{label:b($)("role")},{default:y((({row:e})=>[w(x(e.direction),1)])),_:1},8,["label"]),p(t,{label:b($)("fee")},{default:y((({row:l})=>[w(x(("formatNumber"in e?e.formatNumber:b(_))(l.fillFee,{limit:20})),1)])),_:1},8,["label"]),p(t,{label:b($)("tradeNo"),"min-width":"150"},{default:y((({row:e})=>[v("div",V,[w(x(e.matchFillId.slice(0,4))+"..."+x(e.matchFillId.slice(-4))+" ",1),m(p(i,{name:"bxs:copy",class:"color-[#5A5E64]"},null,512),[[D,e.matchFillId]])])])),_:1},8,["label"]),p(t,{width:150,label:b($)("tradeTime")},{default:y((({row:e})=>[w(x(b(N)(Number(e.createdTime)).format("YYYY-MM-DD HH:mm:ss")),1)])),_:1},8,["label"])])),_:1},8,["data"])])),_:1},8,["modelValue","title"])],64)}}});export{q as default};
