import{f as e,aE as a,am as l,y as r,e_ as t,v as i,I as s,r as o,g as n,j as c,m as d,H as u,ez as p,eA as m,nT as f,a4 as g,N as v,O as b,e3 as y,c as x,o as h,b as P,a as N,w,K as k,A as T,i as _,t as I,d as L,a1 as S,F as O,D,B as E,a5 as C,G as Y,J as A,a$ as j,q1 as M}from"./LNDzZpPm.js";import{E as z,a as $}from"./CyofXtRf.js";import"./BcS6nOuf.js";import"./CqaOUC0Y.js";import"./DuC4p7MX.js";const B=["infinite-scroll-disabled"],H={class:"text-12px"},R={key:1},F={class:"text-14px"},G={key:0,class:"color-[--down-color]"},U={key:1,class:"color-[--up-color]"},q={key:2},J={key:0,class:"color-[--up-color]"},K={key:1},V={key:2,class:"color-[--down-color]"},X={key:3},Q={class:"flex items-center justify-end gap-4px"},W={class:"mt-[2px] mb-[5px] py-[10px] text-[12px] text-center color-[--third-text]"},Z={key:0},ee=e({__name:"currentOrder",props:{searchParams:{}},setup(e){const ee=a(),{mode:ae}=l(r()),le=t(),{t:re}=i(),te=e,{isCancelOrder:ie,order:se}=l(t()),oe=s([]),ne=o({loading:!1,finished:!1,error:!1}),ce=o(""),de={LAST_PRICE:re("latestPrice"),INDEX_PRICE:re("indexPrice")},ue=n((()=>{var e,a,l;const r=(null==(l=null==(a=null==(e=le.metadata)?void 0:e.contractList)?void 0:a.reduce)?void 0:l.call(a,((e,a)=>(e[a.contractId]=a.contractName,e)),{}))||{};return r.ALL=re("all"),r})),pe=async()=>{if("perp-id"==ee.name)return;if(ne.value.loading||ne.value.finished)return;const e={filterStatusList:"CANCELING,OPEN,PENDING",...te.searchParams};ce.value&&(e.offsetData=ce.value);try{ne.value.loading=!0;const a=await M(e);let l=a.dataList||[];ce.value&&(l=oe.value.concat(l)),a.nextPageOffsetData||(ne.value.finished=!0),ce.value=a.nextPageOffsetData,oe.value=l}catch(a){ne.value.error=!0}finally{ne.value.loading=!1}},me=c({}),fe=n((()=>{var e,a;const l=null==(e=se.value)?void 0:e.toSorted(((e,a)=>Number(a.createdTime)-Number(e.createdTime)));return(null==(a=null==l?void 0:l.map)?void 0:a.call(l,(e=>{const a="SELL"===e.side,l=e.type.includes("PROFIT");let r="";return r=a?l?"≥":"≤":l?"≤":"≥",{...e,triggerSign:r}})))||[]}));return d((()=>te.searchParams),(e=>{"perp-id"===ee.name?(null==e?void 0:e.filterContractIdList)?oe.value=(null==fe?void 0:fe.value.filter((a=>a.contractId==(null==e?void 0:e.filterContractIdList))))||[]:oe.value=null==fe?void 0:fe.value:(ce.value="",oe.value=[],ne.value.finished=!1,ne.value.error=!1,ne.value.loading=!1,pe())}),{immediate:!0}),d((()=>ie.value),(e=>{e&&u.confirm(re("cancelAllOrderTips"),re("cancelAllOrder"),{type:"warning",icon:p(m),confirmButtonText:re("confirm"),cancelButtonText:re("cancel"),customClass:`${ae.value} delete_confirm`}).then((()=>{var e;const a=null==(e=oe.value)?void 0:e.map((e=>e.id));f(a).then((()=>{g.success(re("cancelledOrderSuccessfully"))})).finally((()=>{ie.value=!1}))})).catch((e=>{}))})),(e,a)=>{const l=j,r=z,t=E,i=Y,s=$,o=v("copy"),n=y;return b((h(),x("div",{class:"relative min-h-400px bg-[--secondary-bg]","infinite-scroll-delay":200,"infinite-scroll-disabled":_(ne).loading||_(ne).finished||_(ne).error,"infinite-scroll-immediate":!1,"infinite-scroll-distance":300},[P(s,{data:_(oe),"header-row-class-name":"text-12px sticky top-0 z-10 font-500","cell-class-name":"color-[--main-text] text-12px"},{empty:w((()=>{var a;return[_(ne).loading||0!==(null==(a=_(oe))?void 0:a.length)?(h(),x("span",R)):(h(),k(l,{key:0,class:"pt-[40px]"},{default:w((()=>[N("span",H,I(e.$t("emptyNoData")),1)])),_:1}))]})),default:w((()=>[P(r,{label:_(re)("markets1"),prop:"contractId"},{default:w((({row:e})=>[N("span",F,I(_(ue)[e.contractId]),1)])),_:1},8,["label"]),"perp-id"==_(ee).name?(h(),k(r,{key:0,label:_(re)("type"),width:100},{default:w((({row:a})=>[a.type.includes("STOP")?(h(),x("span",G,I(e.$t("stopLoss")),1)):a.type.includes("PROFIT")?(h(),x("span",U,I(e.$t("takeProfit")),1)):a.type.includes("LIMIT")?(h(),x("span",q,I(e.$t("limit")),1)):T("",!0)])),_:1},8,["label"])):T("",!0),P(r,{width:100,label:_(re)("price"),prop:"price"},{default:w((({row:a})=>[L(I(a.type.includes("LIMIT")?("formatNumber"in e?e.formatNumber:_(S))(a.price,{decimals:10,limit:20}):_(re)("market")),1)])),_:1},8,["label"]),"perp-id"==_(ee).name?(h(),k(r,{key:1,align:"right",label:_(re)("triggerPrice"),prop:"triggerPrice"},{default:w((({row:a})=>[""!==a.triggerPrice&&a.triggerPrice>0?(h(),x(O,{key:0},[L(I(a.triggerSign)+I(("formatNumber"in e?e.formatNumber:_(S))(a.triggerPrice,{limit:20,decimals:10}))+" "+I(de[a.triggerPriceType]),1)],64)):(h(),x(O,{key:1},[L(" -- ")],64))])),_:1},8,["label"])):T("",!0),P(r,{width:150,align:"right",label:_(re)("tradeVolume"),prop:"contractSize"},{default:w((({row:a})=>[L(I(("formatNumber"in e?e.formatNumber:_(S))(a.cumMatchSize,3))+"/"+I(("formatNumber"in e?e.formatNumber:_(S))(a.l2Size,3)),1)])),_:1},8,["label"]),P(r,{width:100,align:"right",label:_(re)("tradeType"),prop:"tradeType"},{default:w((({row:e})=>[N("span",{class:D("BUY"===e.side?"color-[--up-color]":"color-[--down-color]")},I("BUY"===e.side?_(re)("buy"):_(re)("sell")),3)])),_:1},8,["label"]),P(r,{align:"right",label:_(re)("takeProfitStopLoss"),prop:"takeProfitStopLoss"},{default:w((({row:l})=>[l.openTp.triggerPrice?(h(),x("span",J,I(("formatNumber"in e?e.formatNumber:_(S))(l.openTp.triggerPrice,{limit:20,decimals:10})),1)):(h(),x("span",K,"--")),a[0]||(a[0]=N("span",{class:"color-[--icon-color] mx-4px"},"/",-1)),l.openSl.triggerPrice?(h(),x("span",V,I(("formatNumber"in e?e.formatNumber:_(S))(l.openSl.triggerPrice,{limit:20,decimals:10})),1)):(h(),x("span",X,"--"))])),_:1},8,["label"]),P(r,{align:"right",label:_(re)("orderId"),prop:"id"},{default:w((({row:e})=>{var a,l;return[N("div",Q,[L(I((null==(a=e.id)?void 0:a.slice(0,4))+"..."+(null==(l=e.id)?void 0:l.slice(-4))),1),b(P(t,{name:"bxs:copy",class:"color-[#5A5E64]"},null,512),[[o,e.id]])])]})),_:1},8,["label"]),P(r,{align:"right",label:_(re)("orderTime"),prop:"createdTime"},{default:w((({row:e})=>[L(I(_(C)(Number(e.createdTime)).format("YYYY-MM-DD HH:mm:ss")),1)])),_:1},8,["label"]),P(r,{align:"right",label:_(re)("validityPeriod"),prop:"l2ExpireTime"},{default:w((({row:e})=>[L(I(_(C)(Number(e.expireTime)).format("YYYY-MM-DD HH:mm:ss")),1)])),_:1},8,["label"]),P(r,{align:"right",label:_(re)("action"),prop:"operate"},{default:w((({row:e})=>[P(i,{size:"small",style:{"--el-button-active-border-color":"transparent"},loading:_(me)[e.id],onClick:A((a=>(async e=>{me[e[0]]=!0,await f(e).finally((()=>{me[e[0]]=!1})),pe(),g.success(re("cancelledOrderSuccessfully"))})([e.id])),["stop"])},{default:w((()=>[L(I(_(re)("cancel")),1)])),_:2},1032,["loading","onClick"])])),_:1},8,["label"])])),_:1},8,["data"]),N("div",W,[_(ne).loading&&_(ce)?(h(),x("span",Z,I(_(re)("loading")),1)):T("",!0)])],8,B)),[[n,pe]])}}});export{ee as default};
