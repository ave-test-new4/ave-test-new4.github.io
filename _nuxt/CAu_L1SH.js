import{f as e,aE as t,ap as a,y as r,V as s,W as o,x as n,U as i,r as l,gA as c,I as u,g as p,bY as d,m,ni as f,cr as x,aq as h,a2 as b,aN as v,N as _,c as k,o as y,a as g,A as w,b as C,O as N,K as S,B as $,D as A,i as M,w as T,F as j,C as I,e as V,d as B,a7 as F,ce as E,t as R,a1 as L,ai as W,J as H,aM as O,_ as q,b$ as z,bZ as D,am as J}from"./LNDzZpPm.js";import{E as K}from"./CqaOUC0Y.js";import{S as P}from"./4BOpdlp6.js";const U={class:"h-32px bg-[--secondary-bg] flex items-center"},Y={class:"pl-16px pr-8px flex items-center gap-8px text-[--icon-color]"},Z=q(e({__name:"tokenHistory",setup(e){const q=t(),z=a(),D=r(),J=s(),P=o(),Z=n("topColTab",1),G=i("scrollbar"),Q=l(0),X=i("scrollContent"),{width:ee}=c(X),te=u([]),ae=p((()=>1===Z.value)),re=p((()=>{var e;const t=Array.from((null==(e=X.value)?void 0:e.children)||[]).reduce(((e,t)=>e+t.getBoundingClientRect().width),0),a=Math.max(18*(ne.value.length-1),0);return ee.value<t+a})),se=p((()=>{var e;return"evm"===(null==(e=d(P.chain))?void 0:e.vm_type)})),oe=p((()=>J.userInfo?J.userInfo.addresses.map((({address:e,chain:t})=>e+"-"+t)):P.address&&se.value&&"WatchWallet"!==P.walletName?[P.address+"-bsc",P.address+"-base",P.address+"-eth"]:[P.address+"-"+P.chain])),ne=p((()=>({0:te.value,1:D.lastVisitTokens}[Z.value])));function ie(){"-"!==oe.value[0]&&f({hide_risk:D.hide_risk,hide_small:D.hide_small,user_ids:oe.value,pageSize:20}).then((e=>{te.value=(e.data||[]).map((e=>{var t;return{...e,id:e.token===x?(null==(t=d(e.chain))?void 0:t.wmain_wrapper)+"-"+e.chain:`${e.token}-${e.chain}`}}))}))}function le(){D.lastVisitTokens.length=0}function ce(e){G.value&&G.value.setScrollLeft(Q.value+e)}function ue({scrollLeft:e}){Q.value=e}m(Z,(()=>{0===Z.value&&ie()}),{immediate:!0}),m((()=>[J.evmAddress,P.address,P.walletSignature[P.address]]),(()=>{ie()}));const pe={0:function(e){const t={};e.prices.forEach((e=>{t[e.token+"-"+e.chain]=e})),te.value=te.value.map((e=>{const a=t[e.id];if(a&&a.uprice>0){const t="--"===e.total_profit||0===Number(e.total_profit),r=new b(e.balance||0).times(a.uprice||0);if(t)return{...e,current_price_usd:a.uprice,balance_usd:r.toNumber()};{const t=new b(e.balance_usd||0).minus(e.total_profit||0),s=r.minus(t),o=new b(a.uprice||0).minus(e.average_purchase_price_usd||0).div(e.average_purchase_price_usd);return o.toNumber()<-1||Number(e.average_purchase_price_usd)<0?e:{...e,current_price_usd:a.uprice,balance_usd:r.toNumber(),total_profit:s.toFixed(),total_profit_ratio:o.toFixed()}}}return e}))},1:function(e){D.lastVisitTokens=D.lastVisitTokens.map((t=>{const a=e.prices.find((e=>t.id===e.token+"-"+e.chain));return a?{...t,price:a.uprice,price_change:Number(a.price_change),price_change_v2:Number(a.price_change_v2)}:t}))}};return m((()=>z.wsResult[h.PRICEV2]),(e=>{const t=pe[Z.value];t&&t(e)})),m((()=>z.wsResult[h.ASSET]),(e=>{var t;if(!ae.value)if(e.swap){const t="So11111111111111111111111111111111111111112"===e.swap.token||e.swap.token===x?x:e.swap.token,a=e.swap.chain;t&&a&&setTimeout((()=>{ie()}),5e3)}else if(e.transfer){const a=e.transfer.chain,r=e.transfer.token,s=e.transfer.type;if(r&&a){const o=te.value.findIndex((e=>e.token===r&&e.chain===a)),n="0"===s;if(o>-1){const a=te.value[o],r=Number(a.balance),s=a.current_price_usd,i=new b(r).plus(n?e.transfer.amount:-(null==(t=e.transfer)?void 0:t.amount)),l=i.multipliedBy(s);a.balance=i.toString(),a.balance_usd=l.toNumber(),v(te)}else setTimeout((()=>{ie()}),5e3)}}})),(e,t)=>{const a=$,r=F,s=V,o=K,n=_("tooltip");return y(),k("div",U,[g("div",Y,[N((y(),S(a,{key:0,name:"custom:position",class:A(["cursor-pointer hover:color-[--secondary-text]",0===M(Z)?"text-[--secondary-text]":""]),onClick:t[0]||(t[0]=e=>Z.value=0)},null,8,["class"])),[[n,e.$t("positions")]]),N((y(),S(a,{key:1,name:"custom:history-fill",class:A(["cursor-pointer hover:color-[--secondary-text]",1===M(Z)?"text-[--secondary-text]":""]),onClick:t[1]||(t[1]=e=>Z.value=1)},null,8,["class"])),[[n,e.$t("history")]])]),M(re)?(y(),k("div",{key:0,class:"w-24px h-32px flex items-center justify-center cursor-pointer text-[--secondary-text] hover:text-[--main-text]",onClick:t[2]||(t[2]=e=>ce(-200))},[C(a,{name:"material-symbols:arrow-back-ios-new-rounded"})])):w("",!0),C(o,{ref_key:"scrollbar",ref:G,class:"flex-1",onScroll:ue},{default:T((()=>[g("div",{ref_key:"scrollContent",ref:X,class:"flex items-center gap-18px whitespace-nowrap h-32px text-12px color-[--third-text]"},[(y(!0),k(j,null,I(M(ne),(o=>(y(),S(s,{key:o.id,class:A(["h-full flex items-center gap-4px hover:color-[--main-text] group",o.id===M(q).params.id?"border-b-solid border-b-[--secondary-text] [&&]:color-[--main-text]":""]),to:`/token/${o.id}`,onClick:t[3]||(t[3]=e=>M(G)&&M(G).setScrollLeft(0))},{default:T((()=>{var t;return[C(r,{row:{logo_url:o.logo_url,symbol:o.symbol,chain:null==(t=("getAddressAndChainFromId"in e?e.getAddressAndChainFromId:M(E))(o.id))?void 0:t.chain},tokenClass:"w-16px h-16px",chainClass:"w-8px h-8px"},null,8,["row"]),B(" "+R(o.symbol)+" ",1),"circulation"in o?(y(),k(j,{key:0},[B(" $"+R(("formatNumber"in e?e.formatNumber:M(L))(new(M(b))(o.price).times(new(M(b))(o.circulation)).toFixed(),2)),1)],64)):(y(),k(j,{key:1},[B(" $"+R(("formatNumber"in e?e.formatNumber:M(L))(Number(o.balance_usd),2)),1)],64)),"total_profit_ratio"in o?(y(),k("span",{key:2,class:A(("getColorClass"in e?e.getColorClass:M(W))(Number(o.total_profit_ratio)))},R(+o.total_profit_ratio>0?"+":"")+R(("formatNumber"in e?e.formatNumber:M(L))(Number(100*+o.total_profit_ratio),2))+"%",3)):(y(),k("span",{key:3,class:A(("getColorClass"in e?e.getColorClass:M(W))(Number(o.price_change_v2)))},R(+o.price_change_v2>0?"+":"")+R(("formatNumber"in e?e.formatNumber:M(L))(Number(o.price_change_v2),2))+"%",3)),M(ae)?(y(),S(a,{key:4,name:"custom:close",class:"cursor-pointer text-16px hidden group-hover:block",onClick:H((e=>{return t=o.id,void(D.lastVisitTokens=D.lastVisitTokens.filter((e=>e.id!==t)));var t}),["self","stop","prevent"])},null,8,["onClick"])):w("",!0)]})),_:2},1032,["class","to"])))),128))],512)])),_:1},512),M(re)?(y(),k("div",{key:1,class:"w-24px h-32px flex items-center justify-center cursor-pointer text-[--secondary-text] hover:text-[--main-text]",onClick:t[4]||(t[4]=e=>ce(200))},[C(a,{name:"material-symbols:arrow-forward-ios"})])):w("",!0),N(g("div",{class:"p-8px h-32px flex items-center color-[--secondary-text] hover:color-[--main-text] gap-4px whitespace-nowrap text-12px cursor-pointer",onClick:le},[C(a,{name:"line-md:close"}),B(" "+R(e.$t("closeAll")),1)],512),[[O,M(ne).length>=1&&M(ae)]])])}}}),[["__scopeId","data-v-8e441cb3"]]),G={class:"flex justify-between items-center px-12px py-8px text-12px h-32px color-[--third-text]"},Q=["onClick"],X=["onClick"],ee={key:1},te={key:2,class:"flex flex-col items-center justify-center ml-5px"},ae=["onClick"],re=["onClick"],se=e({__name:"tHead",props:{columns:{type:Array,default:()=>[]},sort:{type:Object,default:()=>({})},toggleMode:{type:Function,default:()=>{}}},emits:["update:sort"],setup(e,{emit:t}){const a=e,r=t;function s(e,t,r){const s=a.sort.activeSort===e&&a.sort.sortBy===t;return"t"===r?s?"border-t-[--main-text]":"border-t-[--third-text]":s?"border-b-[--main-text]":"border-b-[--third-text]"}const o={0:1,1:-1,"-1":0};function n(e,t){const s={...a.sort};t?s.activeSort=t:s.sortBy!==e?s.activeSort=1:s.activeSort=o[s.activeSort],s.sortBy=e,r("update:sort",s)}return(t,a)=>{const r=$;return y(),k("div",G,[(y(!0),k(j,null,I(e.columns,((a,o)=>(y(),k("div",{key:o,class:A(`flex items-center cursor-pointer ${a.flex}`),onClick:H((e=>n(a.value)),["stop"])},[a.label?(y(),k(j,{key:0},[a.currentMode?(y(!0),k(j,{key:1},I(a.label.split("{currentMode}"),((t,s)=>(y(),k("div",{class:"flex items-center",key:s},[0===s?(y(),k("span",{key:0,onClick:H((t=>e.toggleMode(a.currentMode)),["stop"])},R(t),9,X)):(y(),k("span",ee,R(t),1)),0===s?(y(),S(r,{key:2,name:"custom:arrow-switch",class:"text-16px",onClick:H((t=>e.toggleMode(a.currentMode)),["stop"])},null,8,["onClick"])):w("",!0)])))),128)):(y(),k(j,{key:0},[B(R(a.label),1)],64))],64)):z(t.$slots,a.value,{key:1}),a.sort?(y(),k("div",te,[g("i",{class:A(`w-0 h-0 border-solid border-4px border-transparent cursor-pointer\n            ${s(-1,a.value,"b")}\n            `),onClick:H((e=>n(a.value,-1)),["stop"])},null,10,ae),g("i",{class:A(`w-0 h-0 border-solid border-4px border-transparent mt-3px cursor-pointer\n            ${s(1,a.value,"t")}\n            `),onClick:H((e=>n(a.value,1)),["stop"])},null,10,re)])):w("",!0)],10,Q)))),128))])}}}),oe=e({__name:"slippageSetMarket",props:{chain:{type:String,default:""},showClipboardSet:{type:Boolean,default:!1}},setup(e){const t=D(),{botSettings:a}=J(t);return(t,r)=>(y(),S(P,{key:e.chain,canSetAuto:!0,chain:e.chain,showClipboardSet:e.showClipboardSet,setting:M(a)[e.chain]},{icon:T((()=>[z(t.$slots,"icon")])),_:3},8,["chain","showClipboardSet","setting"]))}});export{se as _,oe as a,Z as b};
