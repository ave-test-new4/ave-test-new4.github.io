import{_ as a}from"./4ADxCC58.js";import{E as e}from"./XXbWVT46.js";import{f as t,v as i,y as s,am as r,r as o,g as n,I as c,x as l,m as p,n as m,ao as u,an as v,q as d,V as _,W as h,a5 as g,ap as y,aq as b,b as k,c as j,o as f,O as w,K as x,A as C,ar as T,i as I,a6 as S,a3 as z,C as N,w as O,as as A,F as $,av as q,aw as E,_ as F}from"./LNDzZpPm.js";import"./BcS6nOuf.js";import"./DQUqQXp4.js";import"./CqaOUC0Y.js";import{H as V,e as L,h as P,I as R,i as B,j as H,k as D,l as M,m as U,n as G,o as K,p as W,t as X,v as J,w as Q,x as Y,y as Z,z as aa,A as ea,B as ta,D as ia,C as sa,E as ra,F as oa,P as na,G as ca}from"./CKxt2h_2.js";import{g as la}from"./CxxVZToV.js";import"./B4pLZScH.js";import"./vmSyQCMq.js";import"./Dmaw2k36.js";import"./njOOFaJF.js";import"./B_bYtbjB.js";import"./CdYdV4TG.js";import"./Cgr8_RvQ.js";import"./DsasURJA.js";import"./DuC4p7MX.js";import"./BA1-t-Dw.js";import"./4BOpdlp6.js";import"./C7V6rAAc.js";import"./D6i2W5JX.js";import"./ByIaSzHa.js";import"./9dry2T_v.js";import"./fQpEmYRS.js";import"./CytQXV1W.js";import"./7PWpoxWf.js";import"./FG6gRdvh.js";const pa=F(t({__name:"activity",props:{listMapFunction:{type:Function},activeChain:{},activeSubTab:{},activeTab:{},height:{},ammList:{}},setup(t){const{t:F}=i(),pa=s(),ma=t,{rankConditions:ua}=r(pa);function va(a){ua.value[ma.activeTab].sort=a,ga.value.pageNO=1,wa()}function da(...a){a.forEach((a=>{q(ua.value[ma.activeTab].filter,a[0],a[1])})),ga.value.pageNO=1,wa()}const _a=o([]),ha=n((()=>pa.pumpSetting.isBlacklist?_a.value.filter((a=>{return e=a,!(-1!==pa.pumpBlackList.findIndex((a=>a.address==e.token&&"ca"==a.type||a.address==e.symbol&&"keyword"==a.type)));var e})):_a.value));const ga=o({pageNO:1,pageSize:50,total:0}),ya=c(!1),ba=n((()=>ma.activeTab+"Ranks"));let ka,ja=l(ba.value,V(F));function fa({rowData:a}){E(`/token/${a.target_token}-${a.chain}`)}async function wa(a=!0){var e,t;try{a&&(ya.value=!0);const{total:i,...s}=ga.value,r=_().evmAddress||h().address||"",o=["created_at_max","created_at_min"].reduce(((a,e)=>(a[e]&&(a[e]=g().unix()-60*Number(a[e])),a)),{...null==(e=ua.value[ma.activeTab])?void 0:e.filter}),n=await la({category:ma.activeTab,...s,chain:"AllChains"!==ma.activeChain?ma.activeChain:"",...null==(t=ua.value[ma.activeTab])?void 0:t.sort,...o,self_address:r});ga.value.total=n.total,_a.value=(n.data||[]).map(ma.listMapFunction),a&&function(){xa.send({jsonrpc:"2.0",method:"unsubscribe",params:["price_extra"],id:1});const a=_a.value.map((a=>`${a.pair}-${a.chain}`));xa.send({jsonrpc:"2.0",method:"subscribe",params:["price_extra",a],id:1})}(),clearTimeout(ka),ka=window.setTimeout((()=>{wa(!1)}),1e4)}finally{ya.value=!1}}p((()=>ma.activeTab),(()=>{Aa(),ja=l(ba.value,V(F)),ga.value.pageNO=1,wa()}),{immediate:!0}),m((()=>{wa()})),u((()=>{clearTimeout(ka)})),v((()=>{Aa(),clearTimeout(ka),ka=window.setTimeout((()=>{wa(!1)}),1e4)})),d((()=>{clearTimeout(ka)})),p((()=>[ma.activeChain,ma.activeTab]),(()=>{ga.value.pageNO=1,wa()}));const xa=y();p((()=>xa.wsResult[b.PRICE_EXTRA]),(({prices:a})=>{var e;const t=Array.isArray(a)?a.reduce(((a,e)=>(a[e.pair+"-"+e.chain]=e,a)),{}):{},i=_a.value.map((a=>{const e=t[a.pair+"-"+a.chain];if(e){delete e.holders,delete e.last_trade_at;const t=a.current_price_usd?(a.market_cap||0)/a.current_price_usd*(e.uprice||0):0;return{...a,market_cap:t,current_price_usd:e.uprice,...e}}return a})),{sort:s,sort_dir:r}=null==(e=ua.value[ma.activeTab])?void 0:e.sort,o={asc:"1",desc:"-1"}[r];o&&(_a.value=i.toSorted(((a,e)=>(a[s]-e[s])*o)))}));const Ca=h(),Ta=_();function Ia(){ga.value.pageNO=1,wa()}n((()=>Ta.evmAddress||Ca.address));const Sa={price_change_dynamic:a=>a.isVisible&&!["1m","24h"].includes(pa.rankCommon.activeInterval),quick:a=>a.isVisible&&pa.rankCommon.quickVisible},za=n((()=>ba.value?ja.value.filter((a=>Sa[a.key]?Sa[a.key](a):a.isVisible)):ja.value)),Na=n((()=>({poolPair:W,headline:()=>F("aiSummary"),mCap:K,price_change_1m:G,price_change_24h:G,price_change_dynamic:G,tvl:U,dynamicVolAndTxs:M,markers_dynamic:D,holders:H,smart_money_buy_volume_24h:B,dex:R,security:()=>F("security"),holders_top10_ratio:P,quick:()=>F("quick"),sniper_tx_count:L}))),Oa=n((()=>({poolPair:na,headline:oa,mCap:ra,price_change_1m:({row:a})=>k(ca,{row:a,activeInterval:"1m"},null),price_change_24h:({row:a})=>k(ca,{row:a,activeInterval:"24h"},null),price_change_dynamic:({row:a})=>k(ca,{row:a,activeInterval:pa.rankCommon.activeInterval},null),tvl:sa,dynamicVolAndTxs:ia,markers_dynamic:ta,holders:ea,smart_money_buy_volume_24h:aa,dex:Z,security:Y,holders_top10_ratio:Q,quick:J,sniper_tx_count:X})));function Aa(){ua.value[ma.activeTab]||(ua.value[ma.activeTab]={sort:{sort:"",sort_dir:""},filter:{}})}return(t,i)=>{const s=a,r=e,o=T;return f(),j($,null,[w((f(),j("div",{style:S(`height:${t.height}`)},[k(s,{"row-key":"pair_id",loading:I(ya),data:I(ha),columns:I(za),"header-height":40,"row-height":81,fixed:"",style:{"--el-bg-color":"var(--secondary-bg)"},"row-class":"cursor-pointer [&&]:[--el-table-border:1px_solid_var(--main-divider)]",rowEventHandlers:{onClick:fa}},z({_:2},[N(I(za),(a=>({name:`header-${a.key}`,fn:O((()=>{var e;return[(f(),x(A(I(Na)[a.key]),{key:t.activeTab,sortConditions:null==(e=I(ua)[t.activeTab])?void 0:e.sort,setSortConditions:va,setFilterForm:da,activeInterval:a.activeInterval||I(pa).rankCommon.activeInterval,ammList:"dex"===a.key?t.ammList:null},null,8,["sortConditions","activeInterval","ammList"]))]}))}))),N(I(za),(a=>({name:`cell-${a.key}`,fn:O((({row:e,rowIndex:i})=>[(f(),x(A(I(Oa)[a.key]),{class:"text-14px",row:e,rowIndex:i,pageNO:I(ga).pageNO,pageSize:I(ga).pageSize,activeInterval:a.activeInterval||I(pa).rankCommon.activeInterval,activeChain:t.activeChain},null,8,["row","rowIndex","pageNO","pageSize","activeInterval","activeChain"]))]))})))]),1032,["loading","data","columns","rowEventHandlers"])],4)),[[o,I(ya)]]),I(ga).total?(f(),x(r,{key:0,"current-page":I(ga).pageNO,"onUpdate:currentPage":i[0]||(i[0]=a=>I(ga).pageNO=a),"page-size":I(ga).pageSize,"onUpdate:pageSize":i[1]||(i[1]=a=>I(ga).pageSize=a),class:"mt-5px py-9px flex justify-center [&&]:[--el-pagination-button-height:18px]",layout:"total, prev, pager, next",total:I(ga).total||0,small:!1,"page-sizes":[20,50,100,200,300,400],onSizeChange:Ia,onCurrentChange:i[2]||(i[2]=()=>wa())},null,8,["current-page","page-size","total"])):C("",!0)],64)}}}),[["__scopeId","data-v-b00d59c6"]]);export{pa as default};
