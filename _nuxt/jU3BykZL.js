const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./BYItvXCb.js","./LNDzZpPm.js","./entry.BpkB0Wh2.css","./CyofXtRf.js","./CqaOUC0Y.js","./scrollbar.wwf0UyhQ.css","./BcS6nOuf.js","./tag.C2CcED8f.css","./DuC4p7MX.js","./table.D1Uy_Ymd.css","./BNc6DVWp.js","./YPI54pvZ.js","./DwExN9Ay.js","./8WbLztfe.js","./BWnE-iKz.js"])))=>i.map(i=>d[i]);
import{E as e}from"./CqaOUC0Y.js";import{f as l,R as t,aR as r,I as n,g as a,a2 as o,c as i,o as s,a as c,O as u,A as d,t as p,J as v,d as m,D as x,i as b,ar as f,K as g,w as h,F as y,C as w,b as k,aJ as _,bg as P,a1 as I,aZ as N,a_ as C,_ as S,r as L,P as $,s as T,B as E,aD as F,m as A,n as D,p as O,b$ as M,a6 as R,am as V,e_ as z,e$ as B,f0 as U,N as j,Q as H,bU as W,ad as K,W as Y,aM as q,G as X,e as Z,bH as J,v as Q,f1 as G,E as ee,by as le,eA as te,a4 as re,f2 as ne,j as ae,U as oe,cx as ie,bq as se,br as ce,aL as ue,ec as de,bV as pe,q as ve,aE as me,b_ as xe,V as be,ap as fe,ce as ge,en as he,cq as ye,H as we,ep as ke,cm as _e,eg as Pe,y as Ie,T as Ne,cl as Ce,M as Se,eI as Le,f3 as $e,eO as Te,ak as Ee,ee as Fe,a5 as Ae,f4 as De,x as Oe,e8 as Me,aj as Re,eW as Ve,ab as ze,es as Be,aF as Ue,aN as je,c0 as He,ax as We,as as Ke,aB as Ye,et as qe,aq as Xe,eu as Ze,ew as Je}from"./LNDzZpPm.js";import{g as Qe,u as Ge,C as el,a as ll,c as tl,b as rl,d as nl,e as al,f as ol,h as il,i as sl,j as cl,t as ul,k as dl,D as pl,l as vl}from"./ChbAheob.js";import{E as ml}from"./Dl5uLHiY.js";import{E as xl}from"./CdYdV4TG.js";import{E as bl,a as fl}from"./CHAOnMYe.js";import{E as gl,a as hl,b as yl}from"./BrHgemS_.js";import{E as wl}from"./B_bYtbjB.js";import{u as kl}from"./7PWpoxWf.js";import{u as _l}from"./FG6gRdvh.js";import{U as Pl}from"./D6I9a_bc.js";import{_ as Il,a as Nl}from"./BjU_jHH0.js";import"./DQUqQXp4.js";import"./BcS6nOuf.js";import"./CyofXtRf.js";import"./DuC4p7MX.js";import"./D6i2W5JX.js";const Cl={class:"histrory"},Sl={class:"top h-39px"},Ll={class:"flex flex-col items-center justify-center ml-5px"},$l={class:"flex flex-col items-center justify-center ml-5px"},Tl={class:"flex flex-col items-center justify-center ml-5px"},El={class:"flex flex-col items-center justify-center ml-5px"},Fl={class:"flex flex-col items-center justify-center ml-5px"},Al={class:"content"},Dl=["onClick"],Ol={class:"token-info"},Ml={class:"icon-token-container relative"},Rl=["src"],Vl=["src"],zl={class:"ml-8px"},Bl={class:"flex-start"},Ul={class:"token-symbol"},jl={class:"bg-[--dialog-tab-active-bg] text-10px px-2px py-2px ml-4px rounded-2px color-[--main-text]"},Hl={key:1,class:"empty"},Wl=["src"],Kl=S(l({__name:"searchTable",props:{tokens:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1},isCanFilter:{type:Boolean,default:!1}},emits:["close","filter","sortChange","done"],setup(l,{emit:S}){const L=t(),$=l,T=S,E=r(),F=n(1),A=n("value"),D=a((()=>{var e;let l=null==(e=$.tokens)?void 0:e.slice(0);return l=l.map((e=>({...e,openInterests:o((null==e?void 0:e.openInterest)||0).times(e.indexPrice||0).toFixed()}))),0===F.value||""===A.value?$.tokens:null==l?void 0:l.sort(((e,l)=>((l[A.value]||0)-(e[A.value]||0))*F.value))})),O=a((()=>$.loading));function M(e,l,t){const r=F.value===e&&A.value===l;return"t"===t?r?"border-t-[--main-text]":"border-t-[--third-text]":r?"border-b-[--main-text]":"border-b-[--third-text]"}function R(e,l){if(A.value!==e)return A.value=e,F.value=1,void T("sortChange",{prop:A.value,order:F.value});F.value++,F.value>1&&(F.value=-1),T("sortChange",{prop:A.value,order:F.value})}return(t,r)=>{var n,a;const S=_,$=e,F=f;return s(),i("div",Cl,[c("div",Sl,[c("span",null,p(t.$t("markets1")),1),c("div",{class:"flex-end cursor-pointer select-none",onClick:r[2]||(r[2]=v((e=>R("lastPrice")),["stop"]))},[m(p(t.$t("price"))+" ",1),c("div",Ll,[c("i",{class:x(`w-0 h-0 border-solid border-4px border-transparent cursor-pointer\n            ${M(-1,"lastPrice","b")}\n            `),onClick:r[0]||(r[0]=v((e=>R("lastPrice")),["stop"]))},null,2),c("i",{class:x(`w-0 h-0 border-solid border-4px border-transparent mt-3px cursor-pointer\n            ${M(1,"lastPrice","t")}\n            `),onClick:r[1]||(r[1]=v((e=>R("lastPrice")),["stop"]))},null,2)])]),c("div",{class:"flex-end cursor-pointer select-none",onClick:r[5]||(r[5]=v((e=>R("priceChangePercent")),["stop"]))},[m(p(t.$t("24HChange"))+" ",1),c("div",$l,[c("i",{class:x(`w-0 h-0 border-solid border-4px border-transparent cursor-pointer\n            ${M(-1,"priceChangePercent","b")}\n            `),onClick:r[3]||(r[3]=v((e=>R("priceChangePercent")),["stop"]))},null,2),c("i",{class:x(`w-0 h-0 border-solid border-4px border-transparent mt-3px cursor-pointer\n            ${M(1,"priceChangePercent","t")}\n            `),onClick:r[4]||(r[4]=v((e=>R("priceChangePercent")),["stop"]))},null,2)])]),c("div",{class:"flex-end cursor-pointer select-none",onClick:r[8]||(r[8]=v((e=>R("value")),["stop"]))},[m(p(t.$t("vol"))+" ",1),c("div",Tl,[c("i",{class:x(`w-0 h-0 border-solid border-4px border-transparent cursor-pointer\n            ${M(-1,"value","b")}\n            `),onClick:r[6]||(r[6]=v((e=>R("value")),["stop"]))},null,2),c("i",{class:x(`w-0 h-0 border-solid border-4px border-transparent mt-3px cursor-pointer\n            ${M(1,"value","t")}\n            `),onClick:r[7]||(r[7]=v((e=>R("value")),["stop"]))},null,2)])]),c("div",{class:"flex-end cursor-pointer select-none",onClick:r[11]||(r[11]=v((e=>R("openInterests")),["stop"]))},[m(p(t.$t("openInterest"))+" ",1),c("div",El,[c("i",{class:x(`w-0 h-0 border-solid border-4px border-transparent cursor-pointer\n            ${M(-1,"openInterests","b")}\n            `),onClick:r[9]||(r[9]=v((e=>R("openInterests")),["stop"]))},null,2),c("i",{class:x(`w-0 h-0 border-solid border-4px border-transparent mt-3px cursor-pointer\n            ${M(1,"openInterests","t")}\n            `),onClick:r[10]||(r[10]=v((e=>R("openInterests")),["stop"]))},null,2)])]),c("div",{class:"flex-end cursor-pointer select-none",onClick:r[14]||(r[14]=v((e=>R("fundingRate")),["stop"]))},[m(p(t.$t("fundingRate"))+" ",1),c("div",Fl,[c("i",{class:x(`w-0 h-0 border-solid border-4px border-transparent cursor-pointer\n            ${M(-1,"fundingRate","b")}\n            `),onClick:r[12]||(r[12]=v((e=>R("fundingRate")),["stop"]))},null,2),c("i",{class:x(`w-0 h-0 border-solid border-4px border-transparent mt-3px cursor-pointer\n            ${M(1,"fundingRate","t")}\n            `),onClick:r[13]||(r[13]=v((e=>R("fundingRate")),["stop"]))},null,2)])])]),(null==(n=b(D))?void 0:n.length)>0||b(O)?u((s(),g($,{key:0,class:"hidden-scrollbar",height:"500px","max-height":"calc(100vh - 200px)"},{default:h((()=>[c("ul",Al,[(s(!0),i(y,null,w(b(D),((e,l)=>(s(),i("li",{key:l},[c("a",{href:"",class:"flex no-underline h-50p",onClick:v((l=>function(e){E.push({name:"perp-id",params:{name:e.contractName}}),T("close")}(e)),["stop","prevent"])},[c("div",Ol,[c("div",Ml,[k(S,{class:"token-icon",src:null==e?void 0:e.baseCoinIcon},{error:h((()=>[c("img",{class:"token-icon",src:b(P)()},null,8,Rl)])),placeholder:h((()=>[c("img",{class:"token-icon",src:b(P)()},null,8,Vl)])),_:2},1032,["src"])]),c("div",zl,[c("div",Bl,[c("span",Ul,p(e.contractName),1),c("span",jl,p(e.displayMaxLeverage)+"X",1)])])]),c("div",{class:x(Number(null==e?void 0:e.lastPrice)>0?"color-[--main-text]":"")},p(b(I)(e.lastPrice||0,8)),3),c("div",{class:x(Number(e.priceChangePercent)>0?"color-[--up-color]":"color-[--down-color]")},p(Number((null==e?void 0:e.priceChangePercent)||0)>0?"+":"")+p(b(I)(100*Number(null==e?void 0:e.priceChangePercent)||0,2))+"% ",3),c("div",{class:x(Number(e.value)>0?"color-[--main-text]":"")}," $"+p(b(I)((null==e?void 0:e.value)||0,{decimals:2,locale:"en"})),3),c("div",{class:x(Number(e.openInterest)>0?"color-[--main-text]":"")}," $"+p(b(I)(b(o)((null==e?void 0:e.openInterest)||0).times(e.indexPrice||0).toFixed(),{decimals:2,locale:"en"})),3),c("div",{class:x(Number(e.fundingRate)>0||Number(e.fundingInterestRate)>0?"color-[--main-text]":"")},p((100*Number((null==e?void 0:e.fundingRate)||e.fundingInterestRate)||0)>0?"+":"")+p(b(I)(100*Number((null==e?void 0:e.fundingRate)||e.fundingInterestRate)||0))+"% ",3)],8,Dl)])))),128))])])),_:1})),[[F,b(O)]]):d("",!0),b(O)||(null==(a=l.tokens)?void 0:a.length)?d("",!0):(s(),i("div",Hl,[c("div",null,[c("img",{src:"light"===b(L).theme?b(N):b(C)},null,8,Wl),r[15]||(r[15]=c("br",null,null,-1)),c("span",null,p(t.$t("noSearchResults")),1)])]))])}}}),[["__scopeId","data-v-a6480db8"]]),Yl={class:""},ql={class:"px-16px py-16px"},Xl=S(l({__name:"search",props:{list:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1}},emits:["close"],setup(e,{emit:l}){const t=e,r=l,o=L(""),u=L(""),p=n(0),v=a((()=>{var e;const l=(null==(e=t.list)?void 0:e.slice(0))||[];let r=null==l?void 0:l.filter((e=>e.enableDisplay));return o.value&&(r=r.filter((e=>e.contractName.toLowerCase().includes(o.value.toLowerCase())||e.baseCoinIcon.toLowerCase().includes(o.value.toLowerCase())||e.quoteCoinIcon.toLowerCase().includes(o.value.toLowerCase())))),0===p.value||""===u.value?r:null==r?void 0:r.sort(((e,l)=>((l[u.value]||0)-(e[u.value]||0))*p.value))}));function m({prop:e,order:l}){u.value=e,p.value=l}return(l,t)=>{const n=E,a=$;return s(),i("div",Yl,[c("div",ql,[k(a,{ref:"inputSearch",modelValue:b(o),"onUpdate:modelValue":t[1]||(t[1]=e=>T(o)?o.value=e:null),modelModifiers:{trim:!0},class:"search-input px-20px",placeholder:l.$t("search"),clearable:"",autofocus:"",size:"large"},{prefix:h((()=>[k(n,{class:"text-12px text-[--third-text]",name:"custom:search"})])),suffix:h((()=>[b(o)?(s(),g(n,{key:0,name:"pajamas:clear",class:"color-[--third-text] text-12px hover:opacity-70% cursor-pointer mr-10px",onClick:t[0]||(t[0]=e=>o.value="")})):d("",!0)])),_:1},8,["modelValue","placeholder"])]),k(Kl,{tokens:b(v)||[],loading:e.loading,onSortChange:m,onClose:t[2]||(t[2]=e=>r("close"))},null,8,["tokens","loading"])])}}}),[["__scopeId","data-v-ac49c6d8"]]),Zl={class:"relative scroll-wrapper"},Jl=S({__name:"swipe",setup(e){const{width:l}=F(),t=L(null),r=L(!1),n=L(!1),o=()=>{const e=t.value;e&&(r.value=e.scrollLeft>0,n.value=e.scrollWidth-e.clientWidth-e.scrollLeft>1)},u=a((()=>l.value-334-230-300-100-100)),p=()=>{t.value.scrollBy({left:-200,behavior:"smooth"})},v=()=>{t.value.scrollBy({left:200,behavior:"smooth"})};return A(l,(()=>{o()})),D((async()=>{await O(),o(),setTimeout((()=>o()),50)})),(e,l)=>{const a=E;return s(),i("div",{class:"flex-1",style:R({width:b(u)+"px"})},[c("div",Zl,[b(r)?(s(),i("div",{key:0,onClick:p,class:"absolute left-0 top-0 bottom-0 px-13px z-10 bg-[--secondary-bg] flex justify-center items-center cursor-pointer"},[k(a,{name:"material-symbols:arrow-back-ios-new-rounded",class:"color-[--third-text]"})])):d("",!0),c("div",{ref_key:"scrollRef",ref:t,onScroll:o,class:"scroll-container flex gap-4px h-full"},[M(e.$slots,"default",{},void 0,!0)],544),b(n)?(s(),i("div",{key:1,onClick:v,class:"absolute right-0 top-0 bottom-0 px-13px z-10 bg-[--secondary-bg] flex justify-center items-center cursor-pointer"},[k(a,{name:"material-symbols:arrow-forward-ios",class:"color-[--third-text]"})])):d("",!0)])],4)}}},[["__scopeId","data-v-88192a0a"]]),Ql={class:"bg-[--d-101114-l-F6F9FF] h-64px flex-start items-center justify-start py-7px px-12px"},Gl={class:"flex items-center px-4px py-4px cursor-pointer rounded-4px hover:bg-[--d-1B1D21-l-E8F1FF] cursor-pointer"},et=["src"],lt=["src"],tt={class:"ml-8px"},rt={class:"color-[--main-text] text-18px font-500 block"},nt={class:"color-[--third-text] text-12px mt-2px"},at={class:"ml-16px"},ot={class:"ml-16px whitespace-nowrap item"},it={class:"text-12px block text-left color-[--third-text] border-b-dashed border-b-1px border-[--third-text]"},st={class:"text-12px block text-left color-[--main-text] leading-16px mt-6px"},ct={class:"ml-16px whitespace-nowrap item"},ut={class:"text-12px block text-left color-[--third-text] border-b-dashed border-b-1px border-[--third-text]"},dt={class:"text-12px block text-left color-[--main-text] mt-6px"},pt={class:"ml-16px whitespace-nowrap item"},vt={class:"text-12px block text-left color-[--third-text]"},mt={class:"ml-16px whitespace-nowrap item"},xt={class:"text-12px block text-left color-[--third-text]"},bt={class:"text-12px block text-left color-[--secondary-text] mt-6px"},ft={class:"ml-16px whitespace-nowrap item"},gt={class:"text-12px block text-left color-[--third-text]"},ht={class:"text-12px block text-left color-[--secondary-text] mt-6px"},yt={class:"ml-16px whitespace-nowrap item"},wt={class:"text-12px block text-left color-[--third-text]"},kt={class:"text-12px block text-left color-[--secondary-text] mt-6px"},_t={class:"ml-16px whitespace-nowrap item"},Pt={class:"text-12px block text-left color-[--third-text]"},It={class:"text-12px block text-left color-[--secondary-text] mt-6px"},Nt={class:"ml-16px whitespace-nowrap item"},Ct={class:"text-12px block text-left color-[--third-text]"},St={class:"text-12px block text-left color-[--main-text] mt-6px"},Lt={class:"ml-16px whitespace-nowrap item"},$t={class:"text-12px block text-left color-[--third-text]"},Tt={class:"text-12px block text-left color-[--main-text] mt-6px"},Et={class:"color-#FFA622"},Ft=l({__name:"index",setup(e){const{metadata:l,loadingPerpMetadata:t,contractList:r,perp:a,tickers:v}=V(z()),f=B(),y=n(!1);return A((()=>f.wsResult[U.TICKER_ALL_1S]),(e=>{var t,n,a,o,i,s;"Snapshot"===e.dataType&&U.TICKER_ALL_1S==e.channel?(l.value&&(null==(n=null==(t=l.value)?void 0:t.contractList)?void 0:n.length)>0?r.value=(null==(o=null==(a=l.value)?void 0:a.contractList)?void 0:o.map((l=>{var t;const r=null==(t=e.data)?void 0:t.find((e=>(null==e?void 0:e.contractId)===(null==l?void 0:l.contractId)));return r&&(l={...l,...r}),l})))||[]:r.value=e.data,v.value=e.data):"changed"===e.dataType&&U.TICKER_ALL_1S==e.channel&&(r.value=(null==(i=r.value)?void 0:i.map((l=>{var t;const r=null==(t=e.data)?void 0:t.find((e=>(null==e?void 0:e.contractId)===(null==l?void 0:l.contractId)));return r&&(l={...l,...r}),l})))||[],v.value=null==(s=v.value)?void 0:s.map((l=>{var t;const r=null==(t=e.data)?void 0:t.find((e=>(null==e?void 0:e.contractId)===(null==l?void 0:l.contractId)));return r&&(l={...l,...r}),l})))})),A(y,(e=>{e?document.getElementById("tv_chart_container")&&(document.getElementById("tv_chart_container").style.pointerEvents="none"):document.getElementById("tv_chart_container")&&(document.getElementById("tv_chart_container").style.pointerEvents="auto")})),D((()=>{f.send({type:"unsubscribe",channel:"ticker.all.1s"}),setTimeout((()=>{f.send({type:"subscribe",channel:"ticker.all.1s"})}),500)})),(e,l)=>{var n,v;const f=_,w=E,N=H,C=K,S=j("tooltip");return s(),i("div",Ql,[k(N,{visible:b(y),"onUpdate:visible":l[1]||(l[1]=e=>T(y)?y.value=e:null),"popper-class":"[--el-popover-bg-color:--border]",width:750,placement:"bottom-start",trigger:"click","popper-style":"padding: 0px"},{reference:h((()=>{var l,t;return[c("div",Gl,[k(f,{class:"token-icon w-32px max-h-32px",fit:"cover",src:null==(l=b(a))?void 0:l.baseCoinIcon},{error:h((()=>[c("img",{class:"token-icon w-32px max-h-32px",src:("getChainDefaultIcon"in e?e.getChainDefaultIcon:b(P))()},null,8,et)])),placeholder:h((()=>[c("img",{class:"token-icon w-32px max-h-32px",src:("getChainDefaultIcon"in e?e.getChainDefaultIcon:b(P))()},null,8,lt)])),_:1},8,["src"]),c("div",tt,[c("span",rt,p(null==(t=b(a))?void 0:t.contractName),1),c("span",nt,p(e.$t("perpetual")),1)]),k(w,{name:b(y)?"radix-icons:triangle-up":"radix-icons:triangle-down",class:"text-18px color-[--main-text] ml-12px"},null,8,["name"])])]})),default:h((()=>[k(Xl,{list:b(r),loading:b(t),onClose:l[0]||(l[0]=e=>y.value=!1)},null,8,["list","loading"])])),_:1},8,["visible"]),c("div",at,[c("span",{class:x(["text-20px font-700 block min-w-100px text-left",Number(null==(n=b(a))?void 0:n.priceChange)>0?"color-[--up-color]":"color-[--down-color]"])},p(("formatNumber"in e?e.formatNumber:b(I))((null==(v=b(a))?void 0:v.lastPrice)||0,10)),3)]),l[3]||(l[3]=c("div",{class:"w-0 border-l-[--icon-color] border-l-solid h-28px"},null,-1)),k(Jl,null,{default:h((()=>{var t,r,n,v,f,y,w,k,_,P,N,L,$,T,E,F,A,D,O,M,R,V,z,B,U,j;return[c("div",ot,[u((s(),i("span",it,[m(p(e.$t("indexPrice")),1)])),[[S,e.$t("indexPriceTooltip")]]),c("span",st,p(("formatNumber"in e?e.formatNumber:b(I))((null==(t=b(a))?void 0:t.indexPrice)||0,("getPricePrecision"in e?e.getPricePrecision:b(Qe))((null==(r=b(a))?void 0:r.contractId)||""))),1)]),c("div",ct,[u((s(),i("span",ut,[m(p(e.$t("oraclePrice")),1)])),[[S,e.$t("oraclePriceTooltip")]]),c("span",dt,p(("formatNumber"in e?e.formatNumber:b(I))((null==(n=b(a))?void 0:n.oraclePrice)||0,("getPricePrecision"in e?e.getPricePrecision:b(Qe))((null==(v=b(a))?void 0:v.contractId)||""))),1)]),c("div",pt,[c("span",vt,p(e.$t("24HChange")),1),c("span",{class:x(["text-12px block text-left mt-6px",Number(null==(f=b(a))?void 0:f.priceChange)>0?"color-[--up-color]":"color-[--down-color]"])},p(Number((null==(y=b(a))?void 0:y.priceChange)||0)>0?"+":"")+p(("formatNumber"in e?e.formatNumber:b(I))((null==(w=b(a))?void 0:w.priceChange)||0))+" ("+p(Number((null==(k=b(a))?void 0:k.priceChangePercent)||0)>0?"+":"")+p(("formatNumber"in e?e.formatNumber:b(I))(100*Number(null==(_=b(a))?void 0:_.priceChangePercent)||0,2))+"%)",3)]),c("div",mt,[c("span",xt,p(e.$t("24HHighPrice")),1),c("span",bt,p(("formatNumber"in e?e.formatNumber:b(I))((null==(P=b(a))?void 0:P.high)||0)),1)]),c("div",ft,[c("span",gt,p(e.$t("24HLowestPrice")),1),c("span",ht,p(("formatNumber"in e?e.formatNumber:b(I))((null==(N=b(a))?void 0:N.low)||0)),1)]),c("div",yt,[c("span",wt,p(e.$t("24HVolume"))+"("+p(null==(L=b(a))?void 0:L.quoteCoin)+")",1),c("span",kt,p(("formatNumber"in e?e.formatNumber:b(I))((null==($=b(a))?void 0:$.value)||0,{limit:11,decimals:2})),1)]),c("div",_t,[c("span",Pt,p(e.$t("24HAmount"))+"("+p(null==(T=b(a))?void 0:T.baseCoin)+")",1),c("span",It,p(("formatNumber"in e?e.formatNumber:b(I))((null==(E=b(a))?void 0:E.size)||0)),1)]),c("div",Nt,[c("span",Ct,p(e.$t("openInterest"))+"("+p(null==(F=b(a))?void 0:F.quoteCoin)+")",1),c("span",St,p(("formatNumber"in e?e.formatNumber:b(I))(null==(M=null==(O=b(o)((null==(A=b(a))?void 0:A.openInterest)||0).times((null==(D=b(a))?void 0:D.indexPrice)||0))?void 0:O.toFixed)?void 0:M.call(O),{limit:11,decimals:2})),1)]),c("div",Lt,[c("span",$t,p(e.$t("fundingRate"))+" / "+p(e.$t("countdown")),1),c("span",Tt,[c("span",{class:x(Number(null==(R=b(a))?void 0:R.fundingRate)>0?"color-[--up-color]":"color-[--down-color]")},p(("addSign"in e?e.addSign:b(W))(100*Number(null==(V=b(a))?void 0:V.fundingRate)||0))+p(("formatNumber"in e?e.formatNumber:b(I))(100*Number(null==(z=b(a))?void 0:z.fundingRate)||0))+"% ",3),l[2]||(l[2]=c("span",{class:"text-12px color-[--third-text]"}," / ",-1)),(null==(B=b(a))?void 0:B.nextFundingTime)?(s(),g(C,{key:`${null==(U=b(a))?void 0:U.nextFundingTime}`,timestamp:Number(null==(j=b(a))?void 0:j.nextFundingTime)/1e3,"end-time":Date.now()},{default:h((({formattedData:{days:e,hours:l,minutes:t,seconds:r}})=>[c("span",Et,p(l||"00")+":"+p(t||"00")+":"+p(r||"00"),1)])),_:1},8,["timestamp","end-time"])):d("",!0)])])]})),_:1})])}}}),At={class:"text-center text-14px w-100% absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2"},Dt={key:2},Ot={key:3},Mt={class:"mt-20px"},Rt=l({__name:"connect",setup(e){const{connectAndLogin:l}=Ge(),r=Y(),n=z(),a=t();return(e,t)=>{const o=E,v=X;return u((s(),i("div",At,[b(a).isDark?(s(),g(o,{key:0,name:"custom:wallet1",class:"text-40px mb-16px"})):(s(),g(o,{key:1,name:"custom:wallet1-light",class:"text-40px mb-16px"})),b(r).address?b(r).address&&!b(n).isLogin?(s(),i("div",Ot,p(e.$t("pluginWalletConnectedTips")),1)):d("",!0):(s(),i("div",Dt,p(e.$t("connectWalletAndDepositFunds")),1)),c("div",Mt,[b(r).address?d("",!0):(s(),g(v,{key:0,type:"primary",onClick:b(l)},{default:h((()=>[m(p(e.$t("connectWallet")),1)])),_:1},8,["onClick"])),b(r).address&&!b(n).isLogin?(s(),g(v,{key:1,type:"primary",onClick:b(l)},{default:h((()=>[m(p(e.$t("loginPerpAccount")),1)])),_:1},8,["onClick"])):d("",!0)])],512)),[[q,!b(n).isConnectLogin]])}}}),Vt={class:"gauge",width:"20",height:"12",viewBox:"0 0 20 12",fill:"none",xmlns:"http://www.w3.org/2000/svg"},zt=["fill"],Bt=["fill"],Ut=["fill"],jt=["transform"],Ht=S({__name:"progress",props:{progress:{type:Number,default:0}},setup(e){const l=e,t="#12B886",r="#FFA622",n="#F6465D",o=a((()=>{var e;return(e=l.progress,Math.max(0,Math.min(100,Number(e)||0)))/100*180-107.5})),u=a((()=>`rotate(${o.value||0} 10 10)`));return(e,l)=>(s(),i("svg",Vt,[c("path",{d:"M6.86328 4.56738C5.91162 5.11806 5.11807 5.91158 4.56738 6.86328C4.03354 7.78596 3.72755 8.85736 3.72754 10H0C8.69342e-06 8.17828 0.486741 6.47006 1.33789 4.99902C2.21593 3.48154 3.48154 2.21593 4.99902 1.33789L6.86328 4.56738Z",fill:t},null,8,zt),c("path",{d:"M10 0C11.8218 0 13.5299 0.486757 15.001 1.33789L13.1367 4.56738C12.3293 4.10019 11.408 3.80795 10.4248 3.74219L10 3.72754C8.85739 3.72754 7.78598 4.03353 6.86328 4.56738L4.99902 1.33789C6.47006 0.4868 8.17827 0 10 0Z",fill:r},null,8,Bt),c("path",{d:"M15.001 1.33789C16.5185 2.21593 17.784 3.48159 18.6621 4.99902C19.5132 6.47006 20 8.17827 20 10H16.2725C16.2725 8.85741 15.9665 7.78596 15.4326 6.86328C14.8819 5.91163 14.0884 5.11807 13.1367 4.56738L15.001 1.33789Z",fill:n},null,8,Ut),c("g",{transform:u.value,style:{transition:"transform 400ms ease"}},l[0]||(l[0]=[c("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M10.4278 9.93676C10.3654 10.1474 10.1439 10.2676 9.93331 10.2051C9.72264 10.1426 9.60249 9.92121 9.66498 9.71058L10.9353 5.42634C10.9977 5.21567 11.2192 5.09552 11.4298 5.15801C11.6405 5.22047 11.7606 5.4419 11.6981 5.65253L10.4278 9.93676Z",fill:"#9CA1A8"},null,-1),c("path",{d:"M11.0517 8.51568C10.4884 7.95239 9.57509 7.95239 9.01181 8.51567C8.44852 9.07896 8.44853 9.99223 9.01181 10.5555C9.5751 11.1188 10.4884 11.1188 11.0517 10.5555C11.6149 9.99223 11.6149 9.07897 11.0517 8.51568Z",fill:"#9CA1A8"},null,-1)]),8,jt)]))}},[["__scopeId","data-v-5fa45363"]]),Wt={key:0},Kt={class:"text-14px font-700 mb-15px"},Yt={class:"flex items-center"},qt={class:"mt-15px text-12px font-400 color-[--main-text]"},Xt={class:"flex items-center mb-12px"},Zt={class:"flex items-center justify-between"},Jt={class:"color-[--third-text]"},Qt={class:"flex items-center justify-between mt-12px"},Gt={class:"color-[--third-text]"},er={class:"font-500"},lr={class:"flex items-center justify-between mt-12px"},tr={class:"color-[--third-text]"},rr=l({__name:"userAssert",setup(e){const l=t(),r=z(),n=Y(),{prepBalance:f,unrealizedPnl:w,maintenanceMarginRequirement:_,deposit:P,withdraw:N}=Ge();const C=a((()=>new o(_.value).div(f.value).times(100).toNumber())),S="#12B886",L="#FFA622",$="#F6465D",T=a((()=>!C.value||C.value<40?{color:S}:C.value<=60?{color:L}:{color:$}));return(e,t)=>{const a=X,S=E,L=Z,$=j("tooltip");return s(),i(y,null,[k(Rt),b(r).isConnectLogin?(s(),i("div",Wt,[c("div",Kt,p(e.$t("myPerpAccount")),1),c("div",Yt,[(s(),g(a,{key:b(l).theme,class:"flex-1",type:"primary",size:"large",onClick:v(b(P),["stop"])},{default:h((()=>[m(p(e.$t("deposit")),1)])),_:1},8,["onClick"])),(s(),g(a,{key:b(l).theme,class:"flex-1",color:"var(--main-input-button-bg)",size:"large",onClick:v(b(N),["stop"])},{default:h((()=>[m(p(e.$t("withdraw")),1)])),_:1},8,["onClick"]))]),c("ul",qt,[c("li",Xt,[k(Ht,{progress:b(C)},null,8,["progress"]),u((s(),i("span",{class:"ml-5px underline underline-dotted cursor-pointer",style:R(b(T))},[m(p(("formatNumber"in e?e.formatNumber:b(I))(b(C),2))+"%",1)],4)),[[$,`<div style='max-width: 200px'>${e.$t("marginRatioTips")}</div>`,void 0,{raw:!0}]])]),c("li",Zt,[c("span",Jt,p(e.$t("totalAssets")),1),k(L,{class:"flex items-center clickable font-500",to:`/address/${b(n).address}/${b(n).chain}?active=perp`},{default:h((()=>[c("span",null,p(("formatNumber"in e?e.formatNumber:b(I))(b(f),4))+" USD",1),k(S,{name:"material-symbols:chevron-right-rounded",class:"text-16px mr--5px"})])),_:1},8,["to"])]),c("li",Qt,[c("span",Gt,p(e.$t("maintenanceMargin")),1),c("span",er,p(("formatNumber"in e?e.formatNumber:b(I))(b(_),4))+" USD",1)]),c("li",lr,[c("span",tr,p(e.$t("unrealizedPnl1")),1),c("span",{class:x(["font-500",(F=b(w),new o(F).gte(0)?"color-[--up-color]":"color-[--down-color]")])},p(("formatNumber"in e?e.formatNumber:b(I))(b(w),2))+" USD",3)])])])):d("",!0)],64);var F}}}),nr={class:"flex items-center justify-between bg-[--dialog-divider] rounded-4px px-5 h-12 w-full select-none step"},ar=["value"],or=S(l({__name:"step",props:{modelValue:{},min:{default:0},max:{default:1/0},step:{default:1},longPressSpeed:{default:120}},emits:["update:modelValue","change"],setup(e,{emit:l}){const t=e,r=l,n=L(String(t.modelValue));A((()=>t.modelValue),(e=>{n.value=String(e)}));const o=a((()=>t.modelValue<=t.min)),u=a((()=>t.modelValue>=t.max));function d(e){r("update:modelValue",e)}function p(){o.value||d(t.modelValue-t.step)}function b(){u.value||d(t.modelValue+t.step)}let f=null;function g(e){"minus"===e?p():b(),h(),f=J((()=>{"minus"===e?p():b()}),t.longPressSpeed)}function h(){f&&(clearInterval(f),f=null)}function y(e){const l=e.target;let a=l.value.replace(/[^\d]/g,"");t.max<10&&(a=a.slice(0,1)),Number(a)>t.max&&(a=n.value);const o=Number(a);n.value=a,l.value=a,r("change",o)}function w(){let e=Number(n.value);e&&(e<t.min&&(e=t.min),e>t.max&&(e=t.max)),d(e),r("change",e)}return(e,l)=>{const t=E;return s(),i("div",nr,[c("button",{class:x(["color-[--main-text] transition-transform duration-100 cursor-pointer flex items-center justify-center active:scale-90",o.value&&"opacity-30 cursor-not-allowed"]),onMousedown:l[0]||(l[0]=e=>g("minus")),onMouseup:h,onMouseleave:h,onTouchstart:l[1]||(l[1]=v((e=>g("minus")),["prevent"])),onTouchend:h},[k(t,{name:"majesticons:minus",class:"text-24px"})],34),l[4]||(l[4]=c("span",{class:"flex-1"},null,-1)),c("input",{name:"step",class:"w-60px bg-transparent outline-none text-center border-none text-18px",value:n.value,onInput:y,onBlur:w},null,40,ar),l[5]||(l[5]=m("X ")),l[6]||(l[6]=c("span",{class:"flex-1"},null,-1)),c("button",{class:x(["color-[--main-text] transition-transform duration-100 cursor-pointer flex items-center justify-center active:scale-90",u.value&&"opacity-30 cursor-not-allowed"]),onMousedown:l[2]||(l[2]=e=>g("plus")),onMouseup:h,onMouseleave:h,onTouchstart:l[3]||(l[3]=v((e=>g("plus")),["prevent"])),onTouchend:h},[k(t,{name:"majesticons:plus",class:"text-24px"})],34)])}}}),[["__scopeId","data-v-5dfbd965"]]),ir={class:"flex-start items-center"},sr={class:"text-20px font-500 cursor-pointer"},cr={class:"content"},ur={class:"text-14px font-700 font-bold"},dr={class:"color-[--secondary-text] ml-8px"},pr={class:"mt-20px mb-30px px-3px w-full"},vr={class:"text-14px flex-between mt-48px"},mr={class:"color-[--third-text]"},xr={class:"text-14px flex-between mt-24px"},br={class:"color-[--third-text]"},fr={class:"text-12px color-[--yellow] flex-between mt-24px"},gr={key:0,class:"text-12px mt-24px color-[--yellow] flex-start items-start"},hr={class:"mb-10px"},yr={key:1},wr={key:1,class:"text-12px mt-10px color-[--yellow]"},kr={class:"text-center mt-30px flex-between"},_r=S(l({__name:"leverageDialog",props:{modelValue:Boolean},emits:["update:modelValue"],setup(e,{emit:l}){const t=e,r=l,f=a({get:()=>t.modelValue??!1,set:e=>r("update:modelValue",e)}),{position:y,metadata:w,perp:_,contractId:P,userInfo:N}=V(z()),C=z(),{getOnboardSite:S}=z(),{t:$}=Q();G();const E=n(1);L([]);const F=n(!1),D=n("0"),O=n(0),M=a((()=>U.value?q(U.value):"0"));a((()=>{var e;const l={contractId:P.value,orderSide:"BUY",inputLever:String(E.value)};return el.getRiskLimitTierMaxOpenQuantityWithLever(l).times((null==(e=null==_?void 0:_.value)?void 0:e.oraclePrice)||0).toFixed()}));const R=a((()=>{var e;return Number((null==(e=_.value)?void 0:e.displayMaxLeverage)||0)})),B=a((()=>{var e;return Number((null==(e=_.value)?void 0:e.displayMinLeverage)||0)})),U=a((()=>ll(P.value))),H=a((()=>{var e;return tl((null==(e=C.perp)?void 0:e.contractId)||"").toString()||"0"})),W=a((()=>{var e;const l=el.getSymbolModel((null==(e=C.perp)?void 0:e.contractId)||"");if(new o((null==l?void 0:l.oraclePrice)||0).times(1.001).isZero())return"0";const t=(null==l?void 0:l.riskTierList)||[],r=el.getRiskTierModel(String(E.value),t);return((null==r?void 0:r.positionValueUpperBound)||0).toString()})),K=a((()=>{const e={},l=(R.value-B.value)/5;for(let t=0;t<=5;t++){const r=+Math.floor(B.value+t*l);e[r]=String(r+"X")}return e}));A(f,(e=>{e&&(E.value=Number(U.value||0))}));const Y=a((()=>{var e;return!(null==(e=C.order)?void 0:e.some((e=>e.contractId===P.value&&"CANCELED"!==e.status)))}));function q(e){var l;return rl(P.value,(null==(l=null==_?void 0:_.value)?void 0:l.oraclePrice)||"0",e).toFixed()}const Z=a((()=>E.value?q(String(E.value)):"0")),J=a((()=>E.value?Number(Z.value)-Number(M.value):0));function ae(e){e?(D.value=q(String(e)),O.value=Number(D.value)-Number(M.value)):(D.value="0",O.value=0)}function oe(){var e;(null==(e=N.value)?void 0:e.id)||re.error($("connectWalletFirst"));const l={contractId:P.value,leverage:String(E.value)};F.value=!0,ne(l).then((()=>{re.success($("success")),S(),f.value=!1})).catch((e=>{re.error(null==e?void 0:e.message)})).finally((()=>{F.value=!1}))}return(e,l)=>{const t=ml,r=le,n=X,a=ee,y=j("slider-active");return s(),g(a,{modelValue:b(f),"onUpdate:modelValue":l[3]||(l[3]=e=>T(f)?f.value=e:null),width:"400px",class:"dialog-box dialog-max dialog-remind dialog","append-to-body":"",onClose:l[4]||(l[4]=e=>f.value=!1)},{header:h((()=>[c("div",ir,[c("span",sr,p(e.$t("adjustLeverage")),1)])])),default:h((()=>{var a,g,w;return[c("div",cr,[c("div",null,[c("span",ur,p(null==(a=b(_))?void 0:a.contractName),1),c("span",dr,p(e.$t("currentLeverage"))+":"+p(b(U))+"X",1)]),k(or,{modelValue:b(E),"onUpdate:modelValue":l[0]||(l[0]=e=>T(E)?E.value=e:null),class:"mt-19px",max:b(R),onChange:ae},null,8,["modelValue","max"]),c("div",pr,[u(k(t,{modelValue:b(E),"onUpdate:modelValue":l[1]||(l[1]=e=>T(E)?E.value=e:null),min:b(B),max:b(R),step:1,marks:b(K),"format-tooltip":e=>e+"X",class:"[&&]:[--el-slider-button-size:16px] [--el-color-white:--icon-color] [&&]:[--el-slider-height:2px] [&&]:[--el-slider-button-wrapper-offset:-17px] [&&]:h-auto [&&]:[w-auto] [--el-border-color-light:var(--dialog-divider)] [&&]:[--el-slider-main-bg-color:--main-text] slider-box",onInput:ae},null,8,["modelValue","min","max","marks","format-tooltip"]),[[y]])]),c("div",vr,[c("span",mr,p(e.$t("positionMargin")),1),c("span",null,p(("formatNumber"in e?e.formatNumber:b(I))(b(M),{decimals:4,limit:10}))+" USD",1)]),c("div",xr,[c("span",br,p(e.$t("maxPositionCurrentLeverage")),1),c("span",null,p(Number(b(W))>10**12?"∞":("formatNumber"in e?e.formatNumber:b(I))(b(W),{decimals:0,limit:10})+" USD"),1)]),c("div",fr," *"+p(e.$t("adjustLeverageTip1")),1),!(null==(g=b(o)(b(J)||0))?void 0:g.isZero())&&b(E)?(s(),i("div",gr,[k(r,{style:{"vertical-align":"middle"},class:"text-14px mr-5px"},{default:h((()=>[k(b(te))])),_:1}),c("div",hr,[b(o)(b(J)).lte(0)||b(o)(b(J)).abs().lte(b(H))?(s(),i("span",{key:0,class:x(["block",b(J)>0?"color-[--down-color]":"color-[--up-color]"])},p(b(J)>0?e.$t("adjustLeverageTip4",{num:("formatNumber"in e?e.formatNumber:b(I))(Math.abs(b(J)),{decimals:4,limit:10})}):e.$t("adjustLeverageTip5",{num:("formatNumber"in e?e.formatNumber:b(I))(Math.abs(b(J)),{decimals:4,limit:10})})),3)):(s(),i("span",yr,p(e.$t("adjustLeverageTip3")),1))])])):d("",!0),b(Y)?d("",!0):(s(),i("div",wr,p(e.$t("adjustLeverageTip2",{name:null==(w=b(_))?void 0:w.contractName})),1)),c("div",kr,[k(n,{class:"flex-1",style:{height:"48px"},onClick:l[2]||(l[2]=v((e=>f.value=!1),["stop","prevent"]))},{default:h((()=>[m(p(e.$t("cancel")),1)])),_:1}),k(n,{class:"flex-1",style:{height:"48px"},type:"primary",disabled:!b(Y),loading:b(F),onClick:v(oe,["stop","prevent"])},{default:h((()=>[m(p(e.$t("confirm")),1)])),_:1},8,["disabled","loading"])])])]})),_:1},8,["modelValue"])}}}),[["__scopeId","data-v-3eebef83"]]),Pr={class:"flex items-center gap-16px color-[--main-text] text-12px font-500 text-center"},Ir={class:"flex-1 h-24px flex items-center justify-center bg-[--main-input-button-bg] border-none rd-4px"},Nr=l({__name:"leverageSet",setup(e){const l=z(),t=a((()=>{var e;const t=(null==(e=l.perp)?void 0:e.contractId)||"";return ll(t)})),r=n(!1);return(e,l)=>(s(),i("div",Pr,[c("div",Ir,p(e.$t("cross")),1),c("button",{class:"flex-1 color-[--main-text] h-24px flex items-center justify-center bg-[--main-input-button-bg] border-none rd-4px relative clickable",onClick:l[0]||(l[0]=e=>r.value=!0)},[c("span",null,p(b(t))+"x",1)]),k(_r,{modelValue:b(r),"onUpdate:modelValue":l[1]||(l[1]=e=>T(r)?r.value=e:null)},null,8,["modelValue"])]))}}),Cr={class:"text-12px color-[--secondary-text] mb-12px text-right"},Sr={class:"inline-flex items-center"},Lr={key:0,class:"absolute z-4 bg-[--main-input-button-bg] top-50% translate-y--50% left-1px pl-15px pointer-events-none"},$r={class:"inline-flex items-center clickable"},Tr={class:"text-12px font-400"},Er={class:"mt-20px px-5px w-full"},Fr={key:1,class:"flex items-center justify-between text-12px font-400 mt-8px color-[--main-text] mb-8px"},Ar={class:"text-left"},Dr={class:"color-[--third-text] mb-5px"},Or={class:"font-500"},Mr={class:"text-right"},Rr={class:"color-[--third-text] mb-5px"},Vr={class:"font-500"},zr={class:"flex items-center gap-10px mt-8px mb-8px w-full"},Br={class:"flex items-center gap-10px mt-8px mb-8px w-full"},Ur={class:"w-full flex item-center"},jr={class:"text-12px color-[--third-text]"},Hr={class:"flex items-center"},Wr={class:"mr-auto"},Kr={class:"color-[--up-color]"},Yr={class:"color-[--down-color]"},qr={class:"flex items-center mt-8px"},Xr={class:"color-[--up-color]"},Zr={class:"color-[--down-color]"},Jr={key:0,class:"flex items-center mt-8px"},Qr={class:"mr-auto"},Gr={class:"color-[--up-color]"},en={class:"color-[--down-color]"},ln={class:"flex items-center mt-8px"},tn={class:"mr-auto"},rn={class:"color-[--up-color]"},nn={class:"color-[--down-color]"},an=S(l({__name:"swap",setup(e){const{t:l}=Q(),t=z(),r=n("MARKET"),f=a((()=>[{value:"LIMIT",name:l("limit")},{value:"MARKET",name:l("market")}])),{createPerpOrder:_}=Ge(),P=ae({price:void 0,amount:void 0,reduceOnly:!1}),N=oe("formRef"),C=a((()=>({price:[{validator:(e,t,r)=>{!t||t&&new o(t).lte(0)?r(new Error(l("plsEnterPrice"))):r()},trigger:"change"}],amount:[{validator:(e,t,r)=>{(!t||t&&new o(t).lte(0))&&0===Number($.value)?r(new Error(ne.value?l("plsEnterOrderValue"):l("plsEnterOrderAmount"))):r()},trigger:"change"}]}))),S=L(!1),$=L(0),F=L(!1),D=ae({tpPercent:0,tpPercent1:0,slPercent:0,slPercent1:0,sizePercent:0});A((()=>P.reduceOnly),(()=>{P.reduceOnly&&(F.value=!1)}));const O=a((()=>{var e;return(null==(e=t.perp)?void 0:e.contractId)||""})),M=a((()=>Qe(O.value||""))),R=a((()=>nl(O.value||""))),V=a((()=>ll(O.value||"")||1)),B=a((()=>{var e;return(null==(e=el.getSymbolModel(O.value||""))?void 0:e.lastPrice)||"0"})),U=L(!1);function H(){N.value&&(P.amount=void 0,N.value.clearValidate("amount")),$.value=0,D.tpPercent=0,D.tpPercent1=0,D.slPercent=0,D.slPercent1=0,D.sizePercent=0,W.triggerPrice=void 0,K.triggerPrice=void 0}A((()=>{var e;return(null==(e=t.perp)?void 0:e.contractId)||""}),(e=>{var l;e&&(U.value=!0,H(),P.price=Number((null==(l=el.getSymbolModel(e||""))?void 0:l.oraclePrice)||"0"),setTimeout((()=>{var e,l;P.price=Number((null==(e=t.perp)?void 0:e.oraclePrice)||(null==(l=t.perp)?void 0:l.lastPrice)||"0"),U.value=!1}),300))})),A(V,(()=>{H()})),A(r,(()=>{W.triggerPrice=void 0,K.triggerPrice=void 0,D.tpPercent=0,D.tpPercent1=0,D.slPercent=0,D.slPercent1=0}));const W=ae({triggerPrice:void 0,triggerPriceType:"LAST_PRICE",type:"TAKE_PROFIT_MARKET"}),K=ae({triggerPrice:void 0,triggerPriceType:"LAST_PRICE",type:"STOP_MARKET"}),Y=a((()=>{var e,l,n;const a=(null==(e=t.perp)?void 0:e.contractId)||"";return{buy:al({contractId:a,size:Number(ve()||"0"),side:"BUY",price:"LIMIT"===r.value?Number(P.price||0):0,isMarketOrder:"LIMIT"!==r.value,oraclePrice:Number((null==(l=t.perp)?void 0:l.oraclePrice)||"0")}).toFixed(),sell:al({contractId:a,size:Number(ve(1)||"0"),side:"SELL",price:"LIMIT"===r.value?Number(P.price||0):0,isMarketOrder:"LIMIT"!==r.value,oraclePrice:Number((null==(n=t.perp)?void 0:n.oraclePrice)||"0")}).toFixed()}})),q=a((()=>{var e;return tl((null==(e=t.perp)?void 0:e.contractId)||"").toString()||"0"})),Z=a((()=>{var e;const{takerFeeRate:l,makerFeeRate:r}=ol((null==(e=t.perp)?void 0:e.contractId)||"");return{takerFeeRate:o(l).times(100).toFixed(),makerFeeRate:o(r).times(100).toFixed()}})),J=a((()=>{var e,l,n,a,o;let i=("LIMIT"===r.value?P.price:(null==(e=t.perp)?void 0:e.oraclePrice)||(null==(l=t.perp)?void 0:l.lastPrice))||"0";ne.value||(i="1");const s=Number(("LIMIT"===r.value?P.price:(null==(n=t.perp)?void 0:n.oraclePrice)||(null==(a=t.perp)?void 0:a.lastPrice))||0);return il({contractId:(null==(o=t.perp)?void 0:o.contractId)||"",type:r.value,side:"BUY",price:s,reduceOnly:P.reduceOnly}).times(i).toFixed()})),G=a((()=>{var e,l,n,a,o;let i=("LIMIT"===r.value?P.price:(null==(e=t.perp)?void 0:e.oraclePrice)||(null==(l=t.perp)?void 0:l.lastPrice))||"0";ne.value||(i="1");const s=Number(("LIMIT"===r.value?P.price:(null==(n=t.perp)?void 0:n.oraclePrice)||(null==(a=t.perp)?void 0:a.lastPrice))||0);return il({contractId:(null==(o=t.perp)?void 0:o.contractId)||"",type:r.value,side:"SELL",price:s,reduceOnly:P.reduceOnly}).times(i).toFixed()})),ee=a((()=>o.max(J.value||"0",G.value||"0").toNumber())),le=a((()=>{var e,l,n;const a=Number(("LIMIT"===r.value?P.price:(null==(e=t.perp)?void 0:e.oraclePrice)||(null==(l=t.perp)?void 0:l.lastPrice))||0),o=ve()||"0";return sl({contractId:(null==(n=t.perp)?void 0:n.contractId)||"",side:"BUY",price:Number(a)||0,size:Number(o)})})),te=a((()=>{var e,l,n;const a=Number(("LIMIT"===r.value?P.price:(null==(e=t.perp)?void 0:e.oraclePrice)||(null==(l=t.perp)?void 0:l.lastPrice))||0),o=ve(1)||"0";return sl({contractId:(null==(n=t.perp)?void 0:n.contractId)||"",side:"SELL",price:Number(a)||0,size:Number(o)})}));const ne=a((()=>{var e,l;return(null==(e=t.unit)?void 0:e.coinId)===(null==(l=t.perp)?void 0:l.quoteCoinId)}));function pe(e,l=ne.value,r){var n,a;const i=null==(n=null==e?void 0:e.replace)?void 0:n.call(e,/-|[^\d.]/g,"");if(""===i)return"";if(/^0\.0*$/.test(i)||"0"===i)return i;const{tickSize:s,stepSize:c}=el.getSymbolModel((null==(a=t.perp)?void 0:a.contractId)||"")||{};return l?new o(i).lt(s||"0")?s||"0":ul(i,s||"0",r):new o(i).lt(c||"0")?c||"0":ul(i,c||"0",r)}function ve(e=0){var l,n,a,i,s,c,u;if(ne.value){const u=Number(("LIMIT"===r.value?P.price:(null==(l=t.perp)?void 0:l.oraclePrice)||(null==(n=t.perp)?void 0:n.lastPrice))||0);if($.value>0){const l=Number(("LIMIT"===r.value?P.price:(null==(a=t.perp)?void 0:a.oraclePrice)||(null==(i=t.perp)?void 0:i.lastPrice))||0),n=il({contractId:(null==(s=t.perp)?void 0:s.contractId)||"",type:r.value,side:1===e?"SELL":"BUY",price:l,reduceOnly:P.reduceOnly}).toString();return cl({maxQty:n,ratio:$.value,stepSize:(null==(c=t.perp)?void 0:c.stepSize)||"0"})}return ie(o(P.amount||"0").div(u).times(10**R.value).dp(0).div(10**R.value).toFixed(),4)}return $.value>0?cl({maxQty:1===e?G.value||"0":J.value||"0",ratio:$.value,stepSize:(null==(u=t.perp)?void 0:u.stepSize)||"0"}):P.amount||"0"}function me(){var e;const l=null==(e=t.tickers)?void 0:e.find((e=>e.contractId===(null==t?void 0:t.contractId))),r=(null==l?void 0:l.bestBidPrice)||0,n=(null==l?void 0:l.bestAskPrice)||0;P.price=o(r).plus(n).dividedBy(2).dp(M.value,o.ROUND_FLOOR).toNumber(),setTimeout((()=>{N.value&&N.value.clearValidate("price")}),100)}const xe=a((()=>{var e,l;if(ne.value){const n=Number(("LIMIT"===r.value?P.price:(null==(e=t.perp)?void 0:e.oraclePrice)||(null==(l=t.perp)?void 0:l.lastPrice))||0);return o(ve()).times(n||"0").toFixed()}return ve()})),be=a((()=>{var e,l;if(ne.value){const n=Number(("LIMIT"===r.value?P.price:(null==(e=t.perp)?void 0:e.oraclePrice)||(null==(l=t.perp)?void 0:l.lastPrice))||0);return o(ve(1)).times(n||"0").toFixed()}return ve(1)})),fe=a((()=>{if(o(ve()||0).lte(0)||o(W.triggerPrice||0).lte(0))return"";const e="LIMIT"===r.value?P.price:B.value;if(!e)return"";if(o(W.triggerPrice||0).gt(e)){const t=o(ve()||0),r=o(W.triggerPrice||0).minus(e).times(t).abs().dp(2).toFixed();return l("longExpectedProfitUSD",{n:r})}{const t=o(ve(1)||0),r=o(W.triggerPrice||0).minus(e).times(t).abs().dp(2).toFixed();return l("shortExpectedProfitUSD",{n:r})}})),ge=a((()=>{if(o(ve()||0).lte(0)||o(K.triggerPrice||0).lte(0))return"";const e="LIMIT"===r.value?P.price:B.value;if(!e)return"";if(o(K.triggerPrice||0).lt(e)){const t=o(ve()||0),r=o(K.triggerPrice||0).minus(e).times(t).abs().dp(2).toFixed();return l("longExpectedLossUSD",{n:r})}{const t=o(ve(1)||0),r=o(K.triggerPrice||0).minus(e).times(t).abs().dp(2).toFixed();return l("shortExpectedLossUSD",{n:r})}}));function he(e){var n;null==(n=N.value)||n.validate((n=>{var a,i;if(n){const n={type:r.value,size:String(ve("BUY"===e?0:1)),price:String(P.price||"0"),side:e,contractId:(null==(a=t.perp)?void 0:a.contractId)||"",reduceOnly:P.reduceOnly,isPositionTpsl:!1,isSetOpenTp:!1,isSetOpenSl:!1};W.triggerPrice&&(n.isSetOpenTp=!0,n.openTp={...W,triggerPrice:new o((null==W?void 0:W.triggerPrice)||"0").toFixed(),price:"0",size:String(ve("BUY"===e?0:1)),side:"BUY"===e?"SELL":"BUY"}),K.triggerPrice&&(n.isSetOpenSl=!0,n.openSl={...K,triggerPrice:new o((null==K?void 0:K.triggerPrice)||"0").toFixed(),price:"0",size:String(ve("BUY"===e?0:1)),side:"BUY"===e?"SELL":"BUY"});const s=null==(i=null==t?void 0:t.position)?void 0:i.find((e=>{var l;return e.contractId===(null==(l=t.perp)?void 0:l.contractId)}));if(n.reduceOnly&&!(n.reduceOnly&&s&&s.openSize&&("BUY"===n.side&&o(s.openSize).lt(0)||"SELL"===n.side&&o(s.openSize).gt(0))&&o(n.size||0).lt(o(s.openSize).abs())))return void re({message:l("orderSizeError"),type:"error"});_(n).then((e=>{e&&H()}))}}))}return(e,n)=>{var a,_;const L=fl,A=bl,O=xl,z=ce,H=E,Q=yl,re=hl,ae=gl,oe=ml,ie=ue,ye=wl,we=X,ke=se,_e=de,Pe=j("slider-active");return s(),i(y,null,[k(A,{modelValue:b(r),"onUpdate:modelValue":n[0]||(n[0]=e=>T(r)?r.value=e:null),class:"select-tabs mt-5px mb-12px"},{default:h((()=>[(s(!0),i(y,null,w(b(f),((e,l)=>(s(),g(L,{key:l,label:e.name,name:e.value},null,8,["label","name"])))),128))])),_:1},8,["modelValue"]),c("div",Cr,p(e.$t("available"))+": "+p(("formatNumber"in e?e.formatNumber:b(I))(b(q),4))+" USD",1),k(ke,{ref_key:"formRef",ref:N,model:b(P),"label-width":"auto",rules:b(C),onSubmit:n[18]||(n[18]=v((()=>{}),["prevent"]))},{default:h((()=>{var a,f;return["LIMIT"===b(r)?(s(),g(z,{key:0,label:"",prop:"price",style:{"margin-bottom":"15px"}},{default:h((()=>[k(O,{modelValue:b(P).price,"onUpdate:modelValue":[n[1]||(n[1]=e=>b(P).price=e),n[2]||(n[2]=e=>function(e){if(!U.value){if(!Number(e))return;P.price=Number(pe(String(e)||"0",!0))}}(e||"0"))],placeholder:e.$t("price"),precision:b(M)<0?0:b(M),step:b(M)<0?10**-b(M):1,"step-strictly":b(M)<0,size:"large",clearable:"",class:"[&&]:w-full",controls:!1,align:"left"},{suffix:h((()=>[c("div",Sr,[n[19]||(n[19]=c("span",{class:"text-14px color-[--main-text]"},"USD",-1)),n[20]||(n[20]=c("div",{class:"h-8px w-1px b-l-[--third-text] b-l-1px b-l-solid mx-5px"},null,-1)),c("button",{type:"button",class:"text-14px color-[--up-color] border-none bg-transparent clickable p-0",onClick:v(me,["stop"])},p(e.$t("midPrice")),1)])])),_:1},8,["modelValue","placeholder","precision","step","step-strictly"])])),_:1})):d("",!0),k(z,{label:"",prop:"amount"},{default:h((()=>[b($)>0?(s(),i("div",Lr,p(b($))+"%",1)):d("",!0),k(O,{modelValue:b(P).amount,"onUpdate:modelValue":n[4]||(n[4]=e=>b(P).amount=e),placeholder:b(ne)?e.$t("value1"):e.$t("amount"),precision:b(ne)?2:b(R)<0?0:b(R),step:b(ne)?1:b(R)<0?10**-b(R):1,"step-strictly":b(R)<0,class:"[&&]:w-full",controls:!1,size:"large",clearable:"",align:"left",max:b(ee),onInput:n[5]||(n[5]=e=>$.value=0),onFocus:n[6]||(n[6]=e=>$.value=0),onChange:n[7]||(n[7]=e=>function(e){var l,n;const a=Number(("LIMIT"===r.value?P.price:(null==(l=t.perp)?void 0:l.oraclePrice)||(null==(n=t.perp)?void 0:n.lastPrice))||0);if(ne.value){let l=o(e).div(a).toFixed();l=pe(l,!1),P.amount=o(l).times(a).dp(2,o.ROUND_FLOOR).toNumber()}}(String(e||"0")))},{suffix:h((()=>[k(ae,{placement:"bottom",trigger:"click",onVisibleChange:n[3]||(n[3]=e=>S.value=e)},{dropdown:h((()=>[k(re,null,{default:h((()=>[(s(!0),i(y,null,w(b(t).unitList||[],(e=>(s(),g(Q,{key:null==e?void 0:e.coinId,onClick:v((l=>function(e){var l,n,a,i;if(t.unit=e,P.amount){const e=Number(("LIMIT"===r.value?P.price:(null==(l=t.perp)?void 0:l.oraclePrice)||(null==(n=t.perp)?void 0:n.lastPrice))||0),s=(null==(a=t.unit)?void 0:a.coinId)===(null==(i=t.perp)?void 0:i.quoteCoinId);if(s){let l=P.amount||"0";l=pe(String(l),!1),P.amount=o(l).times(e).dp(2,o.ROUND_FLOOR).toNumber()}else{const l=o(P.amount).div(e).toFixed();P.amount=Number(pe(l,s))}}}(e)),["stop"])},{default:h((()=>[c("span",Tr,p((null==e?void 0:e.coinName)||""),1)])),_:2},1032,["onClick"])))),128))])),_:1})])),default:h((()=>{var e;return[c("div",$r,[c("span",null,p((null==(e=b(t).unit)?void 0:e.coinName)||""),1),k(H,{class:x(["arrow-up",{active:!0===b(S)}]),name:"solar:alt-arrow-down-bold"},null,8,["class"])])]})),_:1})])),default:h((()=>[n[21]||(n[21]=m(" > "))])),_:1},8,["modelValue","placeholder","precision","step","step-strictly","max"])])),_:1}),c("div",Er,[u(k(oe,{modelValue:b($),"onUpdate:modelValue":n[8]||(n[8]=e=>T($)?$.value=e:null),min:0,max:100,step:1,marks:{0:"0%",25:"25%",50:"50%",75:"75%",100:"100%"},"format-tooltip":e=>`${e}%`,class:"mb-30px [&&]:[--el-slider-button-size:16px] [--el-color-white:--icon-color] [&&]:[--el-slider-height:2px] [&&]:[--el-slider-button-wrapper-offset:-17px] [&&]:h-auto [&&]:[w-auto] [--el-border-color-light:var(--dialog-divider)] [&&]:[--el-slider-main-bg-color:--main-text] [&&]:[--el-slider-runway-bg-color:--icon-color] slider-box",onInput:n[9]||(n[9]=e=>(P.amount=void 0,void(N.value&&N.value.clearValidate("amount"))))},null,8,["modelValue","format-tooltip"]),[[Pe]])]),b($)>0?(s(),i("div",Fr,[c("div",Ar,[c("div",Dr,p(e.$t("buy"))+": ",1),c("div",Or," ≈ "+p(("formatNumber"in e?e.formatNumber:b(I))(b(xe),{decimals:4,limit:8}))+" "+p((null==(a=b(t).unit)?void 0:a.coinName)||""),1)]),c("div",Mr,[c("div",Rr,p(e.$t("sell"))+": ",1),c("div",Vr," ≈ "+p(("formatNumber"in e?e.formatNumber:b(I))(b(be),{decimals:4,limit:8}))+" "+p((null==(f=b(t).unit)?void 0:f.coinName)||""),1)])])):d("",!0),b(P).reduceOnly?d("",!0):(s(),g(z,{key:2,style:{"margin-bottom":"0"}},{default:h((()=>[k(ie,{modelValue:b(F),"onUpdate:modelValue":n[10]||(n[10]=e=>T(F)?F.value=e:null),class:"checkbox-sm",label:e.$t("stopLimit")},null,8,["modelValue","label"]),b(F)?(s(),i(y,{key:0},[c("div",zr,[k(O,{modelValue:b(W).triggerPrice,"onUpdate:modelValue":[n[11]||(n[11]=e=>b(W).triggerPrice=e),n[12]||(n[12]=e=>function(e){if(!e)return D.tpPercent=0,void(D.tpPercent1=0);const l=("LIMIT"===r.value?P.price:B.value)||0;D.tpPercent=new o(e||0).minus(l).div(l).times(V.value).times(100).dp(0,o.ROUND_FLOOR).toNumber(),D.tpPercent1=Math.min(Math.max(D.tpPercent,0),200)}(e))],controls:!1,align:"left",precision:b(M),class:"flex-1 input-number",placeholder:b(l)("TP1"),size:"large",clearable:""},null,8,["modelValue","precision","placeholder"])]),b(fe)?(s(),g(ye,{key:0,style:{"--el-alert-title-font-size":"12px","--el-alert-padding":"5px 10px",margin:"0"},title:b(fe),type:"success",closable:!1},null,8,["title"])):d("",!0),c("div",Br,[k(O,{modelValue:b(K).triggerPrice,"onUpdate:modelValue":[n[13]||(n[13]=e=>b(K).triggerPrice=e),n[14]||(n[14]=e=>function(e){if(!e)return D.slPercent=0,void(D.slPercent1=0);const l=("LIMIT"===r.value?P.price:B.value)||0;D.slPercent=new o(e||0).minus(l).div(l).times(V.value).times(100).dp(0,o.ROUND_FLOOR).toNumber(),D.slPercent1=Math.min(Math.max(-D.slPercent,0),200)}(e))],controls:!1,precision:b(M),class:"flex-1 input-number",align:"left",size:"large",placeholder:b(l)("SL1")},null,8,["modelValue","precision","placeholder"])]),b(ge)?(s(),g(ye,{key:1,style:{"--el-alert-title-font-size":"12px","--el-alert-padding":"5px 10px",margin:"0"},title:b(ge),type:"error",closable:!1},null,8,["title"])):d("",!0)],64)):d("",!0)])),_:1})),k(z,null,{default:h((()=>[k(ie,{modelValue:b(P).reduceOnly,"onUpdate:modelValue":n[15]||(n[15]=e=>b(P).reduceOnly=e),class:"checkbox-sm",label:e.$t("onlyReduce")},null,8,["modelValue","label"])])),_:1}),k(z,null,{default:h((()=>[c("div",Ur,[k(we,{class:"flex-1 color-[--white]! min-h-48px rd-6px!",color:"var(--up-color)","native-type":"button",size:"large",disabled:b(o)(ve()).lte(0),onClick:n[16]||(n[16]=v((e=>he("BUY")),["stop"]))},{default:h((()=>[m(p(e.$t("buy"))+"/"+p(e.$t("long")),1)])),_:1},8,["disabled"]),k(we,{class:"flex-1 color-[--white]! min-h-48px rd-6px!",color:"var(--down-color)","native-type":"button",size:"large",disabled:b(o)(ve(1)).lte(0),onClick:n[17]||(n[17]=v((e=>he("SELL")),["stop"]))},{default:h((()=>[m(p(e.$t("sell"))+"/"+p(e.$t("short")),1)])),_:1},8,["disabled"])])])),_:1})]})),_:1},8,["model","rules"]),k(_e,{style:{"--el-border-color":"var(--main-divider)",margin:"16px 0"}}),c("ul",jr,[c("li",Hr,[c("span",Wr,p(e.$t("margin")),1),c("span",Kr,p(!b(P).reduceOnly&&b(o)(ve()).gt(0)?("formatNumber"in e?e.formatNumber:b(I))(b(Y).buy,4):"-")+" USD",1),n[22]||(n[22]=c("span",{class:"color-[--icon-color] mx-2px"},"/",-1)),c("span",Yr,p(!b(P).reduceOnly&&b(o)(ve(1)).gt(0)?("formatNumber"in e?e.formatNumber:b(I))(b(Y).sell,4):"-")+" USD",1)]),c("li",qr,[n[23]||(n[23]=c("span",{class:"mr-auto"},"Max: ",-1)),c("span",Xr,p(("formatNumber"in e?e.formatNumber:b(I))(b(J),{decimals:4,limit:8}))+" "+p((null==(a=b(t).unit)?void 0:a.coinName)||""),1),n[24]||(n[24]=c("span",{class:"color-[--icon-color] mx-2px"},"/",-1)),c("span",Zr,p(("formatNumber"in e?e.formatNumber:b(I))(b(G),{decimals:4,limit:8}))+" "+p((null==(_=b(t).unit)?void 0:_.coinName)||""),1)]),b(P).reduceOnly?d("",!0):(s(),i("li",Jr,[c("span",Qr,p(e.$t("estimatedLiquidationPrice1")),1),c("span",Gr,p(b(o)(ve()).gt(0)&&b(o)(b(le)).gt(0)?("formatNumber"in e?e.formatNumber:b(I))(b(le),b(M)):"-")+" USD",1),n[25]||(n[25]=c("span",{class:"color-[--icon-color] mx-2px"},"/",-1)),c("span",en,p(b(o)(ve(1)).gt(0)&&b(o)(b(te)).gt(0)?("formatNumber"in e?e.formatNumber:b(I))(b(te),{decimals:b(M),limit:8}):"-")+" USD",1)])),c("li",ln,[c("span",tn,p(e.$t("feeRate1")),1),c("span",rn,p(e.$t("taker"))+" "+p(("formatNumber"in e?e.formatNumber:b(I))(b(Z).takerFeeRate))+"%",1),n[26]||(n[26]=c("span",{class:"color-[--icon-color] mx-2px"},"/",-1)),c("span",nn,p(e.$t("maker"))+" "+p(("formatNumber"in e?e.formatNumber:b(I))(b(Z).makerFeeRate))+"%",1)])])],64)}}}),[["__scopeId","data-v-794600de"]]),on=l({__name:"index",setup(l){const t=z(),{isCanNormalWithdrawableAmount:r}=Ge(),n=a((()=>r.value?"calc(100vh - 136px)":"calc(100vh - 96px)"));return(l,r)=>{const a=de,o=e;return s(),g(o,{class:"bg-[--secondary-bg]",height:b(n)},{default:h((()=>[c("div",{class:"relative p-12px",style:R(`min-height: ${b(n)};`)},[k(rr),b(t).isConnectLogin?(s(),i(y,{key:0},[k(a,{style:{"--el-border-color":"var(--main-divider)",margin:"16px 0"}}),k(Nr),k(an)],64)):d("",!0)],4)])),_:1},8,["height"])}}}),sn="tw_study",cn="tradingview.IntervalWidget.quicks";function un(e){return{1:"MINUTE_1",5:"MINUTE_5",15:"MINUTE_15",30:"MINUTE_30",60:"HOUR_1",120:"HOUR_2",240:"HOUR_4","1D":"DAY_1","1W":"WEEK_1"}[e]||e}function dn(e){var l;return(null==(l={en:"en","zh-cn":"zh","zh-tw":"zh_TW",pt:"pt",es:"es",ru:"ru",tr:"tr",vi:"vi"})?void 0:l[e])||"en"}function pn(e,l,t){let r="",n=!1;const{t:a}=Q();const i=pe("priceLimit").on((i=>{l()&&async function(l){var i,s,c,u,d,p,v,m,x;const b=e(),f=null==(i=null==b?void 0:b.activeChart)?void 0:i.call(b);if(!b||!f)return;if(t.value&&(l=null==(s=new o(l).times(xe().circulation||"0"))?void 0:s.toNumber()),r){const e=null==(c=null==f?void 0:f.getShapeById)?void 0:c.call(f,r);if(e)return l?void(null==(d=null==e?void 0:e.setPoints)||d.call(e,[{price:l,time:0}])):(null==(u=null==f?void 0:f.removeEntity)||u.call(f,r),void(r=""))}if(n)return;n=!0,r=await(null==(p=null==f?void 0:f.createShape)?void 0:p.call(f,{price:l,time:0},{shape:"horizontal_line",lock:!1,disableSelection:!1,disableSave:!0,disableUndo:!0,text:a("limitPrice"),overrides:{linecolor:"#FFBE3C",linewidth:1,linestyle:2}})),n=!1;const g=null==(v=null==f?void 0:f.getShapeById)?void 0:v.call(f,r);g&&(null==(m=null==g?void 0:g.setProperties)||m.call(g,{textcolor:"#FFBE3C",showLabel:!0,horzLabelsAlign:"right",vertLabelsAlign:"bottom",bold:!0,fontSize:12}),null==(x=null==g?void 0:g.setSelectionEnabled)||x.call(g,!1))}(i)}));return ve((()=>{i&&i()})),{resetLimitPriceLineId:()=>{r=""},subscribePriceMove:function(){var l;const n=e(),a=null==(l=null==n?void 0:n.activeChart)?void 0:l.call(n);n&&(null==n||n.subscribe("drawing_event",((e,l)=>{e===r&&"points_changed"===l&&O((()=>{var l,r,n,i;const s=null==(l=null==a?void 0:a.getShapeById)?void 0:l.call(a,e);if(!s)return;const c=null==(r=s.getPoints)?void 0:r.call(s);if(!(null==c?void 0:c.length))return;const u=(null==(n=null==c?void 0:c[0])?void 0:n.price)||0;if(!u)return;const d=t.value?null==(i=new o(u).div(xe().circulation||"1"))?void 0:i.toNumber():u;pe("priceLimit_move").emit(ie(Number(d),4))}))})))}}}function vn(e,l,t){const r=me(),n=xe(),i=be(),s=fe(),c=a((()=>r.params.id)),u=a((()=>{var e,l;return(null==(e=ge(c.value))?void 0:e.chain)||(null==(l=null==n?void 0:n.token)?void 0:l.chain)||""})),d=a((()=>{var e,l;return(null==(e=ge(c.value))?void 0:e.address)||(null==(l=null==n?void 0:n.token)?void 0:l.token)}));const p=L([]),v=new Map;function m(e=!0){var t,r,n;u.value&&d.value&&i.accessToken&&he({chain:u.value,token:d.value||"",walletAddress:(null==(n=null==(r=null==(t=i.userInfo)?void 0:t.addresses)?void 0:r.find((e=>e.chain===u.value)))?void 0:n.address)||""}).then((async t=>{var r;const n=(null==(r=null==t?void 0:t.filter)?void 0:r.call(t,(e=>13!==e.swapType&&14!==e.swapType)))||[];n.length===p.value.length&&e&&(await ye(2e3),m(!1)),p.value=n,async function(e){const t=_();let r=0;for(;r<=w&&t===y;){if(l()){h(e),P(),r=0;break}await ye(k),r++}}(n)}))}let x=[],b=[],f=!1;const{t:g}=Q();async function h(l){var r;const n=e(),a=null==(r=null==n?void 0:n.activeChart)?void 0:r.call(n);if(!n||!a)return;let i=null==l?void 0:l.map((e=>({...e,price:Number((null==e?void 0:e.PriceLimit)||0)})));t.value&&(i=l.map((e=>{var l;return{...e,price:null==(l=new o(e.PriceLimit).times(xe().circulation||"0"))?void 0:l.toNumber()}}))),x.length>0&&(x.forEach((e=>{var l,t;(null==(l=null==a?void 0:a.getShapeById)?void 0:l.call(a,e))&&(null==(t=null==a?void 0:a.removeEntity)||t.call(a,e))})),x=[]),b.length>0&&(b.forEach((e=>{var l,t;(null==(l=null==a?void 0:a.getShapeById)?void 0:l.call(a,e))&&(null==(t=null==a?void 0:a.removeEntity)||t.call(a,e))})),b=[],v.clear()),f||(f=!0,i.forEach((async e=>{var l,t,r,n;const o=await(null==(l=null==a?void 0:a.createShape)?void 0:l.call(a,{price:e.price,time:0},{shape:"horizontal_line",lock:!0,disableSelection:!0,disableSave:!0,disableUndo:!0,text:(i=e.swapType,g(1===i||5===i||7===i?"limitBuy1":"limitSell1")||g("limitSell1")),overrides:{linecolor:"#FF6838",linewidth:1,linestyle:2,textcolor:"#FF6838",showLabel:!0,horzLabelsAlign:"right",vertLabelsAlign:"bottom",bold:!0,fontSize:12}}));var i;x.push(o);if(!(null==(t=null==a?void 0:a.getShapeById)?void 0:t.call(a,o)))return;const s=await(null==(r=null==a?void 0:a.createShape)?void 0:r.call(a,{price:e.price,time:Math.floor(Date.now()/1e3)},{shape:"text",lock:!0,disableSelection:!0,disableSave:!0,disableUndo:!0,text:g("cancel"),overrides:{borderColor:"#F6465D",color:"#F6465D",fontsize:12,horzLabelsAlign:"right",vertLabelsAlign:"bottom",bold:!1,textcolor:"#F6465D",borderWidth:1,drawBorder:!0,showLabel:!1}}));b.push(s);(null==(n=null==a?void 0:a.getShapeById)?void 0:n.call(a,s))&&v.set(s,e)})),f=!1)}let y=0;const w=5,k=2e3,_=()=>(y+=1,y);function P(){const l=e();l&&(l.unsubscribe("drawing_event",I),l.subscribe("drawing_event",I))}function I(e,l){if("click"===l&&v.has(e)){const l=v.get(e);l&&(t=l,we.confirm(g("botCancelOrder"),"",{confirmButtonText:g("confirm"),cancelButtonText:g("cancel")}).then((async()=>{await ke({chain:t.chain,batchId:t.batchId}),m(),pe("updateLimitOrder").emit(t.chain)})).catch((()=>{})))}var t}function N(e=500){C&&(clearTimeout(C),C=null),C=setTimeout((()=>{m()}),e)}pe("updateKlineLimitLine").on((()=>{m()}));let C=null;return A([u,d,()=>{var e;return null==(e=null==i?void 0:i.userInfo)?void 0:e.evmAddress},()=>n.placeOrderUpdate,()=>{var e;return null==(e=s.wsResult)?void 0:e.tgbot}],(()=>{N(500)})),A((()=>n.placeOrderSuccess),(()=>{N(2e3)})),D((()=>{m()})),{limitTxs:p,getData:m}}const mn={id:"tv_chart_container",ref:"kline",style:{width:"100%",height:"100%"}},xn=S(l({__name:"index",props:{isRank:{type:Boolean}},setup(e){const{contractId:l,contractName:r,resolution:u,perp:p}=V(z()),m=B(),x=e,f=_e(Pe.KLINE_DATE_FILTER),g=x.isRank?kl():xe(),h=be(),k=Ie(),_=me(),P=a((()=>{var e;return x.isRank&&"klineRow"in g?null==(e=g.klineRow)?void 0:e.id:_.params.id})),N=L(!1);let C=!1;L({});const S=n(!1),$=a((()=>{var e,l;return(null==(e=ge(P.value))?void 0:e.chain)||(null==(l=null==g?void 0:g.token)?void 0:l.chain)||""}));a((()=>{var e,l,t,r,n;return(null==(r=null==(t=null==(l=null==(e=h.userInfo)?void 0:e.addresses)?void 0:l.find)?void 0:t.call(l,(e=>e.chain===$.value)))?void 0:r.address)||(null==(n=null==h?void 0:h.userInfo)?void 0:n.evmAddress)}));const T=a((()=>r.value||"-"));let E=!1;A((()=>l.value),((e,l)=>{var t,r,n;e&&(S.value=!1,(null==K?void 0:K.activeChart())&&(null==(r=null==(t=null==K?void 0:K.activeChart())?void 0:t.removeAllShapes)||r.call(t),null==(n=null==K?void 0:K.resetCache)||n.call(K),function(){var e,l,t,r,n;C=!1,ae(),se(),N.value&&"perp-id"===_.name&&(K?(null==(e=null==K?void 0:K.resetCache)||e.call(K),null==(r=null==(t=null==(l=null==K?void 0:K.activeChart)?void 0:l.call(K))?void 0:t.clearMarks)||r.call(t),null==(n=null==K?void 0:K.setSymbol)||n.call(K,T.value,u.value,(()=>{C=!0}))):Z())}()))}));const O=Ne();let M=null,j=0;const H=new Map,W=t();let K=null;const Y=Ce("tv_showMarket",!1);A((()=>W.theme),(e=>{K&&(null==K||K.changeTheme(e).then((()=>{var e;ce(),null==(e=null==K?void 0:K.applyOverrides)||e.call(K,{"scalesProperties.textColor":W.isDark?"#d5d5d5":"#333","paneProperties.backgroundType":"solid","paneProperties.background":Ee("--secondary-bg")})})))})),A((()=>O.locale),(()=>{var e;C=!1,M=null,j=0,ae(),se(),null==(e=null==K?void 0:K.remove)||e.call(K),Z()}));let q=!1,X=0;async function Z(){var e,r,n;const a=(null==(r=null==(e=T.value)?void 0:e.toUpperCase)?void 0:r.call(e))||"-";u.value=function(e){var l;const t=["1","5","15","60","240","1D","1W"];let r;const n=localStorage.getItem(cn);if(n?(r=JSON.parse(n),r.includes("1S"),["1S","5S","15S","30S"].some((e=>null==r?void 0:r.includes(e)))&&(r=(null==(l=null==r?void 0:r.filter)?void 0:l.call(r,(e=>!(null==e?void 0:e.endsWith("S")))))||[],localStorage.setItem(cn,JSON.stringify(r)))):(r=t,localStorage.setItem(cn,JSON.stringify(r)),localStorage.setItem("tradingViewIntervalSet","true")),!r.includes(e)){const e="15";return localStorage.setItem("tv_resolution",e),e}return e}(u.value);const o=(null==(n=Se().globalConfig)?void 0:n.token_logo_url)||"https://www.iconaves.com/",i=await new Promise((e=>{var l;if(null==(l=null==window?void 0:window.TradingView)?void 0:l.widget)return e(window.TradingView.widget);window.addEventListener("tradingview:ready",(()=>{e(window.TradingView.widget)}))}));K=new i({symbol:a.replace("<","＜")||" ",debug:!1,width:"100%",height:"100%",interval:u.value,theme:W.theme,container:"tv_chart_container",library_path:`${o}charting_library-29.4.0/charting_library/`,locale:dn(O.locale),disabled_features:["header_symbol_search","header_screenshot","header_compare","volume_force_overlay","header_undo_redo","header_settings","header_saveload","timeframes_toolbar"],enabled_features:["request_only_visible_range_on_reset"],charts_storage_url:location.host,charts_storage_api_version:"1.1",timezone:Le(),time_frames:[],loading_screen:{backgroundColor:W.isDark?"#0B0D12":"#F6F9FF",foregroundColor:"#3F80F7"},custom_css_url:`${location.origin}/tv_custom_1.css`,custom_formatters:{priceFormatterFactory:()=>({format:e=>Y.value?I(e,{decimals:2,locale:"en"}):String(I(e,{decimals:4,limit:6,locale:"en"}))})},overrides:{volumePaneSize:"small","paneProperties.topMargin":"10","scalesProperties.textColor":W.isDark?"#d5d5d5":"#333","paneProperties.backgroundType":"solid","paneProperties.background":W.isDark?"#0B0D12":"#F6F9FF","paneProperties.vertGridProperties.style":2,"paneProperties.legendProperties.showLegend":!1,"paneProperties.legendProperties.showStudyArguments":!0,"paneProperties.legendProperties.showStudyTitles":!0,"paneProperties.legendProperties.showStudyValues":!0,"paneProperties.legendProperties.showSeriesTitle":!0,"paneProperties.legendProperties.showSeriesOHLC":!0,"mainSeriesProperties.candleStyle.drawWick":!0,"mainSeriesProperties.candleStyle.drawBorder":!0,"mainSeriesProperties.candleStyle.barColorsOnPrevClose":!1,"mainSeriesProperties.hollowCandleStyle.drawWick":!0,"mainSeriesProperties.hollowCandleStyle.drawBorder":!0,"mainSeriesProperties.haStyle.drawWick":!0,"mainSeriesProperties.haStyle.drawBorder":!0,"mainSeriesProperties.haStyle.barColorsOnPrevClose":!1,"mainSeriesProperties.barStyle.barColorsOnPrevClose":!1,"mainSeriesProperties.barStyle.dontDrawOpen":!1,"mainSeriesProperties.lineStyle.linewidth":2,"mainSeriesProperties.lineStyle.priceSource":"close","mainSeriesProperties.areaStyle.linewidth":2,"mainSeriesProperties.areaStyle.priceSource":"close"},datafeed:{onReady:e=>{const l={supported_resolutions:["1","5","15","30","60","120","240","1D","1W"],supports_marks:!0,supports_timescale_marks:!0,supports_time:!0};ce(),setTimeout((()=>e(l)),50)},resolveSymbol:(e,l,t)=>{var r,n,a;try{const e=(null==(n=null==(r=T.value)?void 0:r.toUpperCase)?void 0:n.call(r))||"-",t=Number(null==g?void 0:g.price)||0,a={name:e,ticker:e,description:e||"",exchange:"Ave.ai",timezone:Le(),format:"price",minmov:1,minmove2:0,pricescale:t>0?10**Te(t).precision:1e10,volume_precision:2,fractional:!1,session:"24x7",has_intraday:!0,intraday_multipliers:["1","5","15","30","60","120","240"],has_daily:!0,has_weekly_and_monthly:!0,supported_resolutions:["1","5","15","30","60","120","240","1D","1W"],data_status:"streaming",visible_plots_set:"ohlcv",type:"crypto",listed_exchange:T.value||""};setTimeout((()=>l(a)),0)}catch(o){t((null==(a=null==o?void 0:o.toString)?void 0:a.call(o))||"resolveSymbol err")}},getBars:(e,t,r,n,a)=>{var o;const{from:i,to:s,firstDataRequest:c}=r;try{if(c)q=!1,M=null,j=0;else if(q)return void n([],{noData:!0});const e={priceType:"LAST_PRICE",klineType:un(t),contractId:l.value,filterBeginKlineTimeInclusive:1e3*i,filterEndKlineTimeExclusive:c?Date.now():Math.max(1e3*s,X||0)};E=!0,$e(e).then((e=>{var l,t,r;const a=(null==(l=null==e?void 0:e.dataList)?void 0:l.reverse())||[],o=(null==a?void 0:a.map((e=>({...e,time:Number(e.klineTime),open:e.open,high:e.high,low:e.low,close:e.close,volume:Number(e.value||0)}))))||[],i=(null==(t=null==o?void 0:o.map)?void 0:t.call(o,(e=>({time:Number(e.klineTime),open:e.open,high:e.high,low:e.low,close:e.close,volume:Number(e.value||0),type:e.close>e.open?"buy":"sell"}))))||[];c&&(M=(null==o?void 0:o[(null==o?void 0:o.length)-1])||null,j=Number((null==M?void 0:M.close)||0),M&&(M.time=M.time),q=(null==i?void 0:i.length)<1),(null==o?void 0:o.length)>0&&(X=(null==(r=null==o?void 0:o[0])?void 0:r.time)||0),n(i,{noData:!(null==i?void 0:i.length)}),setTimeout((()=>{pe("klineDataReady").emit()}),10)})).catch((e=>{var l,t;if(S.value=!0,c){const e=null==(l=p.value)?void 0:l.lastPrice,r=null==(t=p.value)?void 0:t.value,a={time:1e3*i,open:e,high:e,low:e,close:e,volume:r};setTimeout((()=>n([a],{noData:!1})),100)}else n([],{noData:!0,nextTime:void 0})})).finally((()=>{E=!1}))}catch(u){a((null==(o=null==u?void 0:u.toString)?void 0:o.call(u))||"getBars err")}},subscribeBars:(e,t,r,n)=>{const a=un(t);if(H.has(`${l.value}.${a}`))return void G(t,r);G(t,r,m.send({type:"subscribe",channel:`${U.KLINE}.${l.value}.${a}`})),H.set(`${l.value}.${a}`,{type:"subscribe",channel:`${U.KLINE}.${l.value}.${a}`})},unsubscribeBars:e=>{if(e){const t=un((null==e?void 0:e.split("_"))[-1]);H.forEach(((e,r)=>{r!==`${l.value}.${t}`&&m.send({...e,type:"unsubscribe"})})),null==H||H.clear()}},searchSymbols:(e,l,t,r)=>{}}}),function(){var e,l;const r="tradingview.chartproperties",n=localStorage.getItem(r);if(n)try{const a=JSON.parse(n),o="light"===t().theme?"#fff":"#0A0B0D";((null==(e=a.paneProperties)?void 0:e.background)!==o||"solid"!==(null==(l=a.paneProperties)?void 0:l.backgroundType))&&(a.paneProperties={...a.paneProperties,background:o,backgroundType:"solid"},localStorage.setItem(r,JSON.stringify(a)))}catch(a){}}(),K.onChartReady((()=>{var e,l,t,r,n;N.value=!0,C=!0,W.isDark?null==(e=null==K?void 0:K.applyOverrides)||e.call(K,{"scalesProperties.textColor":"#d5d5d5"}):null==(l=null==K?void 0:K.applyOverrides)||l.call(K,{"scalesProperties.textColor":"#333"}),null==(r=null==(t=null==K?void 0:K.activeChart)?void 0:t.call(K))||r.onIntervalChanged().subscribe(null,(e=>{var l;u.value!==e&&(u.value=e,localStorage.setItem("tv_resolution",e),null==(l=null==K?void 0:K.resetCache)||l.call(K))})),function(e){var l;const t=null==(l=null==e?void 0:e.watermark)?void 0:l.call(e);null==t||t.color().setValue("#BCBED219"),null==t||t.setContentProvider((()=>[{text:"AVE.AI",fontSize:60,lineHeight:1,vertOffset:1}])),null==t||t.visibility().setValue(!0)}(K),ie(),function(){if(null==K?void 0:K.activeChart){let e=JSON.parse((null==localStorage?void 0:localStorage[sn])||"[]");e=e.filter(((l,t)=>e.findIndex((e=>e.name===l.name))===t)),e.forEach((e=>{var l;null==(l=null==K?void 0:K.activeChart)||l.call(K).createStudy(e.name,!1,!1)}))}}(),null==(n=null==K?void 0:K.applyOverrides)||n.call(K,{"scalesProperties.textColor":W.isDark?"#d5d5d5":"#333","paneProperties.backgroundType":"solid","paneProperties.background":Ee("--secondary-bg")})}));let s=0;K.subscribe("mouse_down",(()=>{s=performance.now()})),K.subscribe("mouse_up",(e=>{if(performance.now()-s>=200)return;const l=null==K?void 0:K.activeChart().getTimeScale().coordinateToTime(e.clientX-56);if(l&&u.value){const e=Fe[u.value]||{val:u.value,unit:"m"},t=Ae(1e3*l).add(e.val,e.unit).unix();k.isClickKlineFilter&&(null==f?void 0:f.value)&&(f.value=[String(l),String(t)])}})),null==K||K.subscribe("study_event",((e,l)=>{"create"!==l&&"remove"!==l||J||function(){var e;if(null==K?void 0:K.activeChart){let l=(null==(e=null==K?void 0:K.activeChart)?void 0:e.call(K).getAllStudies())||[];l=l.filter(((e,t)=>l.findIndex((l=>l.name===e.name))===t)),localStorage.setItem(sn,JSON.stringify(l.filter((e=>"Volume"!==e.name))))}}()})),window.onbeforeunload=()=>{J=!0}}let J=!1;function G(e,t,r=m.getWSInstance()){null==r||r.onmessage((r=>{const n=De(r);if(!n)return;const{channel:a,content:{data:o,dataType:i}={},type:s}=n||{},c=un(e);if(a==`${U.KLINE}.${l.value}.${c}`){if((null==o?void 0:o.length)>0&&!E&&"Snapshot"===i&&S.value){U.KLINE,l.value;o.reverse().map((e=>({time:Number(e.klineTime),open:e.open,high:e.high,low:e.low,close:e.close,volume:Number(e.value||0)}))).forEach((e=>t(e)))}if((null==o?void 0:o.length)>0&&!E&&"changed"===i){const e=null==o?void 0:o.map((e=>({...e,time:Number(e.klineTime),open:e.open,high:e.high,low:e.low,close:e.close,volume:Number(e.value||0),type:e.close>e.open?"buy":"sell"})))[0];t(e)}}}),"kline")}let ee=!1;const le=Oe("kHeightPerp",Math.max(Me.KLINE,500)),te=F().height,re=oe("kline");function ne(e){let l=e.clientY;if(ee=!0,!re)return;const{height:t}=Ve(re);return le.value=t.value,document.onmousemove=e=>{if(!ee)return;if(e.clientY>te.value)return void(ee=!1);document.getElementById("tv_chart_container").style.pointerEvents="none";const t=e.clientY<l?le.value-(l-e.clientY):le.value+e.clientY-l;t<=te.value-164&&(le.value=t),l=e.clientY},document.onmouseup=()=>{document.getElementById("tv_chart_container").style.pointerEvents="auto",ee=!1,document.onmousemove=null,document.onmouseup=null,g.centerTopHeight=le.value},!1}const{resetLimitPriceLineId:ae,subscribePriceMove:ie}=pn((()=>K),(()=>C),Y),{resetAvgPriceLineId:se}=function(e,l,t){let r="",n=!1;const{t:a}=Q();async function i(l){var i,s,c,u,d,p,v,m,x;const b=e(),f=null==(i=null==b?void 0:b.activeChart)?void 0:i.call(b);if(b&&f){if(t.value&&(l=null==(s=new o(l).times(xe().circulation||"0"))?void 0:s.toNumber()),r){const e=null==(c=null==f?void 0:f.getShapeById)?void 0:c.call(f,r);if(e)return l?void(null==(d=null==e?void 0:e.setPoints)||d.call(e,[{price:l,time:0}])):(null==(u=null==f?void 0:f.removeEntity)||u.call(f,r),void(r=""))}else if(!l)return;n||(n=!0,r=await(null==(p=null==f?void 0:f.createShape)?void 0:p.call(f,{price:l,time:0},{shape:"horizontal_line",lock:!0,disableSelection:!0,disableSave:!0,disableUndo:!0,text:a("averagePositionPrice"),overrides:{linecolor:"#3F80F7",linewidth:1,linestyle:0}})),n=!1,null==(x=null==(m=null==(v=null==f?void 0:f.getShapeById)?void 0:v.call(f,r))?void 0:m.setProperties)||x.call(m,{textcolor:"#3F80F7",showLabel:!0,horzLabelsAlign:"right",vertLabelsAlign:"bottom",bold:!0,fontSize:12}))}}function s(e){return new Promise((l=>setTimeout(l,e)))}pe("updateAvgPrice").on((async function(e){const t=++c;let r=0;for(;r<=u;){if(t!==c)return;if(l())return void i(e);await s(d),r++}}));let c=0;const u=5,d=2e3;return{resetAvgPriceLineId:()=>{r=""}}}((()=>K),(()=>C),Y);function ce(){var e;const l=document.querySelector("#tv_chart_container iframe"),t=null==(e=null==l?void 0:l.contentWindow)?void 0:e.document.documentElement;t&&t.style.setProperty("--secondary-bg",Ee("--secondary-bg"))}return vn((()=>K),(()=>C),Y),Re((()=>{var e;J=!0,null==(e=null==K?void 0:K.remove)||e.call(K)})),D((()=>{Z(),_l((()=>{var e,l,t,r;null==(e=null==K?void 0:K.resetCache)||e.call(K),null==(r=null==(l=null==K?void 0:K.activeChart)?void 0:(t=l.call(K)).resetData)||r.call(t)}))})),(e,l)=>(s(),i(y,null,[c("div",{class:"relative",style:R({height:`${b(le)}px`})},[c("div",mn,null,512)],4),e.isRank?d("",!0):(s(),i("div",{key:0,class:"w-full cursor-row-resize bg-[--border] gap-1px hover:bg-[--third-text] flex items-center justify-center h-4px",onMousedown:v(ne,["stop","prevent"])},[(s(),i(y,null,w(4,(e=>c("span",{key:e,class:"bg-[--icon-color] w-2px h-2px rounded-full"}))),64))],32))],64))}}),[["__scopeId","data-v-8aa6de87"]]),bn={class:"text-left min-w-0"},fn={class:"color-[--d-5A5E64-l-A9B0BC]"},gn={class:"text-right text-nowrap min-w-0"},hn={class:"font-medium truncate"},yn={class:"text-right text-nowrap min-w-0"},wn={class:"font-medium truncate"},kn=S(l({__name:"list",props:{klineHeight:{},height:{},list:{},type:{},unit:{},step:{}},setup(e){const l=t(),r=e,{t:n}=Q(),u=z(),d=a((()=>{var e;let l=[...r.list,...Array.from({length:Math.max(0,200-(null==(e=r.list)?void 0:e.length))},(()=>({price:"0",size:"0",sum:"0"})))];"sell"==r.type?l.sort(((e,l)=>new o(e.price).comparedTo(new o(l.price))||0)):l.sort(((e,l)=>new o(l.price).comparedTo(new o(e.price))||0));let t="0";return l=l.map((e=>(t=o(t).plus(new o(e.size)).toString(),{...e,sum:t}))),"sell"==r.type?null==l?void 0:l.reverse():l}));function v(e){const t={"true-true":"rgba(18, 184, 134, 0.10)","true-false":"rgba(246, 70, 93, 0.10)","false-false":"rgba(18, 184, 134, 0.10)","false-true":"rgba(246, 70, 93, 0.10)"};return t[`${l.isDark}-${"buy"==(null==r?void 0:r.type)}`]||t["true-true"]}function m(e,l){const t=r.list.reduce(((e,l)=>e+Number(l.sum)),0),n=r.list.reduce(((e,t,r)=>r<l?e+Number(t.sum):e),0),a="sell"==r.type?Math.min(Number(t-n)/t,1):Math.min(Number(n)/t,1);return Number(e.price)>0?a.toFixed(3):0}const f=a((()=>dl(null==r?void 0:r.step))),g=a((()=>{var e;return nl((null==(e=u.perp)?void 0:e.contractId)||"")}));function h(e){var l;const t="USD"==(null==(l=r.unit)?void 0:l.coinName);return Number(null==e?void 0:e.price)>0?I(t?o((null==e?void 0:e.size)||0).times((null==e?void 0:e.price)||0).toFixed():(null==e?void 0:e.size)||0,{limit:8,decimals:t?2:g.value||8}):"--"}function k(e){var l;const t="USD"==(null==(l=r.unit)?void 0:l.coinName);return Number(null==e?void 0:e.price)>0?I(t?o((null==e?void 0:e.sum)||0).times((null==e?void 0:e.price)||0).toFixed():(null==e?void 0:e.sum)||0,{limit:8,decimals:t?2:g.value||8}):"--"}return(e,l)=>(s(),i("div",{class:"text-12px overflow-hidden",style:R({height:`${e.height}px`})},[(s(!0),i(y,null,w(b(d),((l,t)=>(s(),i("div",{key:t,class:"grid grid-cols-[minmax(0,1.5fr)_minmax(0,1fr)_minmax(0,1fr)] items-center gap-15px h-24px hover:bg-[rgba(255,255,255,.02)] relative z-10 overflow-hidden cursor-pointer mt-1px first:mt-0 text-12px"},[c("div",{class:"absolute inset-0 pointer-events-none mb-2px",style:R({backgroundColor:v(),transform:`scaleX(${m(l,t)})`,transformOrigin:"right"})},null,4),c("div",bn,[c("div",fn,[c("span",{class:x("sell"==e.type?"color-[--down-color]":"color-[--up-color]")},p(Number(null==l?void 0:l.price)>0?("formatNumber"in e?e.formatNumber:b(I))((null==l?void 0:l.price)||0,{limit:8,decimals:b(f)}):"--"),3)])]),c("div",gn,[c("div",hn,[c("span",null,p(h(l)),1)])]),c("div",yn,[c("div",wn,[c("span",null,p(k(l)),1)])])])))),128))],4))}}),[["__scopeId","data-v-2ef076d0"]]),_n={class:"text-12px"},Pn={class:"grid grid-cols-[minmax(0,1.5fr)_minmax(0,1fr)_minmax(0,1fr)] items-center gap-15px h-24px hover:bg-[rgba(255,255,255,.02)] relative z-10 overflow-hidden cursor-pointer mt-1px first:mt-0 text-12px"},In={class:"text-left min-w-0"},Nn={class:"color-[--d-5A5E64-l-A9B0BC]"},Cn={class:"text-right text-nowrap min-w-0"},Sn={class:"font-medium truncate"},Ln={class:"text-right text-nowrap min-w-0"},$n={class:"font-medium truncate"},Tn=S(l({__name:"history",props:{height:{},list:{}},setup(e){const l=e,{t:t}=Q(),r=a((()=>{var e;return(null==(e=l.list)?void 0:e.length)>0?l.list:Array.from({length:200},(()=>({price:"0",size:"0",sum:"0"})))}));return(e,l)=>(s(),i("div",_n,[(s(),g(b(Pl),{key:e.height,list:b(r),options:{itemHeight:24,overscan:5},style:{"margin-right":"-12px","padding-right":"12px"},class:"scrollbar-hide",height:`${e.height}px`},{default:h((({data:t,index:r})=>[c("div",Pn,[l[0]||(l[0]=c("div",{class:"absolute inset-0 pointer-events-none"},null,-1)),c("div",In,[c("div",Nn,[c("span",{class:x((null==t?void 0:t.isBuyerMaker)?"color-[--up-color]":"color-[--down-color]")},p(Number(null==t?void 0:t.price)>0?("formatNumber"in e?e.formatNumber:b(I))((null==t?void 0:t.price)||0):"--"),3)])]),c("div",Cn,[c("div",Sn,[c("span",null,p(Number(null==t?void 0:t.price)>0?("formatNumber"in e?e.formatNumber:b(I))((null==t?void 0:t.size)||0):"--"),1)])]),c("div",Ln,[c("div",$n,[c("span",null,p(Number(null==t?void 0:t.price)>0?("formatDate"in e?e.formatDate:b(ze))(t.time,"HH:mm:ss"):"--"),1)])])])])),_:1},8,["list","height"]))]))}}),[["__scopeId","data-v-01957d2c"]]),En={class:"mx-12px pb-12px flex"},Fn=["onClick"],An={class:"mx-12px pb-12px flex"},Dn=["onClick"],On={class:"py-4px [&&]:m--12px flex flex-col"},Mn=["onClick"],Rn={class:"ml-4px mr-4px"},Vn={class:"py-4px [&&]:m--12px flex flex-col"},zn=["onClick"],Bn={class:"ml-4px mr-4px"},Un={class:"px-12px"},jn={class:"text-12px"},Hn={class:"grid grid-cols-[minmax(0,1.5fr)_minmax(0,1fr)_minmax(0,1fr)] items-center gap-15px mt-8px mb-4px text-12px color-[--d-5A5E64-l-A9B0BC] mb-8px"},Wn={class:"min-w-0 text-left"},Kn={class:"text-right text-nowrap min-w-0"},Yn={class:"flex items-center justify-end gap-2px"},qn={class:"text-right text-nowrap min-w-0"},Xn={class:"flex items-center justify-end gap-2px"},Zn={class:"mt-16px mb-16px flex items-center"},Jn={class:"flex-end border-b-dashed border-b-1px border-[--third-text]"},Qn={class:"text-12px color-[--third-text] ml-4px"},Gn={class:"range-container z-10 absolute bottom-0 py-16px px-10px w-100% flex items-center justify-center bg-[--main-input-button-bg] color-[#FFA622]"},ea={class:"text-10px color-[--up-color]"},la={class:"range ml-4px mr-4px"},ta={class:"text-10px color-[--down-color]"},ra={key:1,class:"mx-12px pb-12px"},na={class:"grid grid-cols-[minmax(0,1.5fr)_minmax(0,1fr)_minmax(0,1fr)] items-center gap-15px mt-8px mb-4px text-12px color-[--d-5A5E64-l-A9B0BC]"},aa={class:"min-w-0 text-left"},oa={class:"text-right text-nowrap min-w-0"},ia={class:"flex items-center justify-end gap-2px"},sa={class:"text-right text-nowrap min-w-0"},ca={class:"flex items-center justify-end gap-2px"},ua=S(l({__name:"index",props:{klineHeight:{}},setup(e){const{contractId:l,perp:t,resolution:r,metadata:f,unit:_,unitList:P,base:N,quote:C,buyList:S,sellList:$}=V(z()),T=B(),F=e,{t:O}=Q(),M=Be(),W=n(200),K=n([]),Y=n([]),q=n(!1),X=n("0"),Z=n(!1),J=L([]),G=L([]),ee=L([]),le=L([]),te=L(null),re=n("orderbook"),ne=n("all"),ae=a((()=>Qe(l.value||"")));L({isAmount:!0});const oe=a((()=>[{label:O("orderBook"),value:"orderbook"},{label:O("recentTrades"),value:"history"}])),ie=a((()=>[{label:O("orderBook"),value:"all"},{label:O("buy"),value:"buy"},{label:O("sell"),value:"sell"}])),se=a((()=>{const e=F.klineHeight||300;return"history"===re.value?e-100:"all"===ne.value?(e-100-55-60-5)/2:e-200})),ce=a((()=>{var e,l;return(null==(l=null==(e=t.value)?void 0:e.displayDigitMerge)?void 0:l.split(","))||[]})),ue=a((()=>Math.floor(Number(se.value)/24)));a((()=>Math.max(...S.value.map((e=>Number(e.sum)))))),a((()=>Math.max(...$.value.map((e=>Number(e.sum))))));const de=a((()=>{const e=S.value.reduce(((e,l)=>e+Number(l.sum)),0),l=$.value.reduce(((e,l)=>e+Number(l.sum)),0);return e+l>0?Math.min(e/(e+l)*100,100):0})),pe=L(window.innerWidth),me=()=>{pe.value=window.innerWidth};A((()=>N.value),(e=>{e?(_.value=e??null,X.value=ce.value[0]??"0"):_.value=null})),A((()=>r.value),(e=>{e&&"perp-id"==M.name&&(re.value="orderbook",S.value=[],$.value=[],ee.value=[],le.value=[],K.value=[],Y.value=[],"orderbook"===re.value?fe():ge())})),A((()=>l.value),(e=>{e&&(re.value="orderbook",S.value=[],$.value=[],K.value=[],Y.value=[],"orderbook"===re.value?fe():ge())})),A((()=>T.wsResult[U.DEPTH]),(e=>{var t,r,n,a,o;const i=null==(t=e.data)?void 0:t[0],s=Array.isArray(null==i?void 0:i.bids)?null==(r=null==i?void 0:i.bids)?void 0:r.map((e=>({...e,sum:(null==e?void 0:e.size)||"0"}))):[],c=Array.isArray(null==i?void 0:i.asks)?null==(n=null==i?void 0:i.asks)?void 0:n.map((e=>({...e,sum:(null==e?void 0:e.size)||"0"}))):[];((null==(a=null==i?void 0:i.bids)?void 0:a.length)>0||(null==(o=null==i?void 0:i.asks)?void 0:o.length)>0)&&`${U.DEPTH}.${l.value}.${W.value}`==e.channel&&("Snapshot"===e.dataType?(S.value=s,$.value=c,ee.value=s,le.value=s):"changed"===e.dataType&&((null==s?void 0:s.length)>0&&(K.value=[...K.value||[],...s]),(null==c?void 0:c.length)>0&&(Y.value=[...Y.value||[],...c]),be()))})),A((()=>T.wsResult[U.TRADES]),(e=>{const t=Array.isArray(e.data)?e.data:[];(null==t?void 0:t.length)>0&&`${U.TRADES}.${l.value}`==e.channel&&("Snapshot"===e.dataType?J.value=t:"changed"===e.dataType&&(G.value=[...t,...G.value],xe()))}));const xe=Ue((()=>{var e;0!==G.value.length&&(null==(e=G.value)?void 0:e.length)>0&&(J.value=[...G.value,...J.value],J.value.length>200&&(J.value=J.value.slice(0,200)),G.value.length=0,je(J))}),200),be=Ue((()=>{var e,l,t,r,n,a;if(0!==K.value.length||0!==Y.value.length){if((null==(e=K.value)?void 0:e.length)>0){const e=[...S.value,...K.value];S.value=he(e,String(X.value),!0),S.value.length>200&&(S.value=null==(l=S.value)?void 0:l.slice(0,ue.value)),(null==(t=S.value)?void 0:t.length)<5&&(S.value=ee.value),je(S),K.value=[]}if((null==(r=Y.value)?void 0:r.length)>0){const e=[...$.value,...Y.value];$.value=he(e,String(X.value),!1),$.value.length>200&&($.value=null==(n=$.value)?void 0:n.slice(0,ue.value)),(null==(a=$.value)?void 0:a.length)<5&&($.value=le.value),je($),Y.value=[]}}}),200);function fe(){T.send({type:"unsubscribe",channel:`${U.DEPTH}.${l.value}.${W.value}`}),setTimeout((()=>{T.send({type:"subscribe",channel:`${U.DEPTH}.${l.value}.${W.value}`})}),500)}function ge(){T.send({type:"unsubscribe",channel:`${U.TRADES}.${l.value}`}),setTimeout((()=>{T.send({type:"subscribe",channel:`${U.TRADES}.${l.value}`})}),500)}function he(e,l,t){const r=new Map;for(const a of e){const e=pl.digitMergeNumber(a.price,l,t),n=new o(a.size),i=new o(a.sum??a.size);if(n.isZero())r.delete(e);else if(r.has(e)){const l=r.get(e);r.set(e,{price:e,size:n.toFixed(),sum:l.sum.plus(i)})}else r.set(e,{price:e,size:n.toFixed(),sum:i})}const n=[...r.values()].map((e=>({price:e.price,size:e.size,sum:e.sum.toFixed()})));return t?n.sort(((e,l)=>new o(l.price).comparedTo(new o(e.price)))):n.sort(((e,l)=>new o(e.price).comparedTo(new o(l.price))))}function ye(e,t){!function(e){re.value=e,K.value=[],Y.value=[]}(e),"orderbook"===re.value?(T.send({type:"unsubscribe",channel:`${U.TRADES}.${l.value}`}),T.send({type:"subscribe",channel:`${U.DEPTH}.${l.value}.${W.value}`})):(T.send({type:"unsubscribe",channel:`${U.DEPTH}.${l.value}.${W.value}`}),T.send({type:"subscribe",channel:`${U.TRADES}.${l.value}`}))}return D((()=>{_.value=N.value??null,X.value=ce.value[0]??"0",window.addEventListener("resize",me),"orderbook"===re.value?fe():ge()})),ve((()=>{window.removeEventListener("resize",me),l.value&&(T.send({type:"unsubscribe",channel:`${U.DEPTH}.${l.value}.${W.value}`}),T.send({type:"unsubscribe",channel:`${U.TRADES}.${l.value}`}),Z.value&&(Z.value=!1),q.value&&(q.value=!1))})),(e,l)=>{var r,n,a,o,f,L,T,F,A,D,O,M,V,z;const B=E,U=H,W=j("tooltip");return s(),i("div",{class:"bg-[--secondary-bg] relative rounded-2px text-14px pt-12px flex flex-col overflow-hidden",style:R({height:`${e.klineHeight||200}px`})},[c("div",En,[c("div",{ref_key:"tabsContainer",ref:te,class:"flex-1 flex items-center gap-x-8px whitespace-nowrap overflow-x-auto scrollbar-hide"},[(s(!0),i(y,null,w(b(oe),((e,l)=>(s(),i("button",{key:e.value,style:R({backgroundColor:b(re)===e.value?"rgba(63, 128, 247, 0.10)":"var(--d-16181D-l-ECF3FF)"}),class:x(["shrink-0 text-12px px-8px py-4px rounded-4px border-none cursor-pointer",b(re)===e.value?"color-[--primary-color]":"bg-[--d-16181D-l-ECF3FF] color-[--d-5A5E64-l-A9B0BC]"]),onClick:l=>ye(e.value)},p(e.label),15,Fn)))),128))],512)]),"orderbook"===b(re)?(s(),i(y,{key:0},[c("div",An,[c("div",{ref_key:"tabsContainer",ref:te,class:"flex-1 flex items-center gap-x-8px whitespace-nowrap overflow-x-auto scrollbar-hide"},[(s(!0),i(y,null,w(b(ie),(e=>u((s(),i("button",{key:e.value,style:R({backgroundColor:b(ne)===e.value?"var(--d-383F4B-l-CAD6EC)":"transparent"}),class:x(["shrink-0 px-2px py-2px rounded-1px border-none cursor-pointer text-16px leading-none h-16px w-16px flex items-center"]),onClick:l=>ne.value=e.value},["all"==e.value?(s(),g(B,{key:0,mode:"svg",name:"custom:perp-all",style:R(b(ne)===e.value?{"--rect2":"#F6465D","--rect3":"#12B886"}:{"--rect2":"#71486d","--rect3":"#2fa89a"})},null,8,["style"])):d("",!0),"buy"==e.value?(s(),g(B,{key:1,mode:"svg",name:"custom:perp-buy",style:R(b(ne)===e.value?{"--rect2":"#12B886"}:{"--rect2":"#345e74"})},null,8,["style"])):d("",!0),"sell"==e.value?(s(),g(B,{key:2,mode:"svg",name:"custom:perp-sell",style:R(b(ne)===e.value?{"--rect2":"#F6465D"}:{"--rect2":"#71486d"})},null,8,["style"])):d("",!0)],12,Dn)),[[W,e.label]]))),128))],512),l[2]||(l[2]=c("div",{class:"flex-1"},null,-1)),(null==(r=b(P))?void 0:r.length)>=0?(s(),g(U,{key:0,"popper-class":"[--el-popover-bg-color:--border]",placement:"bottom-end",trigger:"click",visible:b(q)},{reference:h((()=>{var e;return[c("div",{class:"flex-start items-center cursor-pointer text-12px bg-[--main-input-button-bg] px-4px py-4px",onClick:l[0]||(l[0]=v((e=>q.value=!b(q)),["stop"]))},[m(p(null==(e=b(_))?void 0:e.coinName)+" ",1),k(B,{name:b(q)?"radix-icons:triangle-up":"radix-icons:triangle-down",class:"text-16px color-[--main-text]"},null,8,["name"])])]})),default:h((()=>[c("div",On,[(s(!0),i(y,null,w(b(P),((e,l)=>(s(),i("div",{key:l,class:"flex-start items-center text-12px py-4px px-8px color-[--main-text] hover:bg-[--dialog-list-hover] cursor-pointer",onClick:v((l=>function(e){_.value=e,q.value=!1}(e)),["stop"])},[c("span",Rn,p(null==e?void 0:e.coinName),1)],8,Mn)))),128))])])),_:1},8,["visible"])):d("",!0),(null==(n=b(ce))?void 0:n.length)>0?(s(),g(U,{key:1,"popper-class":"[--el-popover-bg-color:--border]",placement:"bottom-end",trigger:"click",visible:b(Z)},{reference:h((()=>[c("div",{class:"flex-start items-center cursor-pointer text-12px bg-[--main-input-button-bg] px-4px py-4px ml-4px",onClick:l[1]||(l[1]=v((e=>Z.value=!b(Z)),["stop"]))},[m(p(b(X))+" ",1),k(B,{name:b(Z)?"radix-icons:triangle-up":"radix-icons:triangle-down",class:"text-16px color-[--main-text]"},null,8,["name"])])])),default:h((()=>[c("div",Vn,[(s(!0),i(y,null,w(b(ce),((e,l)=>(s(),i("div",{key:l,class:"flex-start items-center text-12px py-4px px-8px color-[--main-text] hover:bg-[--dialog-list-hover] cursor-pointer",onClick:v((l=>function(e){X.value=e,Z.value=!1}(e)),["stop"])},[c("span",Bn,p(e),1)],8,zn)))),128))])])),_:1},8,["visible"])):d("",!0)]),c("div",Un,[c("div",jn,[c("div",Hn,[c("div",Wn,p(e.$t("price"))+"("+p(null==(a=b(C))?void 0:a.coinName)+")",1),c("div",Kn,[c("div",Yn,[c("span",null,p(e.$t("amount"))+"("+p(null==(o=b(_))?void 0:o.coinName)+")",1)])]),c("div",qn,[c("div",Xn,[c("span",null,p(e.$t("total"))+"("+p(null==(f=b(_))?void 0:f.coinName)+")",1)])])]),"all"==b(ne)||"sell"==b(ne)?(s(),g(kn,{key:0,list:null==(L=b($))?void 0:L.slice(0,b(ue)),type:"sell",height:b(se),unit:b(_),step:b(X)},null,8,["list","height","unit","step"])):d("",!0),c("div",Zn,[c("span",{class:x(["text-20px font-700 block text-left",Number(null==(T=b(t))?void 0:T.priceChange)>0?"color-[--up-color]":"color-[--down-color]"])},p(("formatNumber"in e?e.formatNumber:b(I))((null==(F=b(t))?void 0:F.lastPrice)||0,{decimals:b(ae),limit:8})),3),k(B,{class:x(["text-16px",Number(null==(A=b(t))?void 0:A.priceChange)>0?"color-[--up-color]":"color-[--down-color]"]),name:"custom:"+(Number(null==(D=b(t))?void 0:D.priceChange)>0?"arrow-up":"arrow-down")},null,8,["class","name"]),l[3]||(l[3]=c("div",{class:"flex-1"},null,-1)),u((s(),i("div",Jn,[k(B,{class:"text-14px color-[--third-text]",name:"custom:perp-flag"}),c("span",Qn,p(("formatNumber"in e?e.formatNumber:b(I))((null==(O=b(t))?void 0:O.oraclePrice)||0,{decimals:b(ae),limit:8})),1)])),[[W,e.$t("oraclePriceTooltip")]])]),"all"==b(ne)||"buy"==b(ne)?(s(),g(kn,{key:1,list:null==(M=b(S))?void 0:M.slice(0,b(ue)),type:"buy",height:b(se),unit:b(_),step:b(X)},null,8,["list","height","unit","step"])):d("",!0)])]),c("div",Gn,[c("span",ea,p(e.$t("buy1")),1),c("div",la,[c("span",{class:"left",style:R({width:("formatNumber"in e?e.formatNumber:b(I))(b(de)||0,1)+"%"})},p(("formatNumber"in e?e.formatNumber:b(I))(b(de),1))+"% ",5),c("span",{class:"right",style:R({width:("formatNumber"in e?e.formatNumber:b(I))(100-b(de)||0,1)+"%"})},p(("formatNumber"in e?e.formatNumber:b(I))(100-b(de),1))+"% ",5)]),c("span",ta,p(e.$t("sell1")),1)])],64)):(s(),i("div",ra,[c("div",na,[c("div",aa,p(e.$t("price"))+"("+p(null==(V=b(C))?void 0:V.coinName)+")",1),c("div",oa,[c("div",ia,[c("span",null,p(e.$t("amount"))+"("+p(null==(z=b(N))?void 0:z.coinName)+")",1)])]),c("div",sa,[c("div",ca,[c("span",null,p(e.$t("time")),1)])])]),k(Tn,{list:b(J),height:b(se)},null,8,["list","height"])]))],4)}}}),[["__scopeId","data-v-29d76bcf"]]),da={class:"flex-start items-center"},pa={class:"text-20px font-500 cursor-pointer"},va={class:"content"},ma={class:"flex items-center"},xa={class:"ml-5px text-14px color-[--third-text]"},ba={class:"ml-5px color-[--secondary-text] text-12px"},fa={class:"flex-between mt-10px"},ga={class:"color-[--secondary-text] text-12px"},ha={class:"color-[--third-text] text-12px"},ya={class:"text-center mt-30px flex-between"},wa=S(l({__name:"closePositionDialog",props:{modelValue:Boolean,positions:{type:Array,default:()=>[]}},emits:["update:modelValue"],setup(e,{emit:l}){const t=e,r=l,n=a({get:()=>t.modelValue??!1,set:e=>r("update:modelValue",e)}),{metadata:u}=V(z()),{t:d}=Q(),f=a((()=>{var e,l,t;const r=(null==(t=null==(l=null==(e=u.value)?void 0:e.contractList)?void 0:l.reduce)?void 0:t.call(l,((e,l)=>(e[l.contractId]=l.contractName,e)),{}))||{};return r.ALL=d("all"),r}));function _(e){var l,t,r;return(null==(r=null==(t=null==(l=u.value)?void 0:l.contractList)?void 0:t.find((l=>l.contractId===e)))?void 0:r.baseCoin)||""}const P=L(!1);let N=0;async function C(){P.value=!0,Promise.all(t.positions.map((e=>async function(e){var l;(null==(l=t.positions)?void 0:l.length)>2&&(N++,N>1&&(await ye(1e3*(N-1)),N=0));const r=f.value[e.contractId]+" "+ll(e.contractId)+"X ",n={type:"MARKET",size:o(e.openSize||"0").abs().toFixed(),price:String("0"),side:o((null==e?void 0:e.openSize)||"0").gte(0)?"SELL":"BUY",contractId:(null==e?void 0:e.contractId)||"",reduceOnly:!0,isPositionTpsl:!1,isSetOpenTp:!1,isSetOpenSl:!1};return vl(n).then((async e=>(He({type:"success",message:r+d("closePositionSubmitted")}),e))).catch((async e=>(He({type:"error",message:null==e?void 0:e.message}),"")))}(e)))).then((e=>{(null==e?void 0:e.every((e=>e)))&&(n.value=!1)})).finally((()=>{P.value=!1}))}return(l,t)=>{const r=wl,a=X,u=ee;return s(),g(u,{modelValue:b(n),"onUpdate:modelValue":t[1]||(t[1]=e=>T(n)?n.value=e:null),width:"450px",class:"dialog-box dialog-max dialog-remind dialog","append-to-body":"",onClose:t[2]||(t[2]=e=>n.value=!1)},{header:h((()=>[c("div",da,[c("span",pa,p(b(d)("marketPriceClosePosition")),1)])])),default:h((()=>[c("div",va,[c("ul",null,[(s(!0),i(y,null,w(e.positions,((e,t)=>{var r,n;return s(),i("li",{key:t,class:"mb-15px"},[c("div",ma,[c("span",{class:x(["rounded-4px h-16px text-10px inline-flex items-center justify-center px-2px",(null==(r=b(o)(e.openSize))?void 0:r.gt(0))?"bg-[--up-color]":"bg-[--down-color]"])},p((null==(n=b(o)(e.openSize))?void 0:n.gt(0))?l.$t("buy1"):l.$t("sell1")),3),c("span",xa,p(b(f)[e.contractId]),1),c("span",ba,p(("getLeverageFromContractId"in l?l.getLeverageFromContractId:b(ll))(e.contractId))+"X",1)]),c("div",fa,[c("span",ga,p(l.$t("orderQuantity")),1),c("span",ha,p(("formatNumber"in l?l.formatNumber:b(I))(e.openSize.replace("-","")))+" "+p(_(e.contractId)),1)])])})),128))]),k(r,{type:"warning",title:l.$t("closePositionTip"),closable:!1,"show-icon":"",class:"close-alert",style:{backgroundColor:"#FFA6221A",color:"#FFA622",border:"none",fontSize:"12px","--el-alert-title-font-size":"12px",lineHeight:"1"}},null,8,["title"]),c("div",ya,[k(a,{class:"flex-1",style:{height:"48px"},onClick:t[0]||(t[0]=v((e=>n.value=!1),["stop","prevent"]))},{default:h((()=>[m(p(l.$t("cancel")),1)])),_:1}),k(a,{class:"flex-1",style:{height:"48px"},type:"primary",loading:b(P),onClick:v(C,["stop","prevent"])},{default:h((()=>[m(p(l.$t("confirm")),1)])),_:1},8,["loading"])])])])),_:1},8,["modelValue"])}}}),[["__scopeId","data-v-98e982e9"]]),ka={class:"pt-12px bg-[--secondary-bg]"},_a={class:"flex items-center justify-between mb-16px px-14px"},Pa={class:"flex items-center"},Ia=["onClick"],Na={class:"flex items-center justify-end gap-12px"},Ca=S(l({__name:"index",setup(e){const{contractId:l,isCancelOrder:t,position:r,order:o}=V(z()),u=Y(),{t:f}=Q(),_=z(),P=n(!1),I=a((()=>{var e,l,t,r;return[{label:f("positions")+((null==(e=F.value)?void 0:e.length)>0?`(${null==(l=F.value)?void 0:l.length})`:""),value:"holding"},{label:f("currentOrder")+((null==(t=o.value)?void 0:t.length)>0?`(${null==(r=o.value)?void 0:r.length})`:""),value:"currentOrder"},{label:f("orderDetail"),value:"orderDetail"},{label:f("historyOrder"),value:"historyOrder"},{label:f("closePnl"),value:"closePnl"},{label:f("positionHistory"),value:"positionHistory"}]})),N={holding:Il,currentOrder:We((()=>Ye((()=>import("./BYItvXCb.js")),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9]),import.meta.url))),conditionOrder:We((()=>Ye((()=>import("./BNc6DVWp.js")),__vite__mapDeps([10,1,2,3,4,5,6,7,8,9]),import.meta.url))),orderDetail:We((()=>Ye((()=>import("./YPI54pvZ.js")),__vite__mapDeps([11,1,2,3,4,5,6,7,8,9]),import.meta.url))),historyOrder:We((()=>Ye((()=>import("./DwExN9Ay.js")),__vite__mapDeps([12,1,2,3,4,5,6,7,8,9]),import.meta.url))),closePnl:We((()=>Ye((()=>import("./8WbLztfe.js")),__vite__mapDeps([13,1,2,3,4,5,6,7,8,9]),import.meta.url))),positionHistory:We((()=>Ye((()=>import("./BWnE-iKz.js")),__vite__mapDeps([14,1,2,3,4,5,6,7,8,9]),import.meta.url)))},C=Ce("perp-selected-current-object",Object.fromEntries(Object.keys(N).map((e=>[e,!0])))),S=L("holding"),$=Oe("perp-kline-searchParams",Object.keys(N).reduce(((e,t)=>(e[t]={filterContractIdList:l.value},e)),{})),E=e=>{const l={...$.value[e]};"ALL"===l.filterContractIdList&&Reflect.deleteProperty(l,"filterContractIdList");for(const t in l)Object.prototype.hasOwnProperty.call(l,t)&&(l[t]||Reflect.deleteProperty(l,t));return l},F=a((()=>{var e;const l=E(S.value);return(null==(e=_.position)?void 0:e.filter((e=>(null==l?void 0:l.filterContractIdList)&&e.contractId===(null==l?void 0:l.filterContractIdList)||!(null==l?void 0:l.filterContractIdList))))||[]})),D=a((()=>{var e;return!!(null==(e=C.value)?void 0:e[S.value])}));return A((()=>D.value),(e=>{$.value[S.value].filterContractIdList=e?l.value:"ALL"})),A((()=>l.value),(e=>{D.value?$.value[S.value].filterContractIdList="ALL":$.value[S.value].filterContractIdList=e})),A((()=>S.value),(e=>{D.value?$.value[e].filterContractIdList=l.value:$.value[e].filterContractIdList="ALL"})),(e,l)=>{var n,a;const o=ue,f=X;return s(),i("div",ka,[c("div",_a,[c("div",Pa,[(s(!0),i(y,null,w(b(I),(e=>(s(),i("span",{key:e.value,class:x(["text-12px lh-24px color-[--third-text] cursor-pointer border-b-2px border-b-solid border-transparent block mr-24px pb-10px",{"[&&]:color-[--main-text] [&&]:border-[--main-text]":e.value===b(S)}]),onClick:l=>S.value=e.value},p(e.label),11,Ia)))),128))]),c("div",Na,[k(o,{modelValue:b(C)[b(S)],"onUpdate:modelValue":l[0]||(l[0]=e=>b(C)[b(S)]=e),class:"checkbox-sm",label:e.$t("showCurrentContract")},null,8,["modelValue","label"]),"holding"==b(S)?(s(),g(f,{key:0,class:"close-position",disabled:0==(null==(n=b(r))?void 0:n.length),onClick:l[1]||(l[1]=v((e=>P.value=!0),["stop","prevent"]))},{default:h((()=>[m(p(e.$t("closePositionAll")),1)])),_:1},8,["disabled"])):"currentOrder"==b(S)?(s(),g(f,{key:1,class:"close-position",disabled:0==(null==(a=b(_).order)?void 0:a.length),onClick:l[2]||(l[2]=v((e=>t.value=!0),["stop","prevent"]))},{default:h((()=>[m(p(e.$t("cancelAll")),1)])),_:1},8,["disabled"])):b(u).address&&b(u).chain?(s(),g(f,{key:2,class:"close-position",onClick:l[3]||(l[3]=v((l=>e.$router.push(`/address/${b(u).address}/${b(u).chain}?t=${b(S)}`)),["stop"]))},{default:h((()=>[m(p(e.$t("viewAll")),1)])),_:1})):d("",!0)])]),(s(),g(Ke(N[b(S)]),{searchParams:E(b(S))},null,8,["searchParams"])),k(wa,{modelValue:b(P),"onUpdate:modelValue":l[4]||(l[4]=e=>T(P)?P.value=e:null),positions:b(F)},null,8,["modelValue","positions"])])}}}),[["__scopeId","data-v-6799e53a"]]),Sa={class:"flex bg-[--main-divider] gap-1px flex min-w-0 w-full",style:{"min-height":"calc(100vh - 92px - 64px)"}},La={class:"flex-1 max-w-100vw"},$a={class:"flex flex-1"},Ta={class:"flex-1 min-w-0"},Ea={class:"flex gap-1px"},Fa={class:"flex-1 hide-scrollbar min-w-0 relative"},Aa=S(l({__name:"[[name]]",setup(l){const{isCanNormalWithdrawableAmount:t}=Ge(),r=xe(),o=a((()=>t.value?"calc(100vh - 110px)":"calc(100vh - 95px)")),u=a((()=>r.commonHeight-160));Ie();const d=be(),p=a((()=>{var e;const l=null==(e=d.userInfo)?void 0:e.addresses;return Array.isArray(l)?Array.from(new Set(l.map((e=>e.address)))):[]})),m=fe(),x=L([]);Je(Pe.KLINE_DATE_FILTER,x);const f=Oe("kHeightPerp",Math.max(Me.KLINE,500)),g=Oe("orderBookWidth",300);let _=!1;function P(e){e.preventDefault();let l=e.clientX;_=!0;const t=document.getElementById("tv_chart_container");t&&(t.style.pointerEvents="none");const r=document.body.style.cursor,n=document.body.style.userSelect;document.body.style.cursor="col-resize",document.body.style.userSelect="none";let a=!1,o=l;const i=e=>{_&&(o=e.clientX,a||(a=!0,requestAnimationFrame((()=>{const e=o,t=l-e,r=g.value+t;g.value=Math.min(400,Math.max(300,r)),l=e,a=!1}))))},s=()=>{_=!1,window.removeEventListener("mousemove",i),window.removeEventListener("mouseup",s),t&&(t.style.pointerEvents="auto"),document.body.style.cursor=r,document.body.style.userSelect=n};return window.addEventListener("mousemove",i),window.addEventListener("mouseup",s,{once:!0}),!1}const I=n(!0);function N(){I.value=!document.hidden||"visible"===document.visibilityState}return Je("documentVisible",I),A((()=>p.value),(()=>{var e;(null==(e=p.value)?void 0:e.length)&&d.subBalanceChange()}),{immediate:!0}),qe((()=>{document.addEventListener("visibilitychange",N)})),ve((()=>{var e;null==(e=null==r?void 0:r.reset)||e.call(r),m.send({jsonrpc:"2.0",method:"unsubscribe",params:["asset"],id:1}),m.send({jsonrpc:"2.0",method:"unsubscribe",params:[Xe.PUBLIC_PORTRAIT],id:1})})),Ze((()=>{var e;null==(e=m.getWSInstance())||e.offMessage(["tx_update_token","kline","price"]),document.removeEventListener("visibilitychange",N)})),(l,t)=>{const r=e;return s(),i("div",Sa,[c("div",La,[k(Nl),c("div",$a,[c("div",Ta,[c("div",Ea,[c("div",Fa,[k(r,{height:b(o)},{default:h((()=>[c("div",{class:"grid gap-1px",style:R({gridTemplateColumns:`1fr 1px ${b(g)}px`})},[c("div",null,[k(Ft),k(xn,{ref:"klineContainer"},null,512)]),c("div",{class:"cursor-col-resize bg-[--d-222-l-F2F2F2] hover:bg-[--d-666-l-CCC] flex flex-col items-center justify-center gap-1px w-1px",onMousedown:v(P,["stop","prevent"])},[(s(),i(y,null,w(4,(e=>c("span",{key:e,class:"bg-[--d-444-l-999] w-2px h-2px rounded-full"}))),64))],32),k(ua,{"kline-height":b(f)+64},null,8,["kline-height"])],4),k(Ca,{class:"rounded-4px bg-[--d-000-l-F6F6F6]",style:R({minHeight:b(u)+"px"})},null,8,["style"])])),_:1},8,["height"])])])]),k(on,{class:"w-334px flex-shrink-0"})])])])}}}),[["__scopeId","data-v-fd2fbb37"]]);export{Aa as default};
