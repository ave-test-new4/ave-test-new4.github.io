import{n as e,p as t,f5 as n,f6 as o,l as r,f7 as i,f8 as l,r as s,f9 as a,m as u,g as c,I as f,fa as v,f as h,h as p,k as d,i as g}from"./LNDzZpPm.js";function w(e){return!!n()&&(o(e),!0)}const y="undefined"!=typeof window&&"undefined"!=typeof document;"undefined"!=typeof WorkerGlobalScope&&(globalThis,WorkerGlobalScope);Object.prototype.toString;function b(e){return Array.isArray(e)?e:[e]}function m(n,o=!0,i){r()?e(n,i):o?n():t(n)}const x=y?window:void 0;function R(e){var t;const n=v(e);return null!=(t=null==n?void 0:n.$el)?t:n}function z(){const t=f(!1),n=r();return n&&e((()=>{t.value=!0}),n),t}function S(e){const t=z();return c((()=>(t.value,Boolean(e()))))}function L(e,t={width:0,height:0},n={}){const{window:o=x,box:r="content-box"}=n,i=c((()=>{var t,n;return null==(n=null==(t=R(e))?void 0:t.namespaceURI)?void 0:n.includes("svg")})),l=f(t.width),s=f(t.height),{stop:a}=function(e,t,n={}){const{window:o=x,...r}=n;let i;const l=S((()=>o&&"ResizeObserver"in o)),s=()=>{i&&(i.disconnect(),i=void 0)},a=c((()=>{const t=v(e);return Array.isArray(t)?t.map((e=>R(e))):[R(t)]})),f=u(a,(e=>{if(s(),l.value&&o){i=new ResizeObserver(t);for(const t of e)t&&i.observe(t,r)}}),{immediate:!0,flush:"post"}),h=()=>{s(),f()};return w(h),{isSupported:l,stop:h}}(e,(([t])=>{const n="border-box"===r?t.borderBoxSize:"content-box"===r?t.contentBoxSize:t.devicePixelContentBoxSize;if(o&&i.value){const t=R(e);if(t){const e=t.getBoundingClientRect();l.value=e.width,s.value=e.height}}else if(n){const e=b(n);l.value=e.reduce(((e,{inlineSize:t})=>e+t),0),s.value=e.reduce(((e,{blockSize:t})=>e+t),0)}else l.value=t.contentRect.width,s.value=t.contentRect.height}),n);m((()=>{const n=R(e);n&&(l.value="offsetWidth"in n?n.offsetWidth:t.width,s.value="offsetHeight"in n?n.offsetHeight:t.height)}));const h=u((()=>R(e)),(e=>{l.value=e?t.width:0,s.value=e?t.height:0}));return{width:l,height:s,stop:function(){a(),h()}}}function T(e,t){const{containerStyle:n,wrapperProps:o,scrollTo:r,calculateRange:i,currentList:l,containerRef:s}="itemHeight"in t?function(e,t){const n=P(t),{state:o,source:r,currentList:i,size:l,containerRef:s}=n,a={overflowY:"auto"},{itemHeight:u,overscan:f=5}=e,v=k(o,r,u),h=A(r,u),p=W("vertical",f,h,v,n),d=B(u,r),g=c((()=>d(o.value.start))),w=j(u,r);H(l,t,s,p);const y=U("vertical",p,d,s),b=c((()=>({style:{width:"100%",height:w.value-g.value+"px",marginTop:`${g.value}px`}})));return{calculateRange:p,scrollTo:y,containerStyle:a,wrapperProps:b,currentList:i,containerRef:s}}(t,e):function(e,t){const n=P(t),{state:o,source:r,currentList:i,size:l,containerRef:s}=n,a={overflowX:"auto"},{itemWidth:u,overscan:f=5}=e,v=k(o,r,u),h=A(r,u),p=W("horizontal",f,h,v,n),d=B(u,r),g=c((()=>d(o.value.start))),w=j(u,r);H(l,t,s,p);const y=U("horizontal",p,d,s),b=c((()=>({style:{height:"100%",width:w.value-g.value+"px",marginLeft:`${g.value}px`,display:"flex"}})));return{scrollTo:y,calculateRange:p,wrapperProps:b,containerStyle:a,currentList:i,containerRef:s}}(t,e);return{list:l,scrollTo:r,containerProps:{ref:s,onScroll:()=>{i()},style:n},wrapperProps:o}}function P(e){const t=f(null),n=L(t),o=s([]),r=f(e);return{state:s({start:0,end:10}),source:r,currentList:o,size:n,containerRef:t}}function k(e,t,n){return o=>{if("number"==typeof n)return Math.ceil(o/n);const{start:r=0}=e.value;let i=0,l=0;for(let e=r;e<t.value.length;e++){if(i+=n(e),l=e,i>o)break}return l-r}}function A(e,t){return n=>{if("number"==typeof t)return Math.floor(n/t)+1;let o=0,r=0;for(let i=0;i<e.value.length;i++){if(o+=t(i),o>=n){r=i;break}}return r+1}}function W(e,t,n,o,{containerRef:r,state:i,currentList:l,source:s}){return()=>{const a=r.value;if(a){const r=n("vertical"===e?a.scrollTop:a.scrollLeft),u=o("vertical"===e?a.clientHeight:a.clientWidth),c=r-t,f=r+u+t;i.value={start:c<0?0:c,end:f>s.value.length?s.value.length:f},l.value=s.value.slice(i.value.start,i.value.end).map(((e,t)=>({data:e,index:t+i.value.start})))}}}function B(e,t){return n=>{if("number"==typeof e){return n*e}return t.value.slice(0,n).reduce(((t,n,o)=>t+e(o)),0)}}function H(e,t,n,o){u([e.width,e.height,()=>v(t),n],(()=>{o()}))}function j(e,t){return c((()=>"number"==typeof e?t.value.length*e:t.value.reduce(((t,n,o)=>t+e(o)),0)))}const O={horizontal:"scrollLeft",vertical:"scrollTop"};function U(e,t,n,o){return r=>{o.value&&(o.value[O[e]]=n(r),t())}}y&&window;!function(){let e=!1;const t=f(!1)}();const $=h({name:"UseVirtualList",props:["list","options","height"],setup(e,{slots:t,expose:n}){const{list:o}=p(e),{list:r,containerProps:i,wrapperProps:l,scrollTo:s}=T(o,e.options);return n({scrollTo:s}),i.style&&"object"==typeof i.style&&!Array.isArray(i.style)&&(i.style.height=e.height||"300px"),()=>d("div",{...i},[d("div",{...l.value},r.value.map((e=>d("div",{style:{overflow:"hidden",height:e.height}},t.default?t.default(e):"Please set content!"))))])}});export{$ as U};
