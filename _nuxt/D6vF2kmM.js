import{f as e,am as a,y as l,v as t,aR as s,V as o,W as i,bw as r,g as n,aV as d,aW as p,a1 as u,I as c,r as m,ot as v,m as f,ni as h,cr as x,bY as b,n as g,K as _,o as w,w as y,b$ as k,b as $,i as N,c as V,F as C,C as j,a as O,A as T,B as W,J as A,a7 as F,t as P,D as z,o9 as H,a8 as I,by as B,cI as D,O as E,e3 as L,aZ as M,a_ as R,s as S,E as U,_ as J}from"./LNDzZpPm.js";import{a as K,E as Y}from"./CyofXtRf.js";import"./BcS6nOuf.js";import"./CqaOUC0Y.js";import{_ as Z}from"./CLNj84bD.js";import"./DuC4p7MX.js";import"./CSZL48hR.js";const q={key:0,class:"flex flex-col items-center justify-center py-30px"},G={key:0,src:M},Q={key:1,src:R},X={key:1},ee={key:0,class:"flex items-center text-right justify-end"},ae={key:1},le={key:0,class:"flex items-center clickable flex-nowrap relative"},te={class:"whitespace-nowrap text-ellipsis overflow-hidden max-w-90px mr-8px"},se={key:4,class:"pr-10px inline-block"},oe=["infinite-scroll-disabled"],ie={key:0,class:"text-center px-0 pt-15px pb-10px text-12px color-[--third-text]"},re={key:1,class:"text-center px-0 pt-15px pb-10px text-12px color-[--third-text]"},ne=J(e({__name:"positionsTable",props:{modelValue:Boolean,tableFilter:{type:Object,default:()=>({hide_risk:1,hide_small:0,user_ids:[]})}},emits:["update:modelValue","hideToken"],setup(e,{emit:M}){const{mode:R}=a(l()),{t:J}=t(),ne=s(),de=o(),pe=i(),{updateHolderNum:ue}=a(r()),ce=n((()=>[{label:J("token"),prop:"token",align:"left",sortable:!1,minWidth:125,showOverflowTooltip:!0},{label:J("balance1"),prop:"balance_usd",align:"right",sortable:!1,formatter:e=>`$${u(e.balance_usd,4)}`},{label:J("amount"),prop:"balance",align:"right",sortable:!1,formatter:e=>`${u(e.balance,4)}`},{label:J("costPrice"),prop:"average_purchase_price_usd",align:"right",sortable:!1,formatter:e=>`$${u(e.average_purchase_price_usd,4)}`},{label:J("currentPrice"),prop:"current_price_usd",align:"right",sortable:!1,formatter:e=>`$${u(e.current_price_usd,4)}`},{label:"PnL",prop:"total_profit_ratio",width:100,align:"right",sortable:!1,getClassName:e=>Number(e.total_profit_ratio)>0?`color-${d[0]}`:`color-${p[0]}`,formatter:e=>`${Number(e.total_profit_ratio)>0?"+":"-"}${u(Math.abs(100*Number(e.total_profit_ratio)),2)}%`}])),me=c([]),ve=e,fe=M,he=m(!1),xe=m({}),be=m({...v}),ge=n({get:()=>ve.modelValue,set:e=>fe("update:modelValue",e)}),_e=n((()=>{var e;return"solana"!==(null==(e=xe.value)?void 0:e.chain)?de.evmAddress||pe.address:de.getWalletAddress("solana")||pe.address}));function we(e){ne.push({name:"token-id",params:{id:null==e?void 0:e.index}}),ge.value=!1}f((()=>ue.value),(()=>{be.value={...v},ye()}));const ye=async()=>{if(be.value.loaded)return;be.value.loaded=!0;const e=be.value.pageNO,a=be.value.pageSize;h({pageNO:e,pageSize:a,...ve.tableFilter}).then((l=>{var t,s;const o=(null==l?void 0:l.data)||[];Array.isArray(o)&&(null==o?void 0:o.length)>0?(me.value=1===e?null==o?void 0:o.map((e=>{var a;return{...e,index:e.token===x?(null==(a=b(e.chain))?void 0:a.wmain_wrapper)+"-"+e.chain:`${e.token}-${e.chain}`}})):[...me.value].concat(null==(s=null==(t=o.filter)?void 0:t.call(o,(e=>{var a,l;return null==(l=null==(a=me.value)?void 0:a.every)?void 0:l.call(a,(a=>a.index!==`${e.token}-${e.chain}`))})))?void 0:s.map((e=>{var a;return{...e,index:e.token===x?(null==(a=b(e.chain))?void 0:a.wmain_wrapper)+"-"+e.chain:`${e.token}-${e.chain}`}}))),be.value.finished=(null==o?void 0:o.length)<a,be.value.finished||be.value.pageNO++):(1===e&&(me.value=[]),be.value.finished=!0)})).finally((()=>{setTimeout((()=>{be.value.loaded=!1}),200)}))};return f(ve.tableFilter,(()=>{be.value={...v},ye()})),f((()=>ge.value),(e=>{e&&(be.value={...v},ye())}),{immediate:!0}),g((()=>{})),(e,a)=>{const l=B,t=I,s=W,o=H,i=Y,r=K,n=U,d=L;return w(),_(n,{modelValue:N(ge),"onUpdate:modelValue":a[1]||(a[1]=e=>S(ge)?ge.value=e:null),class:"dialog-position",title:e.$t("myPosition1"),width:"680","append-to-body":""},{default:y((()=>[k(e.$slots,"default",{},void 0,!0),$(r,{class:"table-position w-100%",data:N(me),height:400,onRowClick:we,"row-class-name":"group"},{empty:y((()=>[N(be).loaded?(w(),V("span",X)):(w(),V("div",q,["light"===N(R)?(w(),V("img",G)):T("",!0),"dark"===N(R)?(w(),V("img",Q)):T("",!0),O("span",null,P(N(J)("emptyNoData")),1)]))])),append:y((()=>{var a,l;return[E(O("div",{class:"text-0 lh-0 h-0","infinite-scroll-disabled":N(be).loaded||N(be).finished,"infinite-scroll-distance":20,"infinite-scroll-delay":200,"infinite-scroll-immediate":!0},null,8,oe),[[d,ye]]),N(be).loaded&&(null==(a=N(me))?void 0:a.length)>0?(w(),V("div",ie,P(e.$t("loading")),1)):N(be).finished&&(null==(l=N(me))?void 0:l.length)>0?(w(),V("div",re,P(e.$t("noMore")),1)):T("",!0)]})),default:y((()=>[(w(!0),V(C,null,j(N(ce),(a=>(w(),_(i,{key:a.prop,label:a.label,width:a.width,prop:a.prop,"min-width":null==a?void 0:a.minWidth,align:a.align,"show-overflow-tooltip":(null==a?void 0:a.showOverflowTooltip)||!1},{header:y((({column:a})=>["total_profit_ratio"==a.property?(w(),V("div",ee,[O("span",null,P(a.label),1),$(t,{effect:N(R),placement:"top-end",content:e.$t("PnLTips"),"popper-class":"[&&]:[--el-text-color-primary:--dialog-list-hover]!",persistent:""},{default:y((()=>[$(l,{style:{cursor:"pointer","font-size":"14px","margin-left":"2px"}},{default:y((()=>[$(N(D))])),_:1})])),_:1},8,["effect","content"])])):(w(),V("div",ae,P(a.label),1))])),default:y((({row:e})=>[O("div",null,["token"===(null==a?void 0:a.prop)?(w(),V("div",le,["WatchWallet"!==N(pe).walletName?(w(),_(s,{key:0,name:"bx:bxs-hide",class:"bxs-hide cursor-pointer color-#959a9f overflow-hidden whitespace-nowrap max-w-0 group-hover:max-w-[100px] transition-all duration-500 ease-in-out",onClick:A((a=>function(e){he.value=!0,xe.value=e}(e)),["self","stop"])},null,8,["onClick"])):T("",!0),$(F,{row:e,class:"w-24px h-24px mr-8px"},null,8,["row"]),O("div",te,P(null==e?void 0:e.symbol),1),e.risk_score>55||e.risk_level<0?(w(),_(s,{key:1,name:"custom:danger",class:"font-14 ml-2px color-#F72121 w-14px h-14px mt-2px"})):T("",!0)])):"--"===e[a.prop]?(w(),V("span",{key:1,class:z((null==a?void 0:a.getClassName)?a.getClassName(e):"")},"--",2)):0===e[a.prop]?(w(),V("span",{key:2,class:z((null==a?void 0:a.getClassName)?a.getClassName(e):"")},"0",2)):(w(),V("span",{key:3,class:z((null==a?void 0:a.getClassName)?a.getClassName(e):"")},P(a.formatter?a.formatter(e):e[a.prop]),3)),"total_profit_ratio"===(null==a?void 0:a.prop)?(w(),V("div",se,[$(o,{address:e.address,statistics:e,chain:e.chain,type:"topHolder"},null,8,["address","statistics","chain"])])):T("",!0)])])),_:2},1032,["label","width","prop","min-width","align","show-overflow-tooltip"])))),128))])),_:1},8,["data"]),$(Z,{modelValue:N(he),"onUpdate:modelValue":a[0]||(a[0]=e=>S(he)?he.value=e:null),row:N(xe),self_address:N(_e),onHideToken:()=>{}},null,8,["modelValue","row","self_address"])])),_:3},8,["modelValue","title"])}}}),[["__scopeId","data-v-7f722a44"]]);export{ne as default};
