import{f as e,v as a,am as l,y as t,V as n,R as s,I as o,x as i,r,g as c,eZ as u,m as d,n as p,a4 as m,N as v,c as x,o as f,a as b,b as h,A as y,K as g,t as k,i as w,w as T,B as C,J as j,G as I,d as $,F as B,C as _,O as A,D,s as N,E as S,bH as U,H as z,ez as M,eA as W}from"./LNDzZpPm.js";import R from"./BOo_HO62.js";import V from"./C088PvQ-.js";import H from"./CPADHO8w.js";import{_ as Z,a as E,b as F}from"./BR9e6NRM.js";import"./CyofXtRf.js";import"./CqaOUC0Y.js";import"./BcS6nOuf.js";import"./DuC4p7MX.js";import"./DItkWHBM.js";const G={class:"bg-[--secondary-bg] flex-1 w-100% px-200px pt-40px overflow-y-auto bot-manage",style:{height:"calc(100vh - 150px)"}},J={class:"mb-8px flex-between items-center"},K={class:"text-16px font-500"},L={key:0},O={class:"flex-between"},P={class:"text-24px"},q={key:0,class:"mask text-center color-[--main-text] absolute bg-[--border] top-0 right-0 left-0 bottom-0 flex items-center justify-center z-1 text-14px cursor-pointer"},Q={class:"grid grid-cols-3 gap-2 mt-30px"},X={class:"color-[--third-text] rounded-4px text-10px px-4px py-1px overflow-hidden text-ellipsis whitespace-nowrap max-w-100px line-height-15px absolute left-2px top-2px"},Y={class:"text-center mt-30px flex-between"},ee=e({__name:"index",setup(e,{expose:ee}){ee({getMultiWalletsAllChain:Ie});const{t:ae}=a(),{showImport:le,mode:te,showBotRecord:ne}=l(t()),{getUserInfo:se}=n(),{theme:oe,isDark:ie}=l(s()),re=n(),ce=o(!1),ue=o(!1),de=o(!0),pe=i("encryptedMnemonic","",sessionStorage),me=o(!1),ve=r([]),xe=r([]),fe=o(!1),be=o(!1),he=r(0),ye=r(!1);let ge=null;const ke=c((()=>{var e;const a=pe.value||"",l=(null==(e=null==re?void 0:re.userInfo)?void 0:e.tgUid)||"";if(a&&l){return u(a,l).split(" ")||[]}return[]})),we=c((()=>(null==re?void 0:re.evmAddress)||""));function Te(){ye.value||(Ie(),Ce(10))}d((()=>we.value),(e=>{e?Ie():(ve.value=[],xe.value=[])})),p((()=>{Ie(),ge&&clearInterval(ge)}));const Ce=e=>{he.value=e,ye.value=!0,ge=U((()=>{he.value--,he.value<=0&&(clearInterval(ge),ge=null,ye.value=!1)}),1e3)};function je(){fe.value=!0,E().then((e=>{const a=Array.isArray(e)?null==e?void 0:e.map((e=>({...e,updateTime:"1970-01-01T00:00:00Z"!==(null==e?void 0:e.updateTime)&&"0001-01-01T00:00:00Z"!==(null==e?void 0:e.updateTime)?new Date(e.updateTime).getTime():0}))):[];null==a||a.sort(((e,a)=>Number(null==a?void 0:a.updateTime)-Number(null==e?void 0:e.updateTime))),xe.value=a,ne.value=!0})).catch((e=>{m.error(e)})).finally((()=>{fe.value=!1}))}function Ie(){return new Promise(((e,a)=>{me.value=!0;const l=re.isSupportChains;Z(null==l?void 0:l.join(",")).then((a=>{ve.value=Array.isArray(a)?null==a?void 0:a.map(((e,a)=>{var l,t,n,s,o,i,r,c;return{id:`parent-${a}`,tgUid:e.tgUid,address:e.tgUid,name:e.name,source:e.source,operate:"delete",genSource:e.genSource,evmAddress:(null==(n=null==(t=null==(l=e.balancesInfo)?void 0:l.filter((e=>"bsc"==e.chain)))?void 0:t[0])?void 0:n.address)||"",balance:null==(s=null==e?void 0:e.balancesInfo)?void 0:s.reduce(((e,a)=>e+Number(a.balance)),0),mainTokenBalance:null==(o=null==e?void 0:e.balancesInfo)?void 0:o.reduce(((e,a)=>e+Number(a.mainTokenBalance)),0),usdcTokenBalance:null==(i=null==e?void 0:e.balancesInfo)?void 0:i.reduce(((e,a)=>e+Number(a.usdcTokenBalance)),0),usdtTokenBalance:null==(r=null==e?void 0:e.balancesInfo)?void 0:r.reduce(((e,a)=>e+Number(a.usdtTokenBalance)),0),balancesInfo:null==(c=e.balancesInfo)?void 0:c.map(((e,l)=>({...e,id:`child-${a}-${l}`,name:e.address,operate:"deposit",isChildren:!0})))}})):[],e(ve.value)})).catch((e=>{m.error(e),a([])})).finally((()=>{me.value=!1,be.value=!1}))}))}function $e(){z.confirm(ae("createWalletTip"),ae("createWallet"),{type:"warning",icon:M(W),confirmButtonText:ae("confirm"),cancelButtonText:ae("cancel"),customClass:`${te.value} delete_confirm`}).then((()=>{ce.value=!0,F().then((e=>{pe.value=null==e?void 0:e.Mnemonic,de.value=!0,ue.value=!0,Be(),se()})).catch((e=>{m.error(String(e))})).finally((()=>{ce.value=!1}))})).catch((e=>{}))}function Be(){Ie()}const _e=()=>{z.confirm(ae("lastChance"),ae("tips"),{type:"warning",icon:M(W),confirmButtonText:ae("saved"),cancelButtonText:ae("cancel"),customClass:`${te.value} delete_confirm`}).then((()=>{pe.value="",ue.value=!1})).catch((e=>{}))};return(e,a)=>{const l=C,t=I,n=S,s=v("copy");return f(),x("div",G,[b("div",J,[b("span",K,k(e.$t("walletList")),1),w(we)?(f(),x("span",{key:0,class:"text-16px font-500 color-[--third-text] ml-40px cursor-pointer",onClick:je},k(e.$t("operateHistory")),1)):y("",!0),a[5]||(a[5]=b("div",{class:"flex-1"},null,-1)),w(we)?(f(),g(t,{key:1,class:"text-12px",size:"small",onClick:j(Te,["stop","prevent"]),disabled:w(ye)},{default:T((()=>[w(he)>0?(f(),x("span",L,k(w(he))+"S",1)):(f(),g(l,{key:1,name:"material-symbols:sync-outline",class:"text-12px"}))])),_:1},8,["disabled"])):y("",!0),w(we)?(f(),g(t,{key:2,class:"text-12px",size:"small",type:"primary",onClick:j($e,["stop","prevent"]),loading:w(ce)},{default:T((()=>[h(l,{name:"custom:wallet-fill",class:"text-12px mr-4px"}),$(k(e.$t("createWallet")),1)])),_:1},8,["loading"])):y("",!0),w(we)?(f(),g(t,{key:3,class:"text-12px",size:"small",onClick:a[0]||(a[0]=j((e=>le.value=!0),["stop","prevent"]))},{default:T((()=>[h(l,{name:"mingcute:new-folder-fill",class:"text-102x mr-4px"}),$(k(e.$t("importWallet")),1)])),_:1})):y("",!0)]),h(R,{tableData:w(ve),loading:w(me),onRefresh:Be},null,8,["tableData","loading"]),h(V,{onRefresh:Be}),h(H,{tableData:w(xe),loading:w(fe)},null,8,["tableData","loading"]),h(n,{modelValue:w(ue),"onUpdate:modelValue":a[4]||(a[4]=e=>N(ue)?ue.value=e:null),width:"500",height:"630",class:D(["dialog-connect1",w(oe)]),"append-to-body":"","close-on-click-modal":!1,"show-close":!1},{header:T((()=>[b("div",O,[b("span",P,k(e.$t("mnemonic")),1),h(l,{name:"material-symbols-light:close",class:"text-30px cursor-pointer",onClick:a[1]||(a[1]=j((e=>ue.value=!1),["stop","prevent"]))})])])),default:T((()=>{var n;return[b("div",{class:"relative min-h-160px",onClick:a[2]||(a[2]=e=>de.value=!1)},[w(de)?(f(),x("div",q,[h(l,{name:"custom:show-code",class:"text-16px mr-4px color-[--main-text]"}),$(" "+k(e.$t("clickMnemonic")),1)])):y("",!0),b("div",Q,[(f(!0),x(B,null,_(w(ke),((e,a)=>(f(),x("div",{class:"mnemonic-item block border border-solid border-[--dialog-divider] py-8px text-center relative",key:a},[b("span",X,k(a+1),1),$(" "+k(e),1)])))),128))])]),b("div",Y,[A((f(),g(t,{class:"flex-1",style:{height:"48px"},onClick:a[3]||(a[3]=j((()=>{}),["stop","prevent"]))},{default:T((()=>[$(k(e.$t("copyMnemonic")),1)])),_:1})),[[s,null==(n=w(ke))?void 0:n.join(" ")]]),h(t,{class:"flex-1",style:{height:"48px"},type:"primary",onClick:j(_e,["stop","prevent"])},{default:T((()=>[$(k(e.$t("continue")),1)])),_:1})])]})),_:1},8,["modelValue","class"])])}}});export{ee as default};
